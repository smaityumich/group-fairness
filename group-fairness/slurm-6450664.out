2020-05-21 16:32:43.746288: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:43.746393: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:43.746403: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2020-05-21 16:32:50.809642: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:50.811877: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)
2020-05-21 16:32:50.811933: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (gl3264.arc-ts.umich.edu): /proc/driver/nvidia/version does not exist
2020-05-21 16:32:50.812371: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-05-21 16:32:50.819443: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3000000000 Hz
2020-05-21 16:32:50.819544: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55f9ecd8cb20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-05-21 16:32:50.819557: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
/sw/arcts/centos7/python3.6-anaconda/5.2.0/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/array_grad.py:563: _EagerTensorBase.cpu (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.identity instead.
2020-05-21 16:58:49.511000: W tensorflow/python/util/util.cc:319] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1786: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
Test accuracy for step 250: 0.6158098578453064

Test GAP RMS for gender and step 250: 0.13057377934455872

Test GAP RMS for race and step 250: 0.014121728017926216

Test balanced accuracy for step 250: 0.4673084616661072


Test accuracy for step 500: 0.7626312971115112

Test GAP RMS for gender and step 500: 0.004278496839106083

Test GAP RMS for race and step 500: 0.004251158330589533

Test balanced accuracy for step 500: 0.5119779109954834


Test accuracy for step 750: 0.7614151239395142

Test GAP RMS for gender and step 750: 0.008052517659962177

Test GAP RMS for race and step 750: 0.004662992898374796

Test balanced accuracy for step 750: 0.5093224048614502


Test accuracy for step 1000: 0.7734659910202026

Test GAP RMS for gender and step 1000: 0.03004545159637928

Test GAP RMS for race and step 1000: 0.009973566979169846

Test balanced accuracy for step 1000: 0.5350324511528015


Test accuracy for step 1250: 0.7909342050552368

Test GAP RMS for gender and step 1250: 0.09164762496948242

Test GAP RMS for race and step 1250: 0.005614232271909714

Test balanced accuracy for step 1250: 0.5737360119819641


Test accuracy for step 1500: 0.8171365261077881

Test GAP RMS for gender and step 1500: 0.02902047522366047

Test GAP RMS for race and step 1500: 0.005854833871126175

Test balanced accuracy for step 1500: 0.6373476386070251


Test accuracy for step 1750: 0.8119403123855591

Test GAP RMS for gender and step 1750: 0.07514425367116928

Test GAP RMS for race and step 1750: 0.01411565113812685

Test balanced accuracy for step 1750: 0.6243457794189453


Test accuracy for step 2000: 0.8248755931854248

Test GAP RMS for gender and step 2000: 0.021786486729979515

Test GAP RMS for race and step 2000: 0.01001098845154047

Test balanced accuracy for step 2000: 0.6561964154243469


Test accuracy for step 2250: 0.8269762396812439

Test GAP RMS for gender and step 2250: 0.03672906383872032

Test GAP RMS for race and step 2250: 0.012627370655536652

Test balanced accuracy for step 2250: 0.6631403565406799


Test accuracy for step 2500: 0.835157573223114

Test GAP RMS for gender and step 2500: 0.01600589044392109

Test GAP RMS for race and step 2500: 0.021806009113788605

Test balanced accuracy for step 2500: 0.6879919171333313


Test accuracy for step 2750: 0.83714759349823

Test GAP RMS for gender and step 2750: 0.054107896983623505

Test GAP RMS for race and step 2750: 0.014222596772015095

Test balanced accuracy for step 2750: 0.6908499598503113


Test accuracy for step 3000: 0.8372581601142883

Test GAP RMS for gender and step 3000: 0.04625353217124939

Test GAP RMS for race and step 3000: 0.014124264009296894

Test balanced accuracy for step 3000: 0.6910773515701294


Test accuracy for step 3250: 0.837700366973877

Test GAP RMS for gender and step 3250: 0.04316970705986023

Test GAP RMS for race and step 3250: 0.022464754059910774

Test balanced accuracy for step 3250: 0.696153998374939


Test accuracy for step 3500: 0.8245439529418945

Test GAP RMS for gender and step 3500: 0.23670464754104614

Test GAP RMS for race and step 3500: 0.02743838168680668

Test balanced accuracy for step 3500: 0.6715657114982605


Test accuracy for step 3750: 0.8200110793113708

Test GAP RMS for gender and step 3750: 0.08519428968429565

Test GAP RMS for race and step 3750: 0.004487138241529465

Test balanced accuracy for step 3750: 0.6469635963439941


Test accuracy for step 4000: 0.8454394936561584

Test GAP RMS for gender and step 4000: 0.06468282639980316

Test GAP RMS for race and step 4000: 0.014146263711154461

Test balanced accuracy for step 4000: 0.7336780428886414


Test accuracy for step 4250: 0.8058595657348633

Test GAP RMS for gender and step 4250: 0.0788513720035553

Test GAP RMS for race and step 4250: 0.05225588008761406

Test balanced accuracy for step 4250: 0.806000828742981


Test accuracy for step 4500: 0.7010502815246582

Test GAP RMS for gender and step 4500: 0.14529426395893097

Test GAP RMS for race and step 4500: 0.06882592290639877

Test balanced accuracy for step 4500: 0.7847632169723511


Test accuracy for step 4750: 0.2954118251800537

Test GAP RMS for gender and step 4750: 0.04091278836131096

Test GAP RMS for race and step 4750: 0.028882594779133797

Test balanced accuracy for step 4750: 0.5337740182876587


Test accuracy for step 5000: 0.2720840275287628

Test GAP RMS for gender and step 5000: 0.03469424694776535

Test GAP RMS for race and step 5000: 0.010603126138448715

Test balanced accuracy for step 5000: 0.5182092189788818


Test accuracy for step 5250: 0.24521835148334503

Test GAP RMS for gender and step 5250: 0.0031826531048864126

Test GAP RMS for race and step 5250: 0.0016974142054095864

Test balanced accuracy for step 5250: 0.5012333393096924


Test accuracy for step 5500: 0.24344941973686218

Test GAP RMS for gender and step 5500: 0.0007968704449012876

Test GAP RMS for race and step 5500: 0.00036693044239655137

Test balanced accuracy for step 5500: 0.5002191066741943


Test accuracy for step 5750: 0.24333886802196503

Test GAP RMS for gender and step 5750: 0.0005312610301189125

Test GAP RMS for race and step 5750: 0.0002446203143335879

Test balanced accuracy for step 5750: 0.5001460313796997


Test accuracy for step 6000: 0.7547816634178162

Test GAP RMS for gender and step 6000: 0.5028306841850281

Test GAP RMS for race and step 6000: 0.050791941583156586

Test balanced accuracy for step 6000: 0.5541750192642212


Test accuracy for step 6250: 0.7599778771400452

Test GAP RMS for gender and step 6250: 0.47483643889427185

Test GAP RMS for race and step 6250: 0.039415180683135986

Test balanced accuracy for step 6250: 0.5469581484794617


Test accuracy for step 6500: 0.7529021501541138

Test GAP RMS for gender and step 6500: 0.5122763514518738

Test GAP RMS for race and step 6500: 0.03708164393901825

Test balanced accuracy for step 6500: 0.5532420873641968


Test accuracy for step 6750: 0.24311774969100952

Test GAP RMS for gender and step 6750: 0.0

Test GAP RMS for race and step 6750: 0.0

Test balanced accuracy for step 6750: 0.5


Test accuracy for step 7000: 0.24311774969100952

Test GAP RMS for gender and step 7000: 0.0

Test GAP RMS for race and step 7000: 0.0

Test balanced accuracy for step 7000: 0.5


Test accuracy for step 7250: 0.24311774969100952

Test GAP RMS for gender and step 7250: 0.0

Test GAP RMS for race and step 7250: 0.0

Test balanced accuracy for step 7250: 0.5


Test accuracy for step 7500: 0.24311774969100952

Test GAP RMS for gender and step 7500: 0.0

Test GAP RMS for race and step 7500: 0.0

Test balanced accuracy for step 7500: 0.5


Test accuracy for step 7750: 0.24344941973686218

Test GAP RMS for gender and step 7750: 0.0003622521471697837

Test GAP RMS for race and step 7750: 0.00041931899613700807

Test balanced accuracy for step 7750: 0.5002191066741943


{'epsilon': 0.1, 'lr': 0.0001, 'wlr': 0.001, 'w_reg': 50.0}
Final test accuracy: 0.24455499649047852
Final test GAP RMS for gender: 0.0008453814662061632
Final test GAP RMS for race: 0.0008038668311201036
Final test balanced accuracy: 0.500949501991272


