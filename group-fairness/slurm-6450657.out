2020-05-21 16:32:42.062655: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:42.079745: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:42.079761: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2020-05-21 16:32:50.822246: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:50.822404: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)
2020-05-21 16:32:50.822437: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (gl3264.arc-ts.umich.edu): /proc/driver/nvidia/version does not exist
2020-05-21 16:32:50.822778: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-05-21 16:32:50.829824: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3000000000 Hz
2020-05-21 16:32:50.829913: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x563c637af7e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-05-21 16:32:50.829923: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
/sw/arcts/centos7/python3.6-anaconda/5.2.0/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/array_grad.py:563: _EagerTensorBase.cpu (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.identity instead.
2020-05-21 16:58:56.093364: W tensorflow/python/util/util.cc:319] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1786: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
Test accuracy for step 250: 0.6194582581520081

Test GAP RMS for gender and step 250: 0.12767751514911652

Test GAP RMS for race and step 250: 0.01584441028535366

Test balanced accuracy for step 250: 0.4782073497772217


Test accuracy for step 500: 0.813930332660675

Test GAP RMS for gender and step 500: 0.3847410976886749

Test GAP RMS for race and step 500: 0.0874926745891571

Test balanced accuracy for step 500: 0.7841683626174927


Test accuracy for step 750: 0.8270868062973022

Test GAP RMS for gender and step 750: 0.30193930864334106

Test GAP RMS for race and step 750: 0.07806859165430069

Test balanced accuracy for step 750: 0.7933226227760315


Test accuracy for step 1000: 0.8386954069137573

Test GAP RMS for gender and step 1000: 0.27120810747146606

Test GAP RMS for race and step 1000: 0.08477848768234253

Test balanced accuracy for step 1000: 0.7928112745285034


Test accuracy for step 1250: 0.8407959938049316

Test GAP RMS for gender and step 1250: 0.25159838795661926

Test GAP RMS for race and step 1250: 0.08315257728099823

Test balanced accuracy for step 1250: 0.795742392539978


Test accuracy for step 1500: 0.8353786468505859

Test GAP RMS for gender and step 1500: 0.24493272602558136

Test GAP RMS for race and step 1500: 0.0688164234161377

Test balanced accuracy for step 1500: 0.7988002300262451


Test accuracy for step 1750: 0.8328357934951782

Test GAP RMS for gender and step 1750: 0.25311022996902466

Test GAP RMS for race and step 1750: 0.06557032465934753

Test balanced accuracy for step 1750: 0.8028310537338257


Test accuracy for step 2000: 0.8317302465438843

Test GAP RMS for gender and step 2000: 0.25349852442741394

Test GAP RMS for race and step 2000: 0.07458139955997467

Test balanced accuracy for step 2000: 0.8062679171562195


Test accuracy for step 2250: 0.8341625332832336

Test GAP RMS for gender and step 2250: 0.24751414358615875

Test GAP RMS for race and step 2250: 0.06844121217727661

Test balanced accuracy for step 2250: 0.80447918176651


Test accuracy for step 2500: 0.8341625332832336

Test GAP RMS for gender and step 2500: 0.2264901101589203

Test GAP RMS for race and step 2500: 0.06865967065095901

Test balanced accuracy for step 2500: 0.8063312768936157


Test accuracy for step 2750: 0.831066906452179

Test GAP RMS for gender and step 2750: 0.24076016247272491

Test GAP RMS for race and step 2750: 0.06713467091321945

Test balanced accuracy for step 2750: 0.8118489980697632


Test accuracy for step 3000: 0.8297401666641235

Test GAP RMS for gender and step 3000: 0.24880509078502655

Test GAP RMS for race and step 3000: 0.06469567865133286

Test balanced accuracy for step 3000: 0.8139050006866455


Test accuracy for step 3250: 0.8311774730682373

Test GAP RMS for gender and step 3250: 0.2383822351694107

Test GAP RMS for race and step 3250: 0.0717669427394867

Test balanced accuracy for step 3250: 0.8114590048789978


Test accuracy for step 3500: 0.8323935866355896

Test GAP RMS for gender and step 3500: 0.2126864343881607

Test GAP RMS for race and step 3500: 0.07528068870306015

Test balanced accuracy for step 3500: 0.8138058185577393


Test accuracy for step 3750: 0.8312879800796509

Test GAP RMS for gender and step 3750: 0.2069086730480194

Test GAP RMS for race and step 3750: 0.06331044435501099

Test balanced accuracy for step 3750: 0.8186317086219788


Test accuracy for step 4000: 0.8338308334350586

Test GAP RMS for gender and step 4000: 0.2138853371143341

Test GAP RMS for race and step 4000: 0.06582272052764893

Test balanced accuracy for step 4000: 0.8164529800415039


Test accuracy for step 4250: 0.8301824331283569

Test GAP RMS for gender and step 4250: 0.2170633226633072

Test GAP RMS for race and step 4250: 0.06421101838350296

Test balanced accuracy for step 4250: 0.8171296119689941


Test accuracy for step 4500: 0.8361525535583496

Test GAP RMS for gender and step 4500: 0.1959964483976364

Test GAP RMS for race and step 4500: 0.06422881782054901

Test balanced accuracy for step 4500: 0.8144369125366211


Test accuracy for step 4750: 0.8318408131599426

Test GAP RMS for gender and step 4750: 0.18626946210861206

Test GAP RMS for race and step 4750: 0.05937959998846054

Test balanced accuracy for step 4750: 0.820694625377655


Test accuracy for step 5000: 0.834273099899292

Test GAP RMS for gender and step 5000: 0.1816447675228119

Test GAP RMS for race and step 5000: 0.05914686247706413

Test balanced accuracy for step 5000: 0.8201406002044678


Test accuracy for step 5250: 0.8337202668190002

Test GAP RMS for gender and step 5250: 0.18323007225990295

Test GAP RMS for race and step 5250: 0.061173759400844574

Test balanced accuracy for step 5250: 0.8210102319717407


Test accuracy for step 5500: 0.8344941735267639

Test GAP RMS for gender and step 5500: 0.16131949424743652

Test GAP RMS for race and step 5500: 0.06014129891991615

Test balanced accuracy for step 5500: 0.8202866911888123


Test accuracy for step 5750: 0.8341625332832336

Test GAP RMS for gender and step 5750: 0.15309138596057892

Test GAP RMS for race and step 5750: 0.05436956137418747

Test balanced accuracy for step 5750: 0.8239260911941528


Test accuracy for step 6000: 0.8317302465438843

Test GAP RMS for gender and step 6000: 0.1566818654537201

Test GAP RMS for race and step 6000: 0.05867455527186394

Test balanced accuracy for step 6000: 0.8243257999420166


Test accuracy for step 6250: 0.8321724534034729

Test GAP RMS for gender and step 6250: 0.15418672561645508

Test GAP RMS for race and step 6250: 0.055800147354602814

Test balanced accuracy for step 6250: 0.825852632522583


Test accuracy for step 6500: 0.8328357934951782

Test GAP RMS for gender and step 6500: 0.1434396654367447

Test GAP RMS for race and step 6500: 0.058984849601984024

Test balanced accuracy for step 6500: 0.8276798725128174


Test accuracy for step 6750: 0.83338862657547

Test GAP RMS for gender and step 6750: 0.1306430846452713

Test GAP RMS for race and step 6750: 0.05894273892045021

Test balanced accuracy for step 6750: 0.823723554611206


Test accuracy for step 7000: 0.8306246399879456

Test GAP RMS for gender and step 7000: 0.1256444752216339

Test GAP RMS for race and step 7000: 0.060639459639787674

Test balanced accuracy for step 7000: 0.8268365859985352


Test accuracy for step 7250: 0.8304035663604736

Test GAP RMS for gender and step 7250: 0.12340939790010452

Test GAP RMS for race and step 7250: 0.060351915657520294

Test balanced accuracy for step 7250: 0.8273078203201294


Test accuracy for step 7500: 0.8296296000480652

Test GAP RMS for gender and step 7500: 0.12470221519470215

Test GAP RMS for race and step 7500: 0.05914359912276268

Test balanced accuracy for step 7500: 0.8250988721847534


Test accuracy for step 7750: 0.8273078799247742

Test GAP RMS for gender and step 7750: 0.11326015740633011

Test GAP RMS for race and step 7750: 0.06093936413526535

Test balanced accuracy for step 7750: 0.826343297958374


{'epsilon': 0.0001, 'lr': 0.0001, 'wlr': 5e-06, 'w_reg': 40.0}
Final test accuracy: 0.8259811997413635
Final test GAP RMS for gender: 0.10801643878221512
Final test GAP RMS for race: 0.05929798632860184
Final test balanced accuracy: 0.8240777254104614


