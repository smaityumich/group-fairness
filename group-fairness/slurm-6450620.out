2020-05-21 16:32:43.964315: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:43.965114: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:43.965127: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2020-05-21 16:32:53.803324: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:53.804792: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)
2020-05-21 16:32:53.804823: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (gl3099.arc-ts.umich.edu): /proc/driver/nvidia/version does not exist
2020-05-21 16:32:53.805200: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-05-21 16:32:53.811788: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3000000000 Hz
2020-05-21 16:32:53.811888: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55739275e7f0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-05-21 16:32:53.811899: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
/sw/arcts/centos7/python3.6-anaconda/5.2.0/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/array_grad.py:563: _EagerTensorBase.cpu (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.identity instead.
2020-05-21 16:59:43.738188: W tensorflow/python/util/util.cc:319] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1786: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
Test accuracy for step 250: 0.6191266179084778

Test GAP RMS for gender and step 250: 0.12815485894680023

Test GAP RMS for race and step 250: 0.014613297767937183

Test balanced accuracy for step 250: 0.4790686368942261


Test accuracy for step 500: 0.841238260269165

Test GAP RMS for gender and step 500: 0.2391430139541626

Test GAP RMS for race and step 500: 0.05934082716703415

Test balanced accuracy for step 500: 0.76933354139328


Test accuracy for step 750: 0.8473189473152161

Test GAP RMS for gender and step 750: 0.05025544762611389

Test GAP RMS for race and step 750: 0.03059246391057968

Test balanced accuracy for step 750: 0.758996844291687


Test accuracy for step 1000: 0.8474295139312744

Test GAP RMS for gender and step 1000: 0.033909399062395096

Test GAP RMS for race and step 1000: 0.030144279822707176

Test balanced accuracy for step 1000: 0.7371534109115601


Test accuracy for step 1250: 0.8452183604240417

Test GAP RMS for gender and step 1250: 0.02694924734532833

Test GAP RMS for race and step 1250: 0.025687502697110176

Test balanced accuracy for step 1250: 0.7256605625152588


Test accuracy for step 1500: 0.8452183604240417

Test GAP RMS for gender and step 1500: 0.02656714618206024

Test GAP RMS for race and step 1500: 0.017667166888713837

Test balanced accuracy for step 1500: 0.7210303544998169


Test accuracy for step 1750: 0.842343807220459

Test GAP RMS for gender and step 1750: 0.029600033536553383

Test GAP RMS for race and step 1750: 0.013712242245674133

Test balanced accuracy for step 1750: 0.7104883790016174


Test accuracy for step 2000: 0.8413488268852234

Test GAP RMS for gender and step 2000: 0.025685930624604225

Test GAP RMS for race and step 2000: 0.011479276232421398

Test balanced accuracy for step 2000: 0.7048921585083008


Test accuracy for step 2250: 0.838916540145874

Test GAP RMS for gender and step 2250: 0.022698339074850082

Test GAP RMS for race and step 2250: 0.012779644690454006

Test balanced accuracy for step 2250: 0.6954140067100525


Test accuracy for step 2500: 0.839801013469696

Test GAP RMS for gender and step 2500: 0.03233803063631058

Test GAP RMS for race and step 2500: 0.009214612655341625

Test balanced accuracy for step 2500: 0.6978503465652466


Test accuracy for step 2750: 0.8379215002059937

Test GAP RMS for gender and step 2750: 0.03709476813673973

Test GAP RMS for race and step 2750: 0.011082418262958527

Test balanced accuracy for step 2750: 0.6921328902244568


Test accuracy for step 3000: 0.8388059735298157

Test GAP RMS for gender and step 3000: 0.032532189041376114

Test GAP RMS for race and step 3000: 0.007778130006045103

Test balanced accuracy for step 3000: 0.6928715109825134


Test accuracy for step 3250: 0.838584840297699

Test GAP RMS for gender and step 3250: 0.02588464878499508

Test GAP RMS for race and step 3250: 0.006713762413710356

Test balanced accuracy for step 3250: 0.6913363933563232


Test accuracy for step 3500: 0.8411276936531067

Test GAP RMS for gender and step 3500: 0.01865239441394806

Test GAP RMS for race and step 3500: 0.010192579589784145

Test balanced accuracy for step 3500: 0.7004245519638062


Test accuracy for step 3750: 0.8419016003608704

Test GAP RMS for gender and step 3750: 0.018698928877711296

Test GAP RMS for race and step 3750: 0.009161359630525112

Test balanced accuracy for step 3750: 0.7018618583679199


Test accuracy for step 4000: 0.8410171270370483

Test GAP RMS for gender and step 4000: 0.01769653521478176

Test GAP RMS for race and step 4000: 0.007008460815995932

Test balanced accuracy for step 4000: 0.7006601691246033


Test accuracy for step 4250: 0.8479822874069214

Test GAP RMS for gender and step 4250: 0.044418662786483765

Test GAP RMS for race and step 4250: 0.023567726835608482

Test balanced accuracy for step 4250: 0.729801595211029


Test accuracy for step 4500: 0.8501935005187988

Test GAP RMS for gender and step 4500: 0.0447860024869442

Test GAP RMS for race and step 4500: 0.03479001671075821

Test balanced accuracy for step 4500: 0.7378989458084106


Test accuracy for step 4750: 0.8495301008224487

Test GAP RMS for gender and step 4750: 0.0442473329603672

Test GAP RMS for race and step 4750: 0.03235442563891411

Test balanced accuracy for step 4750: 0.7471842169761658


Test accuracy for step 5000: 0.8504145741462708

Test GAP RMS for gender and step 5000: 0.057688936591148376

Test GAP RMS for race and step 5000: 0.034135229885578156

Test balanced accuracy for step 5000: 0.768450140953064


Test accuracy for step 5250: 0.8491984605789185

Test GAP RMS for gender and step 5250: 0.0665242075920105

Test GAP RMS for race and step 5250: 0.044860247522592545

Test balanced accuracy for step 5250: 0.7804570198059082


Test accuracy for step 5500: 0.8477612137794495

Test GAP RMS for gender and step 5500: 0.07141505181789398

Test GAP RMS for race and step 5500: 0.04844614863395691

Test balanced accuracy for step 5500: 0.7821313738822937


Test accuracy for step 5750: 0.8490878939628601

Test GAP RMS for gender and step 5750: 0.06940523535013199

Test GAP RMS for race and step 5750: 0.048280369490385056

Test balanced accuracy for step 5750: 0.7908791303634644


Test accuracy for step 6000: 0.8486456871032715

Test GAP RMS for gender and step 6000: 0.0676635131239891

Test GAP RMS for race and step 6000: 0.05500192567706108

Test balanced accuracy for step 6000: 0.7901240587234497


Test accuracy for step 6250: 0.8473189473152161

Test GAP RMS for gender and step 6250: 0.0744413211941719

Test GAP RMS for race and step 6250: 0.060083143413066864

Test balanced accuracy for step 6250: 0.7918714284896851


Test accuracy for step 6500: 0.8448866605758667

Test GAP RMS for gender and step 6500: 0.08465215563774109

Test GAP RMS for race and step 6500: 0.06180567294359207

Test balanced accuracy for step 6500: 0.7964382171630859


Test accuracy for step 6750: 0.8479822874069214

Test GAP RMS for gender and step 6750: 0.0716405138373375

Test GAP RMS for race and step 6750: 0.05477321520447731

Test balanced accuracy for step 6750: 0.7904574871063232


Test accuracy for step 7000: 0.8456605672836304

Test GAP RMS for gender and step 7000: 0.07575006037950516

Test GAP RMS for race and step 7000: 0.05916972458362579

Test balanced accuracy for step 7000: 0.797103762626648


Test accuracy for step 7250: 0.8472083806991577

Test GAP RMS for gender and step 7250: 0.07255960255861282

Test GAP RMS for race and step 7250: 0.05711076036095619

Test balanced accuracy for step 7250: 0.7959655523300171


Test accuracy for step 7500: 0.8436705470085144

Test GAP RMS for gender and step 7500: 0.08844731003046036

Test GAP RMS for race and step 7500: 0.053147830069065094

Test balanced accuracy for step 7500: 0.7965608835220337


Test accuracy for step 7750: 0.8462134003639221

Test GAP RMS for gender and step 7750: 0.07712925225496292

Test GAP RMS for race and step 7750: 0.06076910346746445

Test balanced accuracy for step 7750: 0.7953082323074341


{'epsilon': 0.01, 'lr': 0.0001, 'wlr': 0.0001, 'w_reg': 30.0}
Final test accuracy: 0.8470978736877441
Final test GAP RMS for gender: 0.06882217526435852
Final test GAP RMS for race: 0.05104988068342209
Final test balanced accuracy: 0.7918796539306641


