2020-05-21 16:32:43.113301: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:43.113403: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:43.113413: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2020-05-21 16:32:52.973849: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:52.974160: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)
2020-05-21 16:32:52.974213: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (gl3108.arc-ts.umich.edu): /proc/driver/nvidia/version does not exist
2020-05-21 16:32:52.974706: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-05-21 16:32:52.983145: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3000000000 Hz
2020-05-21 16:32:52.983293: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55fa9013d6c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-05-21 16:32:52.983305: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
/sw/arcts/centos7/python3.6-anaconda/5.2.0/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/array_grad.py:563: _EagerTensorBase.cpu (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.identity instead.
2020-05-21 16:59:10.707888: W tensorflow/python/util/util.cc:319] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1786: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
Test accuracy for step 250: 0.6189054846763611

Test GAP RMS for gender and step 250: 0.12846167385578156

Test GAP RMS for race and step 250: 0.01470988243818283

Test balanced accuracy for step 250: 0.4787682294845581


Test accuracy for step 500: 0.8103924989700317

Test GAP RMS for gender and step 500: 0.36818116903305054

Test GAP RMS for race and step 500: 0.08407896757125854

Test balanced accuracy for step 500: 0.7901656627655029


Test accuracy for step 750: 0.8237700462341309

Test GAP RMS for gender and step 750: 0.2949947416782379

Test GAP RMS for race and step 750: 0.08323422074317932

Test balanced accuracy for step 750: 0.7999289631843567


Test accuracy for step 1000: 0.8326147198677063

Test GAP RMS for gender and step 1000: 0.24808067083358765

Test GAP RMS for race and step 1000: 0.08108226209878922

Test balanced accuracy for step 1000: 0.7986721396446228


Test accuracy for step 1250: 0.83338862657547

Test GAP RMS for gender and step 1250: 0.22978492081165314

Test GAP RMS for race and step 1250: 0.07056593894958496

Test balanced accuracy for step 1250: 0.8008811473846436


Test accuracy for step 1500: 0.8318408131599426

Test GAP RMS for gender and step 1500: 0.2206486165523529

Test GAP RMS for race and step 1500: 0.07308223098516464

Test balanced accuracy for step 1500: 0.8064953088760376


Test accuracy for step 1750: 0.8311774730682373

Test GAP RMS for gender and step 1750: 0.22542181611061096

Test GAP RMS for race and step 1750: 0.07780414819717407

Test balanced accuracy for step 1750: 0.8114590048789978


Test accuracy for step 2000: 0.8292979598045349

Test GAP RMS for gender and step 2000: 0.225698322057724

Test GAP RMS for race and step 2000: 0.07771449536085129

Test balanced accuracy for step 2000: 0.8137672543525696


Test accuracy for step 2250: 0.8309563398361206

Test GAP RMS for gender and step 2250: 0.22603608667850494

Test GAP RMS for race and step 2250: 0.07342071831226349

Test balanced accuracy for step 2250: 0.8114672899246216


Test accuracy for step 2500: 0.832504153251648

Test GAP RMS for gender and step 2500: 0.20303867757320404

Test GAP RMS for race and step 2500: 0.07352467626333237

Test balanced accuracy for step 2500: 0.8143418431282043


Test accuracy for step 2750: 0.8284134864807129

Test GAP RMS for gender and step 2750: 0.2140577882528305

Test GAP RMS for race and step 2750: 0.06392449140548706

Test balanced accuracy for step 2750: 0.819202184677124


Test accuracy for step 3000: 0.8269762396812439

Test GAP RMS for gender and step 3000: 0.22096697986125946

Test GAP RMS for race and step 3000: 0.06726612150669098

Test balanced accuracy for step 3000: 0.8185614347457886


Test accuracy for step 3250: 0.8283029198646545

Test GAP RMS for gender and step 3250: 0.2135298103094101

Test GAP RMS for race and step 3250: 0.06773003190755844

Test balanced accuracy for step 3250: 0.8185118436813354


Test accuracy for step 3500: 0.8285240530967712

Test GAP RMS for gender and step 3500: 0.2023502141237259

Test GAP RMS for race and step 3500: 0.06310128420591354

Test balanced accuracy for step 3500: 0.8197382688522339


Test accuracy for step 3750: 0.8249861598014832

Test GAP RMS for gender and step 3750: 0.1969331055879593

Test GAP RMS for race and step 3750: 0.06097136065363884

Test balanced accuracy for step 3750: 0.820179283618927


Test accuracy for step 4000: 0.8289662599563599

Test GAP RMS for gender and step 4000: 0.20274819433689117

Test GAP RMS for race and step 4000: 0.06107781082391739

Test balanced accuracy for step 4000: 0.8189500570297241


Test accuracy for step 4250: 0.8259811997413635

Test GAP RMS for gender and step 4250: 0.20318283140659332

Test GAP RMS for race and step 4250: 0.06334848701953888

Test balanced accuracy for step 4250: 0.8211452960968018


Test accuracy for step 4500: 0.8323935866355896

Test GAP RMS for gender and step 4500: 0.18124082684516907

Test GAP RMS for race and step 4500: 0.06447775661945343

Test balanced accuracy for step 4500: 0.8209054470062256


Test accuracy for step 4750: 0.8274184465408325

Test GAP RMS for gender and step 4750: 0.17634788155555725

Test GAP RMS for race and step 4750: 0.058060865849256516

Test balanced accuracy for step 4750: 0.8251816034317017


Test accuracy for step 5000: 0.8296296000480652

Test GAP RMS for gender and step 5000: 0.17374898493289948

Test GAP RMS for race and step 5000: 0.05640453100204468

Test balanced accuracy for step 5000: 0.8235554695129395


Test accuracy for step 5250: 0.8287451863288879

Test GAP RMS for gender and step 5250: 0.1732436567544937

Test GAP RMS for race and step 5250: 0.058888863772153854

Test balanced accuracy for step 5250: 0.826058030128479


Test accuracy for step 5500: 0.8299612998962402

Test GAP RMS for gender and step 5500: 0.15927442908287048

Test GAP RMS for race and step 5500: 0.056618109345436096

Test balanced accuracy for step 5500: 0.8243919610977173


Test accuracy for step 5750: 0.8284134864807129

Test GAP RMS for gender and step 5750: 0.15507999062538147

Test GAP RMS for race and step 5750: 0.06126783788204193

Test balanced accuracy for step 5750: 0.8275366425514221


Test accuracy for step 6000: 0.8263128995895386

Test GAP RMS for gender and step 6000: 0.15651679039001465

Test GAP RMS for race and step 6000: 0.06223602965474129

Test balanced accuracy for step 6000: 0.8286184072494507


Test accuracy for step 6250: 0.8256495594978333

Test GAP RMS for gender and step 6250: 0.15336206555366516

Test GAP RMS for race and step 6250: 0.06399644911289215

Test balanced accuracy for step 6250: 0.8287975788116455


Test accuracy for step 6500: 0.8257600665092468

Test GAP RMS for gender and step 6500: 0.1483515501022339

Test GAP RMS for race and step 6500: 0.06480973958969116

Test balanced accuracy for step 6500: 0.8294879198074341


Test accuracy for step 6750: 0.8289662599563599

Test GAP RMS for gender and step 6750: 0.13412046432495117

Test GAP RMS for race and step 6750: 0.06532736122608185

Test balanced accuracy for step 6750: 0.8283648490905762


Test accuracy for step 7000: 0.8257600665092468

Test GAP RMS for gender and step 7000: 0.1347062885761261

Test GAP RMS for race and step 7000: 0.0669960156083107

Test balanced accuracy for step 7000: 0.8285619020462036


Test accuracy for step 7250: 0.8260917663574219

Test GAP RMS for gender and step 7250: 0.1329546719789505

Test GAP RMS for race and step 7250: 0.06312838196754456

Test balanced accuracy for step 7250: 0.8273919820785522


Test accuracy for step 7500: 0.8275290131568909

Test GAP RMS for gender and step 7500: 0.13345564901828766

Test GAP RMS for race and step 7500: 0.060438938438892365

Test balanced accuracy for step 7500: 0.8272610306739807


Test accuracy for step 7750: 0.8238806128501892

Test GAP RMS for gender and step 7750: 0.12463858723640442

Test GAP RMS for race and step 7750: 0.06611102819442749

Test balanced accuracy for step 7750: 0.8277833461761475


{'epsilon': 0.0001, 'lr': 0.0001, 'wlr': 5e-06, 'w_reg': 30.0}
Final test accuracy: 0.8238806128501892
Final test GAP RMS for gender: 0.11775922030210495
Final test GAP RMS for race: 0.06525375694036484
Final test balanced accuracy: 0.8263943195343018


