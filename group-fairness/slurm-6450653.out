2020-05-21 16:32:42.062652: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:42.079765: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:42.079777: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2020-05-21 16:32:50.816708: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:50.816901: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)
2020-05-21 16:32:50.816925: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (gl3264.arc-ts.umich.edu): /proc/driver/nvidia/version does not exist
2020-05-21 16:32:50.817327: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-05-21 16:32:50.824663: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3000000000 Hz
2020-05-21 16:32:50.824755: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55b955ce7350 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-05-21 16:32:50.824764: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
/sw/arcts/centos7/python3.6-anaconda/5.2.0/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/array_grad.py:563: _EagerTensorBase.cpu (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.identity instead.
2020-05-21 16:59:07.214558: W tensorflow/python/util/util.cc:319] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1786: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
Test accuracy for step 250: 0.6187949180603027

Test GAP RMS for gender and step 250: 0.12808294594287872

Test GAP RMS for race and step 250: 0.01430792547762394

Test balanced accuracy for step 250: 0.47884953022003174


Test accuracy for step 500: 0.8065229654312134

Test GAP RMS for gender and step 500: 0.37094128131866455

Test GAP RMS for race and step 500: 0.08253446221351624

Test balanced accuracy for step 500: 0.7931656837463379


Test accuracy for step 750: 0.8179104328155518

Test GAP RMS for gender and step 750: 0.3028850853443146

Test GAP RMS for race and step 750: 0.082053042948246

Test balanced accuracy for step 750: 0.8093314170837402


Test accuracy for step 1000: 0.8218905329704285

Test GAP RMS for gender and step 1000: 0.2772693634033203

Test GAP RMS for race and step 1000: 0.07584820687770844

Test balanced accuracy for step 1000: 0.811497688293457


Test accuracy for step 1250: 0.8162520527839661

Test GAP RMS for gender and step 1250: 0.2708430886268616

Test GAP RMS for race and step 1250: 0.07436666637659073

Test balanced accuracy for step 1250: 0.8151812553405762


Test accuracy for step 1500: 0.8158098459243774

Test GAP RMS for gender and step 1500: 0.25528571009635925

Test GAP RMS for race and step 1500: 0.07820045948028564

Test balanced accuracy for step 1500: 0.8199822902679443


Test accuracy for step 1750: 0.8119403123855591

Test GAP RMS for gender and step 1750: 0.2583678960800171

Test GAP RMS for race and step 1750: 0.07883965969085693

Test balanced accuracy for step 1750: 0.8200498819351196


Test accuracy for step 2000: 0.8122719526290894

Test GAP RMS for gender and step 2000: 0.2488623410463333

Test GAP RMS for race and step 2000: 0.07864487916231155

Test balanced accuracy for step 2000: 0.8213493824005127


Test accuracy for step 2250: 0.8158098459243774

Test GAP RMS for gender and step 2250: 0.23730970919132233

Test GAP RMS for race and step 2250: 0.07272066920995712

Test balanced accuracy for step 2250: 0.8205996751785278


Test accuracy for step 2500: 0.8189054727554321

Test GAP RMS for gender and step 2500: 0.2128044217824936

Test GAP RMS for race and step 2500: 0.06693931668996811

Test balanced accuracy for step 2500: 0.8246511220932007


Test accuracy for step 2750: 0.8120508790016174

Test GAP RMS for gender and step 2750: 0.2179175466299057

Test GAP RMS for race and step 2750: 0.07495012879371643

Test balanced accuracy for step 2750: 0.8250617980957031


Test accuracy for step 3000: 0.8120508790016174

Test GAP RMS for gender and step 3000: 0.213120698928833

Test GAP RMS for race and step 3000: 0.0732252448797226

Test balanced accuracy for step 3000: 0.8249074220657349


Test accuracy for step 3250: 0.815367579460144

Test GAP RMS for gender and step 3250: 0.19243302941322327

Test GAP RMS for race and step 3250: 0.06828190386295319

Test balanced accuracy for step 3250: 0.824783444404602


Test accuracy for step 3500: 0.8162520527839661

Test GAP RMS for gender and step 3500: 0.17845231294631958

Test GAP RMS for race and step 3500: 0.06884866207838058

Test balanced accuracy for step 3500: 0.8278371691703796


Test accuracy for step 3750: 0.8148148059844971

Test GAP RMS for gender and step 3750: 0.1702270805835724

Test GAP RMS for race and step 3750: 0.06999018788337708

Test balanced accuracy for step 3750: 0.8293571472167969


Test accuracy for step 4000: 0.8170259594917297

Test GAP RMS for gender and step 4000: 0.17246569693088531

Test GAP RMS for race and step 4000: 0.0636909157037735

Test balanced accuracy for step 4000: 0.826341986656189


Test accuracy for step 4250: 0.8112769722938538

Test GAP RMS for gender and step 4250: 0.1734153777360916

Test GAP RMS for race and step 4250: 0.0728290006518364

Test balanced accuracy for step 4250: 0.8279460668563843


Test accuracy for step 4500: 0.8189054727554321

Test GAP RMS for gender and step 4500: 0.15624798834323883

Test GAP RMS for race and step 4500: 0.06251002103090286

Test balanced accuracy for step 4500: 0.8288183212280273


Test accuracy for step 4750: 0.8132669925689697

Test GAP RMS for gender and step 4750: 0.15458036959171295

Test GAP RMS for race and step 4750: 0.06829971820116043

Test balanced accuracy for step 4750: 0.8297237157821655


Test accuracy for step 5000: 0.8172470927238464

Test GAP RMS for gender and step 5000: 0.15588043630123138

Test GAP RMS for race and step 5000: 0.06523237377405167

Test balanced accuracy for step 5000: 0.8289574980735779


Test accuracy for step 5250: 0.8160309791564941

Test GAP RMS for gender and step 5250: 0.15579354763031006

Test GAP RMS for race and step 5250: 0.06503783166408539

Test balanced accuracy for step 5250: 0.8289257884025574


Test accuracy for step 5500: 0.8191266059875488

Test GAP RMS for gender and step 5500: 0.1409830003976822

Test GAP RMS for race and step 5500: 0.06359533220529556

Test balanced accuracy for step 5500: 0.8291187286376953


Test accuracy for step 5750: 0.8185737729072571

Test GAP RMS for gender and step 5750: 0.13219471275806427

Test GAP RMS for race and step 5750: 0.06453423202037811

Test balanced accuracy for step 5750: 0.8299882411956787


Test accuracy for step 6000: 0.8170259594917297

Test GAP RMS for gender and step 6000: 0.13729646801948547

Test GAP RMS for race and step 6000: 0.06405360251665115

Test balanced accuracy for step 6000: 0.8291200995445251


Test accuracy for step 6250: 0.8172470927238464

Test GAP RMS for gender and step 6250: 0.13478703796863556

Test GAP RMS for race and step 6250: 0.06439968198537827

Test balanced accuracy for step 6250: 0.8278771042823792


Test accuracy for step 6500: 0.8174682259559631

Test GAP RMS for gender and step 6500: 0.12538224458694458

Test GAP RMS for race and step 6500: 0.0646049752831459

Test balanced accuracy for step 6500: 0.8277145028114319


Test accuracy for step 6750: 0.8227750062942505

Test GAP RMS for gender and step 6750: 0.10832524299621582

Test GAP RMS for race and step 6750: 0.0596347339451313

Test balanced accuracy for step 6750: 0.8267443180084229


Test accuracy for step 7000: 0.8194582462310791

Test GAP RMS for gender and step 7000: 0.11006215959787369

Test GAP RMS for race and step 7000: 0.06524960696697235

Test balanced accuracy for step 7000: 0.8270226716995239


Test accuracy for step 7250: 0.8214483261108398

Test GAP RMS for gender and step 7250: 0.10538085550069809

Test GAP RMS for race and step 7250: 0.06142568588256836

Test balanced accuracy for step 7250: 0.8258678913116455


Test accuracy for step 7500: 0.8222222328186035

Test GAP RMS for gender and step 7500: 0.1029723584651947

Test GAP RMS for race and step 7500: 0.058153945952653885

Test balanced accuracy for step 7500: 0.8248357176780701


Test accuracy for step 7750: 0.8190160393714905

Test GAP RMS for gender and step 7750: 0.09460123628377914

Test GAP RMS for race and step 7750: 0.06124558299779892

Test balanced accuracy for step 7750: 0.8230264186859131


{'epsilon': 1e-05, 'lr': 0.0001, 'wlr': 1e-05, 'w_reg': 40.0}
Final test accuracy: 0.8177998661994934
Final test GAP RMS for gender: 0.09149292856454849
Final test GAP RMS for race: 0.055999014526605606
Final test balanced accuracy: 0.8219143152236938


