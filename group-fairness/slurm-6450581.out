2020-05-21 16:32:42.219408: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:42.220014: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:42.220025: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2020-05-21 16:32:48.357059: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:48.358025: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)
2020-05-21 16:32:48.358051: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (gl3254.arc-ts.umich.edu): /proc/driver/nvidia/version does not exist
2020-05-21 16:32:48.374164: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-05-21 16:32:48.407181: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3000000000 Hz
2020-05-21 16:32:48.407305: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55d758364cd0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-05-21 16:32:48.407318: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
/sw/arcts/centos7/python3.6-anaconda/5.2.0/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/array_grad.py:563: _EagerTensorBase.cpu (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.identity instead.
2020-05-21 16:59:23.212808: W tensorflow/python/util/util.cc:319] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1786: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
Test accuracy for step 250: 0.6172471046447754

Test GAP RMS for gender and step 250: 0.12831564247608185

Test GAP RMS for race and step 250: 0.018792113289237022

Test balanced accuracy for step 250: 0.48214858770370483


Test accuracy for step 500: 0.807517945766449

Test GAP RMS for gender and step 500: 0.2716989815235138

Test GAP RMS for race and step 500: 0.072964608669281

Test balanced accuracy for step 500: 0.8072506189346313


Test accuracy for step 750: 0.8162520527839661

Test GAP RMS for gender and step 750: 0.20731987059116364

Test GAP RMS for race and step 750: 0.05905679240822792

Test balanced accuracy for step 750: 0.8176506757736206


Test accuracy for step 1000: 0.8235489130020142

Test GAP RMS for gender and step 1000: 0.193632572889328

Test GAP RMS for race and step 1000: 0.057680677622556686

Test balanced accuracy for step 1000: 0.8158343434333801


Test accuracy for step 1250: 0.8249861598014832

Test GAP RMS for gender and step 1250: 0.18897490203380585

Test GAP RMS for race and step 1250: 0.05883347988128662

Test balanced accuracy for step 1250: 0.8187901973724365


Test accuracy for step 1500: 0.8211166262626648

Test GAP RMS for gender and step 1500: 0.17269787192344666

Test GAP RMS for race and step 1500: 0.06068974360823631

Test balanced accuracy for step 1500: 0.8222532868385315


Test accuracy for step 1750: 0.8206744194030762

Test GAP RMS for gender and step 1750: 0.18226072192192078

Test GAP RMS for race and step 1750: 0.05752353370189667

Test balanced accuracy for step 1750: 0.821806788444519


Test accuracy for step 2000: 0.8201215863227844

Test GAP RMS for gender and step 2000: 0.1810002624988556

Test GAP RMS for race and step 2000: 0.059543099254369736

Test balanced accuracy for step 2000: 0.8237566947937012


Test accuracy for step 2250: 0.8239911794662476

Test GAP RMS for gender and step 2250: 0.1784425973892212

Test GAP RMS for race and step 2250: 0.06292293965816498

Test balanced accuracy for step 2250: 0.8209110498428345


Test accuracy for step 2500: 0.8250967264175415

Test GAP RMS for gender and step 2500: 0.15790419280529022

Test GAP RMS for race and step 2500: 0.05545267462730408

Test balanced accuracy for step 2500: 0.8236478567123413


Test accuracy for step 2750: 0.8207849860191345

Test GAP RMS for gender and step 2750: 0.16452039778232574

Test GAP RMS for race and step 2750: 0.058295562863349915

Test balanced accuracy for step 2750: 0.8289794921875


Test accuracy for step 3000: 0.8231067061424255

Test GAP RMS for gender and step 3000: 0.16756442189216614

Test GAP RMS for race and step 3000: 0.05464649945497513

Test balanced accuracy for step 3000: 0.826500415802002


Test accuracy for step 3250: 0.8243228197097778

Test GAP RMS for gender and step 3250: 0.1600322425365448

Test GAP RMS for race and step 3250: 0.055416274815797806

Test balanced accuracy for step 3250: 0.8262233734130859


Test accuracy for step 3500: 0.8239911794662476

Test GAP RMS for gender and step 3500: 0.151680126786232

Test GAP RMS for race and step 3500: 0.058121077716350555

Test balanced accuracy for step 3500: 0.8270846605300903


Test accuracy for step 3750: 0.8221116662025452

Test GAP RMS for gender and step 3750: 0.15031428635120392

Test GAP RMS for race and step 3750: 0.05937929078936577

Test balanced accuracy for step 3750: 0.8276951313018799


Test accuracy for step 4000: 0.8264234662055969

Test GAP RMS for gender and step 4000: 0.15203647315502167

Test GAP RMS for race and step 4000: 0.05444657802581787

Test balanced accuracy for step 4000: 0.8245242834091187


Test accuracy for step 4250: 0.8247650861740112

Test GAP RMS for gender and step 4250: 0.1525823026895523

Test GAP RMS for race and step 4250: 0.05678075551986694

Test balanced accuracy for step 4250: 0.8269785642623901


Test accuracy for step 4500: 0.8296296000480652

Test GAP RMS for gender and step 4500: 0.14152660965919495

Test GAP RMS for race and step 4500: 0.05704012140631676

Test balanced accuracy for step 4500: 0.8246358633041382


Test accuracy for step 4750: 0.8221116662025452

Test GAP RMS for gender and step 4750: 0.1437009572982788

Test GAP RMS for race and step 4750: 0.06094884127378464

Test balanced accuracy for step 4750: 0.8290842771530151


Test accuracy for step 5000: 0.8263128995895386

Test GAP RMS for gender and step 5000: 0.13937534391880035

Test GAP RMS for race and step 5000: 0.05491345003247261

Test balanced accuracy for step 5000: 0.825994610786438


Test accuracy for step 5250: 0.8245439529418945

Test GAP RMS for gender and step 5250: 0.14214877784252167

Test GAP RMS for race and step 5250: 0.056605271995067596

Test balanced accuracy for step 5250: 0.8265237808227539


Test accuracy for step 5500: 0.8255389928817749

Test GAP RMS for gender and step 5500: 0.13581165671348572

Test GAP RMS for race and step 5500: 0.061283502727746964

Test balanced accuracy for step 5500: 0.8265637755393982


Test accuracy for step 5750: 0.8229961395263672

Test GAP RMS for gender and step 5750: 0.1295081377029419

Test GAP RMS for race and step 5750: 0.06158410385251045

Test balanced accuracy for step 5750: 0.8281251192092896


Test accuracy for step 6000: 0.8210060596466064

Test GAP RMS for gender and step 6000: 0.13640856742858887

Test GAP RMS for race and step 6000: 0.05958569422364235

Test balanced accuracy for step 6000: 0.8271191716194153


Test accuracy for step 6250: 0.8228855729103088

Test GAP RMS for gender and step 6250: 0.1407238394021988

Test GAP RMS for race and step 6250: 0.06245618313550949

Test balanced accuracy for step 6250: 0.8292868137359619


Test accuracy for step 6500: 0.8225538730621338

Test GAP RMS for gender and step 6500: 0.13625571131706238

Test GAP RMS for race and step 6500: 0.06199456751346588

Test balanced accuracy for step 6500: 0.8290677070617676


Test accuracy for step 6750: 0.8250967264175415

Test GAP RMS for gender and step 6750: 0.11810749024152756

Test GAP RMS for race and step 6750: 0.05834270641207695

Test balanced accuracy for step 6750: 0.822258710861206


Test accuracy for step 7000: 0.8233277797698975

Test GAP RMS for gender and step 7000: 0.12033219635486603

Test GAP RMS for race and step 7000: 0.05565574765205383

Test balanced accuracy for step 7000: 0.8260290622711182


Test accuracy for step 7250: 0.8241016864776611

Test GAP RMS for gender and step 7250: 0.12439045310020447

Test GAP RMS for race and step 7250: 0.05787675827741623

Test balanced accuracy for step 7250: 0.8248425722122192


Test accuracy for step 7500: 0.8254284262657166

Test GAP RMS for gender and step 7500: 0.12721389532089233

Test GAP RMS for race and step 7500: 0.05796930938959122

Test balanced accuracy for step 7500: 0.8252559900283813


Test accuracy for step 7750: 0.8244333863258362

Test GAP RMS for gender and step 7750: 0.11644540727138519

Test GAP RMS for race and step 7750: 0.05790017172694206

Test balanced accuracy for step 7750: 0.8252160549163818


{'epsilon': 0.001, 'lr': 0.0001, 'wlr': 5e-06, 'w_reg': 10.0}
Final test accuracy: 0.8220010995864868
Final test GAP RMS for gender: 0.11038681119680405
Final test GAP RMS for race: 0.05914170667529106
Final test balanced accuracy: 0.8242266178131104


