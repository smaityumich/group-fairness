2020-05-21 16:32:42.219405: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:42.220031: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:42.220049: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2020-05-21 16:32:48.354120: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:48.356061: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)
2020-05-21 16:32:48.357951: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (gl3254.arc-ts.umich.edu): /proc/driver/nvidia/version does not exist
2020-05-21 16:32:48.374172: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-05-21 16:32:48.407183: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3000000000 Hz
2020-05-21 16:32:48.407350: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55f8736f7b20 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-05-21 16:32:48.407362: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
/sw/arcts/centos7/python3.6-anaconda/5.2.0/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/array_grad.py:563: _EagerTensorBase.cpu (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.identity instead.
2020-05-21 17:00:09.160416: W tensorflow/python/util/util.cc:319] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1786: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
Test accuracy for step 250: 0.6194582581520081

Test GAP RMS for gender and step 250: 0.12885941565036774

Test GAP RMS for race and step 250: 0.015196235850453377

Test balanced accuracy for step 250: 0.4785160422325134


Test accuracy for step 500: 0.8396904468536377

Test GAP RMS for gender and step 500: 0.26393765211105347

Test GAP RMS for race and step 500: 0.061163853853940964

Test balanced accuracy for step 500: 0.7676936984062195


Test accuracy for step 750: 0.8476506471633911

Test GAP RMS for gender and step 750: 0.13319642841815948

Test GAP RMS for race and step 750: 0.05664152652025223

Test balanced accuracy for step 750: 0.7727978825569153


Test accuracy for step 1000: 0.8480928540229797

Test GAP RMS for gender and step 1000: 0.08551595360040665

Test GAP RMS for race and step 1000: 0.041306570172309875

Test balanced accuracy for step 1000: 0.7591993808746338


Test accuracy for step 1250: 0.8511884808540344

Test GAP RMS for gender and step 1250: 0.06287265568971634

Test GAP RMS for race and step 1250: 0.04140428081154823

Test balanced accuracy for step 1250: 0.7657202482223511


Test accuracy for step 1500: 0.8507462739944458

Test GAP RMS for gender and step 1500: 0.05894631892442703

Test GAP RMS for race and step 1500: 0.03735070303082466

Test balanced accuracy for step 1500: 0.7695952653884888


Test accuracy for step 1750: 0.8507462739944458

Test GAP RMS for gender and step 1750: 0.06326134502887726

Test GAP RMS for race and step 1750: 0.04800310358405113

Test balanced accuracy for step 1750: 0.7731451392173767


Test accuracy for step 2000: 0.8520729541778564

Test GAP RMS for gender and step 2000: 0.05742989480495453

Test GAP RMS for race and step 2000: 0.04690266773104668

Test balanced accuracy for step 2000: 0.7761822938919067


Test accuracy for step 2250: 0.8517413139343262

Test GAP RMS for gender and step 2250: 0.05278332158923149

Test GAP RMS for race and step 2250: 0.03987515717744827

Test balanced accuracy for step 2250: 0.772258996963501


Test accuracy for step 2500: 0.8527362942695618

Test GAP RMS for gender and step 2500: 0.05035587027668953

Test GAP RMS for race and step 2500: 0.034166816622018814

Test balanced accuracy for step 2500: 0.7750771045684814


Test accuracy for step 2750: 0.8504145741462708

Test GAP RMS for gender and step 2750: 0.06075587868690491

Test GAP RMS for race and step 2750: 0.0382997989654541

Test balanced accuracy for step 2750: 0.7821865081787109


Test accuracy for step 3000: 0.8517413139343262

Test GAP RMS for gender and step 3000: 0.058078501373529434

Test GAP RMS for race and step 3000: 0.03950288146734238

Test balanced accuracy for step 3000: 0.7805933952331543


Test accuracy for step 3250: 0.8515201807022095

Test GAP RMS for gender and step 3250: 0.0581941157579422

Test GAP RMS for race and step 3250: 0.04075673967599869

Test balanced accuracy for step 3250: 0.7796756625175476


Test accuracy for step 3500: 0.8517413139343262

Test GAP RMS for gender and step 3500: 0.05646027252078056

Test GAP RMS for race and step 3500: 0.03664100542664528

Test balanced accuracy for step 3500: 0.781673789024353


Test accuracy for step 3750: 0.8525152206420898

Test GAP RMS for gender and step 3750: 0.05707920715212822

Test GAP RMS for race and step 3750: 0.04665578156709671

Test balanced accuracy for step 3750: 0.7865066528320312


Test accuracy for step 4000: 0.8531785607337952

Test GAP RMS for gender and step 4000: 0.05526616424322128

Test GAP RMS for race and step 4000: 0.04081430286169052

Test balanced accuracy for step 4000: 0.7815428972244263


Test accuracy for step 4250: 0.8519623875617981

Test GAP RMS for gender and step 4250: 0.05754971504211426

Test GAP RMS for race and step 4250: 0.043917033821344376

Test balanced accuracy for step 4250: 0.7815111875534058


Test accuracy for step 4500: 0.8514096140861511

Test GAP RMS for gender and step 4500: 0.05344953387975693

Test GAP RMS for race and step 4500: 0.03204437345266342

Test balanced accuracy for step 4500: 0.7749724388122559


Test accuracy for step 4750: 0.8517413139343262

Test GAP RMS for gender and step 4750: 0.058171939104795456

Test GAP RMS for race and step 4750: 0.04586239159107208

Test balanced accuracy for step 4750: 0.7858409881591797


Test accuracy for step 5000: 0.8515201807022095

Test GAP RMS for gender and step 5000: 0.05562616139650345

Test GAP RMS for race and step 5000: 0.04642676189541817

Test balanced accuracy for step 5000: 0.782608151435852


Test accuracy for step 5250: 0.8524046540260315

Test GAP RMS for gender and step 5250: 0.054378557950258255

Test GAP RMS for race and step 5250: 0.03585701063275337

Test balanced accuracy for step 5250: 0.7825750708580017


Test accuracy for step 5500: 0.8525152206420898

Test GAP RMS for gender and step 5500: 0.055431872606277466

Test GAP RMS for race and step 5500: 0.04093275964260101

Test balanced accuracy for step 5500: 0.7852718830108643


Test accuracy for step 5750: 0.8511884808540344

Test GAP RMS for gender and step 5750: 0.06077263876795769

Test GAP RMS for race and step 5750: 0.05163216218352318

Test balanced accuracy for step 5750: 0.7908778190612793


Test accuracy for step 6000: 0.8510779142379761

Test GAP RMS for gender and step 6000: 0.061455223709344864

Test GAP RMS for race and step 6000: 0.04859022796154022

Test balanced accuracy for step 6000: 0.7920395135879517


Test accuracy for step 6250: 0.8491984605789185

Test GAP RMS for gender and step 6250: 0.06347552686929703

Test GAP RMS for race and step 6250: 0.04973503574728966

Test balanced accuracy for step 6250: 0.7898718118667603


Test accuracy for step 6500: 0.8499723672866821

Test GAP RMS for gender and step 6500: 0.0661999061703682

Test GAP RMS for race and step 6500: 0.04636629670858383

Test balanced accuracy for step 6500: 0.7919265031814575


Test accuracy for step 6750: 0.8526257872581482

Test GAP RMS for gender and step 6750: 0.054980143904685974

Test GAP RMS for race and step 6750: 0.038892053067684174

Test balanced accuracy for step 6750: 0.7859622836112976


Test accuracy for step 7000: 0.8518518805503845

Test GAP RMS for gender and step 7000: 0.05885159224271774

Test GAP RMS for race and step 7000: 0.04501235857605934

Test balanced accuracy for step 7000: 0.7899269461631775


Test accuracy for step 7250: 0.8511884808540344

Test GAP RMS for gender and step 7250: 0.06103680655360222

Test GAP RMS for race and step 7250: 0.04532679170370102

Test balanced accuracy for step 7250: 0.7896430492401123


Test accuracy for step 7500: 0.8514096140861511

Test GAP RMS for gender and step 7500: 0.061508312821388245

Test GAP RMS for race and step 7500: 0.04276792332530022

Test balanced accuracy for step 7500: 0.788245677947998


Test accuracy for step 7750: 0.8517413139343262

Test GAP RMS for gender and step 7750: 0.058591440320014954

Test GAP RMS for race and step 7750: 0.04285705089569092

Test balanced accuracy for step 7750: 0.7886191606521606


{'epsilon': 0.1, 'lr': 0.0001, 'wlr': 1e-05, 'w_reg': 10.0}
Final test accuracy: 0.8494195938110352
Final test GAP RMS for gender: 0.06242431327700615
Final test GAP RMS for race: 0.04286094009876251
Final test balanced accuracy: 0.7920243144035339


