2020-05-21 16:32:42.219390: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:42.219997: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:42.220009: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2020-05-21 16:32:48.355678: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:48.356642: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)
2020-05-21 16:32:48.357955: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (gl3254.arc-ts.umich.edu): /proc/driver/nvidia/version does not exist
2020-05-21 16:32:48.374149: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-05-21 16:32:48.407171: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3000000000 Hz
2020-05-21 16:32:48.407300: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55d0270ed4b0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-05-21 16:32:48.407313: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
/sw/arcts/centos7/python3.6-anaconda/5.2.0/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/array_grad.py:563: _EagerTensorBase.cpu (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.identity instead.
2020-05-21 16:59:23.231308: W tensorflow/python/util/util.cc:319] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1786: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
Test accuracy for step 250: 0.6181315779685974

Test GAP RMS for gender and step 250: 0.12832318246364594

Test GAP RMS for race and step 250: 0.01821744255721569

Test balanced accuracy for step 250: 0.48242419958114624


Test accuracy for step 500: 0.8144831657409668

Test GAP RMS for gender and step 500: 0.2794530987739563

Test GAP RMS for race and step 500: 0.07715929299592972

Test balanced accuracy for step 500: 0.8035174608230591


Test accuracy for step 750: 0.8226644396781921

Test GAP RMS for gender and step 750: 0.19660364091396332

Test GAP RMS for race and step 750: 0.05466194823384285

Test balanced accuracy for step 750: 0.8123176097869873


Test accuracy for step 1000: 0.8297401666641235

Test GAP RMS for gender and step 1000: 0.17473666369915009

Test GAP RMS for race and step 1000: 0.06169179826974869

Test balanced accuracy for step 1000: 0.8089661598205566


Test accuracy for step 1250: 0.8315091133117676

Test GAP RMS for gender and step 1250: 0.1586824506521225

Test GAP RMS for race and step 1250: 0.061782293021678925

Test balanced accuracy for step 1250: 0.8109064102172852


Test accuracy for step 1500: 0.8308457732200623

Test GAP RMS for gender and step 1500: 0.14896473288536072

Test GAP RMS for race and step 1500: 0.05821126326918602

Test balanced accuracy for step 1500: 0.8164874911308289


Test accuracy for step 1750: 0.8309563398361206

Test GAP RMS for gender and step 1750: 0.15491314232349396

Test GAP RMS for race and step 1750: 0.0590844564139843

Test balanced accuracy for step 1750: 0.8176409006118774


Test accuracy for step 2000: 0.8294085264205933

Test GAP RMS for gender and step 2000: 0.15095646679401398

Test GAP RMS for race and step 2000: 0.061815835535526276

Test balanced accuracy for step 2000: 0.8181618452072144


Test accuracy for step 2250: 0.8337202668190002

Test GAP RMS for gender and step 2250: 0.1406228244304657

Test GAP RMS for race and step 2250: 0.05821788311004639

Test balanced accuracy for step 2250: 0.8137561678886414


Test accuracy for step 2500: 0.8340519666671753

Test GAP RMS for gender and step 2500: 0.12939347326755524

Test GAP RMS for race and step 2500: 0.05668805539608002

Test balanced accuracy for step 2500: 0.8167533874511719


Test accuracy for step 2750: 0.8306246399879456

Test GAP RMS for gender and step 2750: 0.13315141201019287

Test GAP RMS for race and step 2750: 0.050395071506500244

Test balanced accuracy for step 2750: 0.8231323957443237


Test accuracy for step 3000: 0.8323935866355896

Test GAP RMS for gender and step 3000: 0.13727419078350067

Test GAP RMS for race and step 3000: 0.054858461022377014

Test balanced accuracy for step 3000: 0.8187447190284729


Test accuracy for step 3250: 0.835157573223114

Test GAP RMS for gender and step 3250: 0.12134087085723877

Test GAP RMS for race and step 3250: 0.05252145230770111

Test balanced accuracy for step 3250: 0.8191815614700317


Test accuracy for step 3500: 0.835710346698761

Test GAP RMS for gender and step 3500: 0.1133110448718071

Test GAP RMS for race and step 3500: 0.05416097119450569

Test balanced accuracy for step 3500: 0.818466305732727


Test accuracy for step 3750: 0.8350470066070557

Test GAP RMS for gender and step 3750: 0.1117074191570282

Test GAP RMS for race and step 3750: 0.05553016811609268

Test balanced accuracy for step 3750: 0.8201888799667358


Test accuracy for step 4000: 0.8382532000541687

Test GAP RMS for gender and step 4000: 0.11140626668930054

Test GAP RMS for race and step 4000: 0.0533229224383831

Test balanced accuracy for step 4000: 0.8145898580551147


Test accuracy for step 4250: 0.836594820022583

Test GAP RMS for gender and step 4250: 0.11263910681009293

Test GAP RMS for race and step 4250: 0.050463441759347916

Test balanced accuracy for step 4250: 0.815809428691864


Test accuracy for step 4500: 0.8401326537132263

Test GAP RMS for gender and step 4500: 0.09649711102247238

Test GAP RMS for race and step 4500: 0.051903869956731796

Test balanced accuracy for step 4500: 0.809194803237915


Test accuracy for step 4750: 0.8359314799308777

Test GAP RMS for gender and step 4750: 0.10151983797550201

Test GAP RMS for race and step 4750: 0.05209793150424957

Test balanced accuracy for step 4750: 0.817995011806488


Test accuracy for step 5000: 0.837700366973877

Test GAP RMS for gender and step 5000: 0.10048895329236984

Test GAP RMS for race and step 5000: 0.053607627749443054

Test balanced accuracy for step 5000: 0.8136073350906372


Test accuracy for step 5250: 0.8369264602661133

Test GAP RMS for gender and step 5250: 0.10107234865427017

Test GAP RMS for race and step 5250: 0.05232814699411392

Test balanced accuracy for step 5250: 0.8132504224777222


Test accuracy for step 5500: 0.838363766670227

Test GAP RMS for gender and step 5500: 0.09524159878492355

Test GAP RMS for race and step 5500: 0.05068708211183548

Test balanced accuracy for step 5500: 0.8126564621925354


Test accuracy for step 5750: 0.8354892134666443

Test GAP RMS for gender and step 5750: 0.0936117172241211

Test GAP RMS for race and step 5750: 0.053394485265016556

Test balanced accuracy for step 5750: 0.8153877258300781


Test accuracy for step 6000: 0.8346047401428223

Test GAP RMS for gender and step 6000: 0.09765981137752533

Test GAP RMS for race and step 6000: 0.05260089784860611

Test balanced accuracy for step 6000: 0.8146491050720215


Test accuracy for step 6250: 0.8352680802345276

Test GAP RMS for gender and step 6250: 0.10055263340473175

Test GAP RMS for race and step 6250: 0.05147569254040718

Test balanced accuracy for step 6250: 0.8147786855697632


Test accuracy for step 6500: 0.8355997800827026

Test GAP RMS for gender and step 6500: 0.09594587981700897

Test GAP RMS for race and step 6500: 0.05042671784758568

Test balanced accuracy for step 6500: 0.815152108669281


Test accuracy for step 6750: 0.8402432203292847

Test GAP RMS for gender and step 6750: 0.08331361413002014

Test GAP RMS for race and step 6750: 0.05476326122879982

Test balanced accuracy for step 6750: 0.8089591264724731


Test accuracy for step 7000: 0.83714759349823

Test GAP RMS for gender and step 7000: 0.08910982310771942

Test GAP RMS for race and step 7000: 0.050781313329935074

Test balanced accuracy for step 7000: 0.8120074272155762


Test accuracy for step 7250: 0.8375898003578186

Test GAP RMS for gender and step 7250: 0.08828806132078171

Test GAP RMS for race and step 7250: 0.04881010577082634

Test balanced accuracy for step 7250: 0.8096757531166077


Test accuracy for step 7500: 0.838916540145874

Test GAP RMS for gender and step 7500: 0.08955515176057816

Test GAP RMS for race and step 7500: 0.047505754977464676

Test balanced accuracy for step 7500: 0.809780478477478


Test accuracy for step 7750: 0.8381426334381104

Test GAP RMS for gender and step 7750: 0.08538277447223663

Test GAP RMS for race and step 7750: 0.051044099032878876

Test balanced accuracy for step 7750: 0.80973219871521


{'epsilon': 0.01, 'lr': 0.0001, 'wlr': 5e-06, 'w_reg': 10.0}
Final test accuracy: 0.835710346698761
Final test GAP RMS for gender: 0.08623489737510681
Final test GAP RMS for race: 0.05204993113875389
Final test balanced accuracy: 0.810286283493042


