2020-05-21 16:32:43.111387: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:43.112082: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:43.112096: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2020-05-21 16:32:52.970602: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:52.970852: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)
2020-05-21 16:32:52.970882: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (gl3108.arc-ts.umich.edu): /proc/driver/nvidia/version does not exist
2020-05-21 16:32:52.971410: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-05-21 16:32:52.978962: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3000000000 Hz
2020-05-21 16:32:52.979070: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55f03dca7be0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-05-21 16:32:52.979080: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
/sw/arcts/centos7/python3.6-anaconda/5.2.0/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/array_grad.py:563: _EagerTensorBase.cpu (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.identity instead.
2020-05-21 16:59:41.491683: W tensorflow/python/util/util.cc:319] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1786: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
Test accuracy for step 250: 0.6181315779685974

Test GAP RMS for gender and step 250: 0.12805414199829102

Test GAP RMS for race and step 250: 0.014724423177540302

Test balanced accuracy for step 250: 0.4730094075202942


Test accuracy for step 500: 0.8313985466957092

Test GAP RMS for gender and step 500: 0.2823759615421295

Test GAP RMS for race and step 500: 0.05409495159983635

Test balanced accuracy for step 500: 0.6989363431930542


Test accuracy for step 750: 0.837479293346405

Test GAP RMS for gender and step 750: 0.18134844303131104

Test GAP RMS for race and step 750: 0.026667941361665726

Test balanced accuracy for step 750: 0.7014098763465881


Test accuracy for step 1000: 0.8234383463859558

Test GAP RMS for gender and step 1000: 0.09016869217157364

Test GAP RMS for race and step 1000: 0.0065263682045042515

Test balanced accuracy for step 1000: 0.6554012894630432


Test accuracy for step 1250: 0.8184632658958435

Test GAP RMS for gender and step 1250: 0.0675429180264473

Test GAP RMS for race and step 1250: 0.005578134208917618

Test balanced accuracy for step 1250: 0.6388413906097412


Test accuracy for step 1500: 0.8113874793052673

Test GAP RMS for gender and step 1500: 0.042321112006902695

Test GAP RMS for race and step 1500: 0.004240136593580246

Test balanced accuracy for step 1500: 0.6196591258049011


Test accuracy for step 1750: 0.8057490587234497

Test GAP RMS for gender and step 1750: 0.034209951758384705

Test GAP RMS for race and step 1750: 0.01624835655093193

Test balanced accuracy for step 1750: 0.6062108278274536


Test accuracy for step 2000: 0.8036484122276306

Test GAP RMS for gender and step 2000: 0.030256524682044983

Test GAP RMS for race and step 2000: 0.028241416439414024

Test balanced accuracy for step 2000: 0.6000386476516724


Test accuracy for step 2250: 0.7981204986572266

Test GAP RMS for gender and step 2250: 0.019582465291023254

Test GAP RMS for race and step 2250: 0.013589748181402683

Test balanced accuracy for step 2250: 0.5866633653640747


Test accuracy for step 2500: 0.7972360253334045

Test GAP RMS for gender and step 2500: 0.014339614659547806

Test GAP RMS for race and step 2500: 0.014966806396842003

Test balanced accuracy for step 2500: 0.5849986672401428


Test accuracy for step 2750: 0.7978993654251099

Test GAP RMS for gender and step 2750: 0.008792552165687084

Test GAP RMS for race and step 2750: 0.017072632908821106

Test balanced accuracy for step 2750: 0.5863629579544067


Test accuracy for step 3000: 0.7952460050582886

Test GAP RMS for gender and step 3000: 0.006080941762775183

Test GAP RMS for race and step 3000: 0.007160203065723181

Test balanced accuracy for step 3000: 0.5802885890007019


Test accuracy for step 3250: 0.7945826649665833

Test GAP RMS for gender and step 3250: 0.0034498097375035286

Test GAP RMS for race and step 3250: 0.004774806555360556

Test balanced accuracy for step 3250: 0.5787699818611145


Test accuracy for step 3500: 0.7953565716743469

Test GAP RMS for gender and step 3500: 0.004208758939057589

Test GAP RMS for race and step 3500: 0.007873950526118279

Test balanced accuracy for step 3500: 0.5806702971458435


Test accuracy for step 3750: 0.7949143052101135

Test GAP RMS for gender and step 3750: 0.0011039150413125753

Test GAP RMS for race and step 3750: 0.007154056336730719

Test balanced accuracy for step 3750: 0.5800694823265076


Test accuracy for step 4000: 0.7904919981956482

Test GAP RMS for gender and step 4000: 0.005295181181281805

Test GAP RMS for race and step 4000: 0.0032301947940140963

Test balanced accuracy for step 4000: 0.570357084274292


Test accuracy for step 4250: 0.7941403985023499

Test GAP RMS for gender and step 4250: 0.004706891719251871

Test GAP RMS for race and step 4250: 0.01345225889235735

Test balanced accuracy for step 4250: 0.5789408683776855


Test accuracy for step 4500: 0.7890547513961792

Test GAP RMS for gender and step 4500: 0.006799892522394657

Test GAP RMS for race and step 4500: 0.0009277758072130382

Test balanced accuracy for step 4500: 0.5677098035812378


Test accuracy for step 4750: 0.8001105785369873

Test GAP RMS for gender and step 4750: 0.004563617054373026

Test GAP RMS for race and step 4750: 0.016194235533475876

Test balanced accuracy for step 4750: 0.5924538969993591


Test accuracy for step 5000: 0.800000011920929

Test GAP RMS for gender and step 5000: 0.00402291864156723

Test GAP RMS for race and step 5000: 0.015837067738175392

Test balanced accuracy for step 5000: 0.592226505279541


Test accuracy for step 5250: 0.807296872138977

Test GAP RMS for gender and step 5250: 0.00575395580381155

Test GAP RMS for race and step 5250: 0.02535119839012623

Test balanced accuracy for step 5250: 0.6095484495162964


Test accuracy for step 5500: 0.8118297457695007

Test GAP RMS for gender and step 5500: 0.007808339316397905

Test GAP RMS for race and step 5500: 0.0145865548402071

Test balanced accuracy for step 5500: 0.6211859583854675


Test accuracy for step 5750: 0.8210060596466064

Test GAP RMS for gender and step 5750: 0.005034803878515959

Test GAP RMS for race and step 5750: 0.011017070151865482

Test balanced accuracy for step 5750: 0.6439167261123657


Test accuracy for step 6000: 0.8269762396812439

Test GAP RMS for gender and step 6000: 0.00967792421579361

Test GAP RMS for race and step 6000: 0.004957705270498991

Test balanced accuracy for step 6000: 0.6594361662864685


Test accuracy for step 6250: 0.8271973729133606

Test GAP RMS for gender and step 6250: 0.009735881350934505

Test GAP RMS for race and step 6250: 0.00573425367474556

Test balanced accuracy for step 6250: 0.6588104963302612


Test accuracy for step 6500: 0.8308457732200623

Test GAP RMS for gender and step 6500: 0.01789839193224907

Test GAP RMS for race and step 6500: 0.011361850425601006

Test balanced accuracy for step 6500: 0.6697094440460205


Test accuracy for step 6750: 0.8301824331283569

Test GAP RMS for gender and step 6750: 0.008891277015209198

Test GAP RMS for race and step 6750: 0.011188902892172337

Test balanced accuracy for step 6750: 0.6675734519958496


Test accuracy for step 7000: 0.8364842534065247

Test GAP RMS for gender and step 7000: 0.013041507452726364

Test GAP RMS for race and step 7000: 0.010996310971677303

Test balanced accuracy for step 7000: 0.6853184700012207


Test accuracy for step 7250: 0.8331674933433533

Test GAP RMS for gender and step 7250: 0.013879796490073204

Test GAP RMS for race and step 7250: 0.02285376563668251

Test balanced accuracy for step 7250: 0.676027774810791


Test accuracy for step 7500: 0.8328357934951782

Test GAP RMS for gender and step 7500: 0.017695702612400055

Test GAP RMS for race and step 7500: 0.01753104478120804

Test balanced accuracy for step 7500: 0.6748825907707214


Test accuracy for step 7750: 0.838032066822052

Test GAP RMS for gender and step 7750: 0.016304437071084976

Test GAP RMS for race and step 7750: 0.01133168488740921

Test balanced accuracy for step 7750: 0.6897364854812622


{'epsilon': 0.1, 'lr': 0.0001, 'wlr': 5e-06, 'w_reg': 30.0}
Final test accuracy: 0.8395798802375793
Final test GAP RMS for gender: 0.024648169055581093
Final test GAP RMS for race: 0.010202990844845772
Final test balanced accuracy: 0.6949261426925659


