2020-05-21 16:32:43.746378: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:43.746485: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:43.746496: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2020-05-21 16:32:50.806722: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:50.806964: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)
2020-05-21 16:32:50.807001: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (gl3264.arc-ts.umich.edu): /proc/driver/nvidia/version does not exist
2020-05-21 16:32:50.807475: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-05-21 16:32:50.814963: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3000000000 Hz
2020-05-21 16:32:50.815074: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x562cbdf0dc10 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-05-21 16:32:50.815085: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
/sw/arcts/centos7/python3.6-anaconda/5.2.0/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/array_grad.py:563: _EagerTensorBase.cpu (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.identity instead.
2020-05-21 16:58:46.398253: W tensorflow/python/util/util.cc:319] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1786: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
Test accuracy for step 250: 0.617136538028717

Test GAP RMS for gender and step 250: 0.12814706563949585

Test GAP RMS for race and step 250: 0.018687112256884575

Test balanced accuracy for step 250: 0.4820755422115326


Test accuracy for step 500: 0.8024322986602783

Test GAP RMS for gender and step 500: 0.05915174260735512

Test GAP RMS for race and step 500: 0.010592264123260975

Test balanced accuracy for step 500: 0.6013959646224976


Test accuracy for step 750: 0.7885019183158875

Test GAP RMS for gender and step 750: 0.014554096385836601

Test GAP RMS for race and step 750: 0.0297811608761549

Test balanced accuracy for step 750: 0.5705858469009399


Test accuracy for step 1000: 0.809286892414093

Test GAP RMS for gender and step 1000: 0.03181355819106102

Test GAP RMS for race and step 1000: 0.009610496461391449

Test balanced accuracy for step 1000: 0.6179627180099487


Test accuracy for step 1250: 0.8174682259559631

Test GAP RMS for gender and step 1250: 0.021988606080412865

Test GAP RMS for race and step 1250: 0.005221964791417122

Test balanced accuracy for step 1250: 0.6395731568336487


Test accuracy for step 1500: 0.8381426334381104

Test GAP RMS for gender and step 1500: 0.025944001972675323

Test GAP RMS for race and step 1500: 0.017032990232110023

Test balanced accuracy for step 1500: 0.6961374878883362


Test accuracy for step 1750: 0.8438916802406311

Test GAP RMS for gender and step 1750: 0.02930135652422905

Test GAP RMS for race and step 1750: 0.014553667046129704

Test balanced accuracy for step 1750: 0.7220060229301453


Test accuracy for step 2000: 0.846434473991394

Test GAP RMS for gender and step 2000: 0.04846414178609848

Test GAP RMS for race and step 2000: 0.03051985241472721

Test balanced accuracy for step 2000: 0.7352614402770996


Test accuracy for step 2250: 0.8496406674385071

Test GAP RMS for gender and step 2250: 0.05996541306376457

Test GAP RMS for race and step 2250: 0.045222971588373184

Test balanced accuracy for step 2250: 0.7523504495620728


Test accuracy for step 2500: 0.8499723672866821

Test GAP RMS for gender and step 2500: 0.05790501832962036

Test GAP RMS for race and step 2500: 0.031273532658815384

Test balanced accuracy for step 2500: 0.7527239322662354


Test accuracy for step 2750: 0.8489773273468018

Test GAP RMS for gender and step 2750: 0.04580369219183922

Test GAP RMS for race and step 2750: 0.023465635254979134

Test balanced accuracy for step 2750: 0.7469733953475952


Test accuracy for step 3000: 0.8515201807022095

Test GAP RMS for gender and step 3000: 0.06548924744129181

Test GAP RMS for race and step 3000: 0.038784295320510864

Test balanced accuracy for step 3000: 0.7552898526191711


Test accuracy for step 3250: 0.8515201807022095

Test GAP RMS for gender and step 3250: 0.059391338378190994

Test GAP RMS for race and step 3250: 0.035441409796476364

Test balanced accuracy for step 3250: 0.7534377574920654


Test accuracy for step 3500: 0.8490878939628601

Test GAP RMS for gender and step 3500: 0.05851517990231514

Test GAP RMS for race and step 3500: 0.04858424887061119

Test balanced accuracy for step 3500: 0.7916508913040161


Test accuracy for step 3750: 0.8499723672866821

Test GAP RMS for gender and step 3750: 0.05054260417819023

Test GAP RMS for race and step 3750: 0.03755057975649834

Test balanced accuracy for step 3750: 0.7754120230674744


Test accuracy for step 4000: 0.8506357073783875

Test GAP RMS for gender and step 4000: 0.05833039805293083

Test GAP RMS for race and step 4000: 0.0473787821829319

Test balanced accuracy for step 4000: 0.7821781635284424


Test accuracy for step 4250: 0.8305140733718872

Test GAP RMS for gender and step 4250: 0.09413877874612808

Test GAP RMS for race and step 4250: 0.053336188197135925

Test balanced accuracy for step 4250: 0.8124098777770996


Test accuracy for step 4500: 0.815367579460144

Test GAP RMS for gender and step 4500: 0.10744351148605347

Test GAP RMS for race and step 4500: 0.051677603274583817

Test balanced accuracy for step 4500: 0.8199988603591919


Test accuracy for step 4750: 0.8057490587234497

Test GAP RMS for gender and step 4750: 0.09731820970773697

Test GAP RMS for race and step 4750: 0.051011718809604645

Test balanced accuracy for step 4750: 0.8192009925842285


Test accuracy for step 5000: 0.8239911794662476

Test GAP RMS for gender and step 5000: 0.09587202966213226

Test GAP RMS for race and step 5000: 0.050250180065631866

Test balanced accuracy for step 5000: 0.8156634569168091


Test accuracy for step 5250: 0.7969043850898743

Test GAP RMS for gender and step 5250: 0.12159421294927597

Test GAP RMS for race and step 5250: 0.05236513540148735

Test balanced accuracy for step 5250: 0.8223099708557129


Test accuracy for step 5500: 0.7652847170829773

Test GAP RMS for gender and step 5500: 0.13188332319259644

Test GAP RMS for race and step 5500: 0.06524658203125

Test balanced accuracy for step 5500: 0.8134604692459106


Test accuracy for step 5750: 0.6621337532997131

Test GAP RMS for gender and step 5750: 0.17104996740818024

Test GAP RMS for race and step 5750: 0.07203315198421478

Test balanced accuracy for step 5750: 0.7656914591789246


Test accuracy for step 6000: 0.680707573890686

Test GAP RMS for gender and step 6000: 0.1703108698129654

Test GAP RMS for race and step 6000: 0.06967347115278244

Test balanced accuracy for step 6000: 0.7761092782020569


Test accuracy for step 6250: 0.6095080375671387

Test GAP RMS for gender and step 6250: 0.22202903032302856

Test GAP RMS for race and step 6250: 0.07002445310354233

Test balanced accuracy for step 6250: 0.7340134382247925


Test accuracy for step 6500: 0.4411276876926422

Test GAP RMS for gender and step 6500: 0.1975247859954834

Test GAP RMS for race and step 6500: 0.0578615702688694

Test balanced accuracy for step 6500: 0.6274108290672302


Test accuracy for step 6750: 0.5859590768814087

Test GAP RMS for gender and step 6750: 0.2026078850030899

Test GAP RMS for race and step 6750: 0.07719095796346664

Test balanced accuracy for step 6750: 0.7187656164169312


Test accuracy for step 7000: 0.6448866724967957

Test GAP RMS for gender and step 7000: 0.18110117316246033

Test GAP RMS for race and step 7000: 0.07146935164928436

Test balanced accuracy for step 7000: 0.7547609210014343


Test accuracy for step 7250: 0.7280265092849731

Test GAP RMS for gender and step 7250: 0.17339050769805908

Test GAP RMS for race and step 7250: 0.06559715420007706

Test balanced accuracy for step 7250: 0.8005774021148682


Test accuracy for step 7500: 0.6961857676506042

Test GAP RMS for gender and step 7500: 0.19250856339931488

Test GAP RMS for race and step 7500: 0.0762409046292305

Test balanced accuracy for step 7500: 0.7826300859451294


Test accuracy for step 7750: 0.7993366718292236

Test GAP RMS for gender and step 7750: 0.1343216747045517

Test GAP RMS for race and step 7750: 0.05746213719248772

Test balanced accuracy for step 7750: 0.8214472532272339


{'epsilon': 0.01, 'lr': 0.0001, 'wlr': 0.001, 'w_reg': 50.0}
Final test accuracy: 0.836263120174408
Final test GAP RMS for gender: 0.10143689811229706
Final test GAP RMS for race: 0.049022313207387924
Final test balanced accuracy: 0.7992302179336548


