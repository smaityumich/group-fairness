2020-05-21 16:32:38.286074: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:38.288964: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:38.288976: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2020-05-21 16:32:45.983643: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:45.983901: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)
2020-05-21 16:32:45.983921: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (gl3150.arc-ts.umich.edu): /proc/driver/nvidia/version does not exist
2020-05-21 16:32:45.984238: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-05-21 16:32:45.991016: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3000000000 Hz
2020-05-21 16:32:45.991109: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55624b9c6df0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-05-21 16:32:45.991120: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
/sw/arcts/centos7/python3.6-anaconda/5.2.0/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/array_grad.py:563: _EagerTensorBase.cpu (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.identity instead.
2020-05-21 16:58:10.722095: W tensorflow/python/util/util.cc:319] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1786: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
Test accuracy for step 250: 0.6149253845214844

Test GAP RMS for gender and step 250: 0.12872745096683502

Test GAP RMS for race and step 250: 0.018310969695448875

Test balanced accuracy for step 250: 0.4850907325744629


Test accuracy for step 500: 0.8190160393714905

Test GAP RMS for gender and step 500: 0.16803233325481415

Test GAP RMS for race and step 500: 0.057700954377651215

Test balanced accuracy for step 500: 0.8074379563331604


Test accuracy for step 750: 0.8306246399879456

Test GAP RMS for gender and step 750: 0.08946460485458374

Test GAP RMS for race and step 750: 0.044405337423086166

Test balanced accuracy for step 750: 0.8109394311904907


Test accuracy for step 1000: 0.8379215002059937

Test GAP RMS for gender and step 1000: 0.07763401418924332

Test GAP RMS for race and step 1000: 0.04844764620065689

Test balanced accuracy for step 1000: 0.8041842579841614


Test accuracy for step 1250: 0.8396904468536377

Test GAP RMS for gender and step 1250: 0.07329246401786804

Test GAP RMS for race and step 1250: 0.0488460399210453

Test balanced accuracy for step 1250: 0.8055071830749512


Test accuracy for step 1500: 0.838916540145874

Test GAP RMS for gender and step 1500: 0.07195243239402771

Test GAP RMS for race and step 1500: 0.050480909645557404

Test balanced accuracy for step 1500: 0.8087000846862793


Test accuracy for step 1750: 0.8391376733779907

Test GAP RMS for gender and step 1750: 0.07539543509483337

Test GAP RMS for race and step 1750: 0.04602467641234398

Test balanced accuracy for step 1750: 0.8060680627822876


Test accuracy for step 2000: 0.838584840297699

Test GAP RMS for gender and step 2000: 0.07845257222652435

Test GAP RMS for race and step 2000: 0.04799773916602135

Test balanced accuracy for step 2000: 0.8075549602508545


Test accuracy for step 2250: 0.84090656042099

Test GAP RMS for gender and step 2250: 0.07704688608646393

Test GAP RMS for race and step 2250: 0.05081448331475258

Test balanced accuracy for step 2250: 0.8035324215888977


Test accuracy for step 2500: 0.84090656042099

Test GAP RMS for gender and step 2500: 0.07783465832471848

Test GAP RMS for race and step 2500: 0.04660150408744812

Test balanced accuracy for step 2500: 0.8052301406860352


Test accuracy for step 2750: 0.8395798802375793

Test GAP RMS for gender and step 2750: 0.07826270908117294

Test GAP RMS for race and step 2750: 0.04530917853116989

Test balanced accuracy for step 2750: 0.8071318864822388


Test accuracy for step 3000: 0.8399115800857544

Test GAP RMS for gender and step 3000: 0.08152420073747635

Test GAP RMS for race and step 3000: 0.04444720596075058

Test balanced accuracy for step 3000: 0.8056532144546509


Test accuracy for step 3250: 0.8416804671287537

Test GAP RMS for gender and step 3250: 0.0766107439994812

Test GAP RMS for race and step 3250: 0.04363203048706055

Test balanced accuracy for step 3250: 0.8031176328659058


Test accuracy for step 3500: 0.8404643535614014

Test GAP RMS for gender and step 3500: 0.07635869085788727

Test GAP RMS for race and step 3500: 0.05181897431612015

Test balanced accuracy for step 3500: 0.805709719657898


Test accuracy for step 3750: 0.8393587470054626

Test GAP RMS for gender and step 3750: 0.07577689737081528

Test GAP RMS for race and step 3750: 0.04663785919547081

Test balanced accuracy for step 3750: 0.8045163750648499


Test accuracy for step 4000: 0.8415699005126953

Test GAP RMS for gender and step 4000: 0.07586204260587692

Test GAP RMS for race and step 4000: 0.043619100004434586

Test balanced accuracy for step 4000: 0.8011925220489502


Test accuracy for step 4250: 0.8424543738365173

Test GAP RMS for gender and step 4250: 0.07574065774679184

Test GAP RMS for race and step 4250: 0.046258144080638885

Test balanced accuracy for step 4250: 0.8003877401351929


Test accuracy for step 4500: 0.8451077938079834

Test GAP RMS for gender and step 4500: 0.07196326553821564

Test GAP RMS for race and step 4500: 0.04385682940483093

Test balanced accuracy for step 4500: 0.8004428148269653


Test accuracy for step 4750: 0.8402432203292847

Test GAP RMS for gender and step 4750: 0.07740182429552078

Test GAP RMS for race and step 4750: 0.044609732925891876

Test balanced accuracy for step 4750: 0.802322506904602


Test accuracy for step 5000: 0.8402432203292847

Test GAP RMS for gender and step 5000: 0.07574217766523361

Test GAP RMS for race and step 5000: 0.047107432037591934

Test balanced accuracy for step 5000: 0.8007791042327881


Test accuracy for step 5250: 0.8391376733779907

Test GAP RMS for gender and step 5250: 0.07735079526901245

Test GAP RMS for race and step 5250: 0.04975385218858719

Test balanced accuracy for step 5250: 0.8012834787368774


Test accuracy for step 5500: 0.8420121669769287

Test GAP RMS for gender and step 5500: 0.07745975255966187

Test GAP RMS for race and step 5500: 0.04236571863293648

Test balanced accuracy for step 5500: 0.8002499341964722


Test accuracy for step 5750: 0.840022087097168

Test GAP RMS for gender and step 5750: 0.07782933861017227

Test GAP RMS for race and step 5750: 0.04399089142680168

Test balanced accuracy for step 5750: 0.8009417057037354


Test accuracy for step 6000: 0.8368158936500549

Test GAP RMS for gender and step 6000: 0.0844581201672554

Test GAP RMS for race and step 6000: 0.045547276735305786

Test balanced accuracy for step 6000: 0.8045343160629272


Test accuracy for step 6250: 0.8391376733779907

Test GAP RMS for gender and step 6250: 0.07933413982391357

Test GAP RMS for race and step 6250: 0.04558217525482178

Test balanced accuracy for step 6250: 0.8017464876174927


Test accuracy for step 6500: 0.839469313621521

Test GAP RMS for gender and step 6500: 0.08332326263189316

Test GAP RMS for race and step 6500: 0.04624006152153015

Test balanced accuracy for step 6500: 0.803508996963501


Test accuracy for step 6750: 0.8420121669769287

Test GAP RMS for gender and step 6750: 0.07845977693796158

Test GAP RMS for race and step 6750: 0.046126868575811386

Test balanced accuracy for step 6750: 0.7994781732559204


Test accuracy for step 7000: 0.8354892134666443

Test GAP RMS for gender and step 7000: 0.08453872054815292

Test GAP RMS for race and step 7000: 0.04700244218111038

Test balanced accuracy for step 7000: 0.8028861284255981


Test accuracy for step 7250: 0.8399115800857544

Test GAP RMS for gender and step 7250: 0.07459468394517899

Test GAP RMS for race and step 7250: 0.046600911766290665

Test balanced accuracy for step 7250: 0.799788236618042


Test accuracy for step 7500: 0.8390271067619324

Test GAP RMS for gender and step 7500: 0.07950367033481598

Test GAP RMS for race and step 7500: 0.04416048154234886

Test balanced accuracy for step 7500: 0.8002843856811523


Test accuracy for step 7750: 0.8405749201774597

Test GAP RMS for gender and step 7750: 0.08034689724445343

Test GAP RMS for race and step 7750: 0.04730430617928505

Test balanced accuracy for step 7750: 0.8026959896087646


{'epsilon': 0.01, 'lr': 0.0001, 'wlr': 0.001, 'w_reg': 10.0}
Final test accuracy: 0.8395798802375793
Final test GAP RMS for gender: 0.07926563918590546
Final test GAP RMS for race: 0.04588702693581581
Final test balanced accuracy: 0.8032733798027039


