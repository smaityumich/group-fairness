2020-05-21 16:32:38.286074: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:38.288537: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:38.288549: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2020-05-21 16:32:45.983643: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:45.983868: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)
2020-05-21 16:32:45.983887: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (gl3150.arc-ts.umich.edu): /proc/driver/nvidia/version does not exist
2020-05-21 16:32:45.984221: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-05-21 16:32:45.991017: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3000000000 Hz
2020-05-21 16:32:45.991108: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5607e9e7e450 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-05-21 16:32:45.991119: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
/sw/arcts/centos7/python3.6-anaconda/5.2.0/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/array_grad.py:563: _EagerTensorBase.cpu (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.identity instead.
2020-05-21 16:58:20.179395: W tensorflow/python/util/util.cc:319] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1786: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
Test accuracy for step 250: 0.6181315779685974

Test GAP RMS for gender and step 250: 0.1274147480726242

Test GAP RMS for race and step 250: 0.015412700362503529

Test balanced accuracy for step 250: 0.47964608669281006


Test accuracy for step 500: 0.8410171270370483

Test GAP RMS for gender and step 500: 0.15020158886909485

Test GAP RMS for race and step 500: 0.056515295058488846

Test balanced accuracy for step 500: 0.7904864549636841


Test accuracy for step 750: 0.8438916802406311

Test GAP RMS for gender and step 750: 0.08893947303295135

Test GAP RMS for race and step 750: 0.054581500589847565

Test balanced accuracy for step 750: 0.7899159789085388


Test accuracy for step 1000: 0.844112753868103

Test GAP RMS for gender and step 1000: 0.098719522356987

Test GAP RMS for race and step 1000: 0.05673912167549133

Test balanced accuracy for step 1000: 0.7971616983413696


Test accuracy for step 1250: 0.8413488268852234

Test GAP RMS for gender and step 1250: 0.09898895025253296

Test GAP RMS for race and step 1250: 0.05756717547774315

Test balanced accuracy for step 1250: 0.8030528426170349


Test accuracy for step 1500: 0.8415699005126953

Test GAP RMS for gender and step 1500: 0.09129655361175537

Test GAP RMS for race and step 1500: 0.06170479208230972

Test balanced accuracy for step 1500: 0.8053597211837769


Test accuracy for step 1750: 0.8391376733779907

Test GAP RMS for gender and step 1750: 0.09415332227945328

Test GAP RMS for race and step 1750: 0.058246538043022156

Test balanced accuracy for step 1750: 0.8063766956329346


Test accuracy for step 2000: 0.8384742736816406

Test GAP RMS for gender and step 2000: 0.10058725625276566

Test GAP RMS for race and step 2000: 0.05308600887656212

Test balanced accuracy for step 2000: 0.8079448938369751


Test accuracy for step 2250: 0.8390271067619324

Test GAP RMS for gender and step 2250: 0.09845626354217529

Test GAP RMS for race and step 2250: 0.05318344011902809

Test balanced accuracy for step 2250: 0.8089274764060974


Test accuracy for step 2500: 0.8378109335899353

Test GAP RMS for gender and step 2500: 0.09104296565055847

Test GAP RMS for race and step 2500: 0.05642738938331604

Test balanced accuracy for step 2500: 0.8088957667350769


Test accuracy for step 2750: 0.8392481803894043

Test GAP RMS for gender and step 2750: 0.08920211344957352

Test GAP RMS for race and step 2750: 0.04592135176062584

Test balanced accuracy for step 2750: 0.8072214126586914


Test accuracy for step 3000: 0.838032066822052

Test GAP RMS for gender and step 3000: 0.10519564151763916

Test GAP RMS for race and step 3000: 0.048670828342437744

Test balanced accuracy for step 3000: 0.8101222515106201


Test accuracy for step 3250: 0.8386954069137573

Test GAP RMS for gender and step 3250: 0.09716884791851044

Test GAP RMS for race and step 3250: 0.051351647824048996

Test balanced accuracy for step 3250: 0.8083996772766113


Test accuracy for step 3500: 0.8407959938049316

Test GAP RMS for gender and step 3500: 0.08645754307508469

Test GAP RMS for race and step 3500: 0.05507181957364082

Test balanced accuracy for step 3500: 0.8073179125785828


Test accuracy for step 3750: 0.8407959938049316

Test GAP RMS for gender and step 3750: 0.08543287962675095

Test GAP RMS for race and step 3750: 0.060759712010622025

Test balanced accuracy for step 3750: 0.806700587272644


Test accuracy for step 4000: 0.8384742736816406

Test GAP RMS for gender and step 4000: 0.09420962631702423

Test GAP RMS for race and step 4000: 0.04943948611617088

Test balanced accuracy for step 4000: 0.8074818849563599


Test accuracy for step 4250: 0.8386954069137573

Test GAP RMS for gender and step 4250: 0.09546317160129547

Test GAP RMS for race and step 4250: 0.04614778980612755

Test balanced accuracy for step 4250: 0.8060845732688904


Test accuracy for step 4500: 0.842675507068634

Test GAP RMS for gender and step 4500: 0.0881580337882042

Test GAP RMS for race and step 4500: 0.05009523779153824

Test balanced accuracy for step 4500: 0.8028489351272583


Test accuracy for step 4750: 0.8355997800827026

Test GAP RMS for gender and step 4750: 0.0902271568775177

Test GAP RMS for race and step 4750: 0.04930815473198891

Test balanced accuracy for step 4750: 0.806200385093689


Test accuracy for step 5000: 0.836263120174408

Test GAP RMS for gender and step 5000: 0.09466324746608734

Test GAP RMS for race and step 5000: 0.05022231116890907

Test balanced accuracy for step 5000: 0.8081819415092468


Test accuracy for step 5250: 0.8382532000541687

Test GAP RMS for gender and step 5250: 0.09226635098457336

Test GAP RMS for race and step 5250: 0.04859992116689682

Test balanced accuracy for step 5250: 0.8077988624572754


Test accuracy for step 5500: 0.8386954069137573

Test GAP RMS for gender and step 5500: 0.0931347906589508

Test GAP RMS for race and step 5500: 0.049144353717565536

Test balanced accuracy for step 5500: 0.8079366683959961


Test accuracy for step 5750: 0.8358209133148193

Test GAP RMS for gender and step 5750: 0.08691968768835068

Test GAP RMS for race and step 5750: 0.04882420599460602

Test balanced accuracy for step 5750: 0.8097419142723083


Test accuracy for step 6000: 0.8355997800827026

Test GAP RMS for gender and step 6000: 0.0949024185538292

Test GAP RMS for race and step 6000: 0.05524851009249687

Test balanced accuracy for step 6000: 0.8111392259597778


Test accuracy for step 6250: 0.8395798802375793

Test GAP RMS for gender and step 6250: 0.08935452252626419

Test GAP RMS for race and step 6250: 0.05105799436569214

Test balanced accuracy for step 6250: 0.8071318864822388


Test accuracy for step 6500: 0.8334991931915283

Test GAP RMS for gender and step 6500: 0.09727146476507187

Test GAP RMS for race and step 6500: 0.056968774646520615

Test balanced accuracy for step 6500: 0.8117580413818359


Test accuracy for step 6750: 0.8384742736816406

Test GAP RMS for gender and step 6750: 0.0853535532951355

Test GAP RMS for race and step 6750: 0.04927876591682434

Test balanced accuracy for step 6750: 0.8080992698669434


Test accuracy for step 7000: 0.8344941735267639

Test GAP RMS for gender and step 7000: 0.08910824358463287

Test GAP RMS for race and step 7000: 0.05642224848270416

Test balanced accuracy for step 7000: 0.8117979764938354


Test accuracy for step 7250: 0.8370370268821716

Test GAP RMS for gender and step 7250: 0.08522417396306992

Test GAP RMS for race and step 7250: 0.04848231375217438

Test balanced accuracy for step 7250: 0.8088475465774536


Test accuracy for step 7500: 0.8396904468536377

Test GAP RMS for gender and step 7500: 0.08648437261581421

Test GAP RMS for race and step 7500: 0.05031851679086685

Test balanced accuracy for step 7500: 0.8036550879478455


Test accuracy for step 7750: 0.837479293346405

Test GAP RMS for gender and step 7750: 0.08520839363336563

Test GAP RMS for race and step 7750: 0.050700776278972626

Test balanced accuracy for step 7750: 0.8094483613967896


{'epsilon': 0.1, 'lr': 0.0001, 'wlr': 0.001, 'w_reg': 10.0}
Final test accuracy: 0.8373687267303467
Final test GAP RMS for gender: 0.08174319565296173
Final test GAP RMS for race: 0.04936249926686287
Final test balanced accuracy: 0.8082950115203857


