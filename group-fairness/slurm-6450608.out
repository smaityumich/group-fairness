2020-05-21 16:32:43.966029: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:43.966135: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:43.966145: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2020-05-21 16:32:53.774945: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:53.775221: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)
2020-05-21 16:32:53.775257: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (gl3099.arc-ts.umich.edu): /proc/driver/nvidia/version does not exist
2020-05-21 16:32:53.775684: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-05-21 16:32:53.782425: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3000000000 Hz
2020-05-21 16:32:53.782571: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x558282cd7970 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-05-21 16:32:53.782588: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
/sw/arcts/centos7/python3.6-anaconda/5.2.0/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/array_grad.py:563: _EagerTensorBase.cpu (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.identity instead.
2020-05-21 17:00:35.099189: W tensorflow/python/util/util.cc:319] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1786: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
Test accuracy for step 250: 0.6183526515960693

Test GAP RMS for gender and step 250: 0.12737789750099182

Test GAP RMS for race and step 250: 0.01669970527291298

Test balanced accuracy for step 250: 0.48071813583374023


Test accuracy for step 500: 0.807296872138977

Test GAP RMS for gender and step 500: 0.3346130847930908

Test GAP RMS for race and step 500: 0.08625980466604233

Test balanced accuracy for step 500: 0.8020113110542297


Test accuracy for step 750: 0.8186843395233154

Test GAP RMS for gender and step 750: 0.24603842198848724

Test GAP RMS for race and step 750: 0.0695321187376976

Test balanced accuracy for step 750: 0.8153989315032959


Test accuracy for step 1000: 0.8247650861740112

Test GAP RMS for gender and step 1000: 0.22672033309936523

Test GAP RMS for race and step 1000: 0.06682642549276352

Test balanced accuracy for step 1000: 0.8129335641860962


Test accuracy for step 1250: 0.8254284262657166

Test GAP RMS for gender and step 1250: 0.2162705510854721

Test GAP RMS for race and step 1250: 0.06346461921930313

Test balanced accuracy for step 1250: 0.8158411979675293


Test accuracy for step 1500: 0.8226644396781921

Test GAP RMS for gender and step 1500: 0.20047278702259064

Test GAP RMS for race and step 1500: 0.057824503630399704

Test balanced accuracy for step 1500: 0.8192629218101501


Test accuracy for step 1750: 0.8202321529388428

Test GAP RMS for gender and step 1750: 0.20769666135311127

Test GAP RMS for race and step 1750: 0.05877671018242836

Test balanced accuracy for step 1750: 0.8191995620727539


Test accuracy for step 2000: 0.8189054727554321

Test GAP RMS for gender and step 2000: 0.20698235929012299

Test GAP RMS for race and step 2000: 0.06298598647117615

Test balanced accuracy for step 2000: 0.822335958480835


Test accuracy for step 2250: 0.8196793794631958

Test GAP RMS for gender and step 2250: 0.20775139331817627

Test GAP RMS for race and step 2250: 0.060768719762563705

Test balanced accuracy for step 2250: 0.8205320835113525


Test accuracy for step 2500: 0.8204532861709595

Test GAP RMS for gender and step 2500: 0.1881285011768341

Test GAP RMS for race and step 2500: 0.06217266246676445

Test balanced accuracy for step 2500: 0.8241301774978638


Test accuracy for step 2750: 0.8155887126922607

Test GAP RMS for gender and step 2750: 0.1958857923746109

Test GAP RMS for race and step 2750: 0.07094963639974594

Test balanced accuracy for step 2750: 0.8264728784561157


Test accuracy for step 3000: 0.8161414861679077

Test GAP RMS for gender and step 3000: 0.20204325020313263

Test GAP RMS for race and step 3000: 0.07080749422311783

Test balanced accuracy for step 3000: 0.8243685960769653


Test accuracy for step 3250: 0.8187949061393738

Test GAP RMS for gender and step 3250: 0.18981118500232697

Test GAP RMS for race and step 3250: 0.0641523003578186

Test balanced accuracy for step 3250: 0.8250410556793213


Test accuracy for step 3500: 0.8195688128471375

Test GAP RMS for gender and step 3500: 0.17866641283035278

Test GAP RMS for race and step 3500: 0.06468124687671661

Test balanced accuracy for step 3500: 0.8267870545387268


Test accuracy for step 3750: 0.8182421326637268

Test GAP RMS for gender and step 3750: 0.17765705287456512

Test GAP RMS for race and step 3750: 0.0706670880317688

Test balanced accuracy for step 3750: 0.8283801078796387


Test accuracy for step 4000: 0.8206744194030762

Test GAP RMS for gender and step 4000: 0.18088063597679138

Test GAP RMS for race and step 4000: 0.06196434050798416

Test balanced accuracy for step 4000: 0.8241219520568848


Test accuracy for step 4250: 0.8166943192481995

Test GAP RMS for gender and step 4250: 0.1818116158246994

Test GAP RMS for race and step 4250: 0.06643794476985931

Test balanced accuracy for step 4250: 0.8253511190414429


Test accuracy for step 4500: 0.8238806128501892

Test GAP RMS for gender and step 4500: 0.17600233852863312

Test GAP RMS for race and step 4500: 0.06346211582422256

Test balanced accuracy for step 4500: 0.8253138661384583


Test accuracy for step 4750: 0.8183526992797852

Test GAP RMS for gender and step 4750: 0.16957774758338928

Test GAP RMS for race and step 4750: 0.06696359068155289

Test balanced accuracy for step 4750: 0.8279900550842285


Test accuracy for step 5000: 0.8197899460792542

Test GAP RMS for gender and step 5000: 0.1732318103313446

Test GAP RMS for race and step 5000: 0.0653095543384552

Test balanced accuracy for step 5000: 0.8260071277618408


Test accuracy for step 5250: 0.8190160393714905

Test GAP RMS for gender and step 5250: 0.1722678691148758

Test GAP RMS for race and step 5250: 0.06667789816856384

Test balanced accuracy for step 5250: 0.8271936178207397


Test accuracy for step 5500: 0.8214483261108398

Test GAP RMS for gender and step 5500: 0.16391758620738983

Test GAP RMS for race and step 5500: 0.06456687301397324

Test balanced accuracy for step 5500: 0.8291090726852417


Test accuracy for step 5750: 0.8197899460792542

Test GAP RMS for gender and step 5750: 0.15160855650901794

Test GAP RMS for race and step 5750: 0.06628543138504028

Test balanced accuracy for step 5750: 0.8303285837173462


Test accuracy for step 6000: 0.8163626194000244

Test GAP RMS for gender and step 6000: 0.1638224869966507

Test GAP RMS for race and step 6000: 0.07022406160831451

Test balanced accuracy for step 6000: 0.8288362622261047


Test accuracy for step 6250: 0.8154781460762024

Test GAP RMS for gender and step 6250: 0.16603468358516693

Test GAP RMS for race and step 6250: 0.06970444321632385

Test balanced accuracy for step 6250: 0.8287149667739868


Test accuracy for step 6500: 0.8155887126922607

Test GAP RMS for gender and step 6500: 0.15838289260864258

Test GAP RMS for race and step 6500: 0.07049056142568588

Test balanced accuracy for step 6500: 0.8292510509490967


Test accuracy for step 6750: 0.8206744194030762

Test GAP RMS for gender and step 6750: 0.1452079862356186

Test GAP RMS for race and step 6750: 0.06942113488912582

Test balanced accuracy for step 6750: 0.8287521600723267


Test accuracy for step 7000: 0.8172470927238464

Test GAP RMS for gender and step 7000: 0.14732205867767334

Test GAP RMS for race and step 7000: 0.06850782781839371

Test balanced accuracy for step 7000: 0.8298835754394531


Test accuracy for step 7250: 0.8189054727554321

Test GAP RMS for gender and step 7250: 0.15152570605278015

Test GAP RMS for race and step 7250: 0.0696718618273735

Test balanced accuracy for step 7250: 0.8298987150192261


Test accuracy for step 7500: 0.8190160393714905

Test GAP RMS for gender and step 7500: 0.15651102364063263

Test GAP RMS for race and step 7500: 0.06858181208372116

Test balanced accuracy for step 7500: 0.8298173546791077


Test accuracy for step 7750: 0.8158098459243774

Test GAP RMS for gender and step 7750: 0.14122949540615082

Test GAP RMS for race and step 7750: 0.06806940585374832

Test balanced accuracy for step 7750: 0.8273906707763672


{'epsilon': 1e-05, 'lr': 0.0001, 'wlr': 5e-06, 'w_reg': 20.0}
Final test accuracy: 0.8159204125404358
Final test GAP RMS for gender: 0.13769106566905975
Final test GAP RMS for race: 0.06496255099773407
Final test balanced accuracy: 0.827926754951477


