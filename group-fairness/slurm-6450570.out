2020-05-21 16:32:38.287084: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:38.288514: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:38.288524: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2020-05-21 16:32:46.023941: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:46.024132: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)
2020-05-21 16:32:46.024154: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (gl3149.arc-ts.umich.edu): /proc/driver/nvidia/version does not exist
2020-05-21 16:32:46.024451: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-05-21 16:32:46.030712: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3000000000 Hz
2020-05-21 16:32:46.030803: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5579ca3eca70 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-05-21 16:32:46.030814: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
/sw/arcts/centos7/python3.6-anaconda/5.2.0/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/array_grad.py:563: _EagerTensorBase.cpu (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.identity instead.
2020-05-21 16:59:08.561422: W tensorflow/python/util/util.cc:319] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1786: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
Test accuracy for step 250: 0.6173576712608337

Test GAP RMS for gender and step 250: 0.12751619517803192

Test GAP RMS for race and step 250: 0.01698422245681286

Test balanced accuracy for step 250: 0.4833019971847534


Test accuracy for step 500: 0.8148148059844971

Test GAP RMS for gender and step 500: 0.21497191488742828

Test GAP RMS for race and step 500: 0.07190751284360886

Test balanced accuracy for step 500: 0.8072863817214966


Test accuracy for step 750: 0.8196793794631958

Test GAP RMS for gender and step 750: 0.1185615286231041

Test GAP RMS for race and step 750: 0.051289767026901245

Test balanced accuracy for step 750: 0.8126607537269592


Test accuracy for step 1000: 0.8354892134666443

Test GAP RMS for gender and step 1000: 0.08676953613758087

Test GAP RMS for race and step 1000: 0.048990458250045776

Test balanced accuracy for step 1000: 0.8104488849639893


Test accuracy for step 1250: 0.8352680802345276

Test GAP RMS for gender and step 1250: 0.08151738345623016

Test GAP RMS for race and step 1250: 0.044141001999378204

Test balanced accuracy for step 1250: 0.8098397850990295


Test accuracy for step 1500: 0.8340519666671753

Test GAP RMS for gender and step 1500: 0.07919060438871384

Test GAP RMS for race and step 1500: 0.05582073703408241

Test balanced accuracy for step 1500: 0.81212317943573


Test accuracy for step 1750: 0.8361525535583496

Test GAP RMS for gender and step 1750: 0.08263325691223145

Test GAP RMS for race and step 1750: 0.05028926208615303

Test balanced accuracy for step 1750: 0.8118131160736084


Test accuracy for step 2000: 0.8368158936500549

Test GAP RMS for gender and step 2000: 0.0814453735947609

Test GAP RMS for race and step 2000: 0.04990208148956299

Test balanced accuracy for step 2000: 0.8125600218772888


Test accuracy for step 2250: 0.8381426334381104

Test GAP RMS for gender and step 2250: 0.07751432061195374

Test GAP RMS for race and step 2250: 0.047421909868717194

Test balanced accuracy for step 2250: 0.8049477338790894


Test accuracy for step 2500: 0.8404643535614014

Test GAP RMS for gender and step 2500: 0.07442819327116013

Test GAP RMS for race and step 2500: 0.04942341148853302

Test balanced accuracy for step 2500: 0.8092595338821411


Test accuracy for step 2750: 0.8368158936500549

Test GAP RMS for gender and step 2750: 0.07838799804449081

Test GAP RMS for race and step 2750: 0.05059134215116501

Test balanced accuracy for step 2750: 0.8090101480484009


Test accuracy for step 3000: 0.8407959938049316

Test GAP RMS for gender and step 3000: 0.07867317646741867

Test GAP RMS for race and step 3000: 0.04506753757596016

Test balanced accuracy for step 3000: 0.8080896139144897


Test accuracy for step 3250: 0.842343807220459

Test GAP RMS for gender and step 3250: 0.07735131680965424

Test GAP RMS for race and step 3250: 0.04512174800038338

Test balanced accuracy for step 3250: 0.8043274879455566


Test accuracy for step 3500: 0.8399115800857544

Test GAP RMS for gender and step 3500: 0.0745341032743454

Test GAP RMS for race and step 3500: 0.0552792064845562

Test balanced accuracy for step 3500: 0.8047271966934204


Test accuracy for step 3750: 0.838916540145874

Test GAP RMS for gender and step 3750: 0.07685304433107376

Test GAP RMS for race and step 3750: 0.05067833140492439

Test balanced accuracy for step 3750: 0.8057676553726196


Test accuracy for step 4000: 0.8427860736846924

Test GAP RMS for gender and step 4000: 0.07383067160844803

Test GAP RMS for race and step 4000: 0.043199021369218826

Test balanced accuracy for step 4000: 0.8006068468093872


Test accuracy for step 4250: 0.8425649404525757

Test GAP RMS for gender and step 4250: 0.0745779499411583

Test GAP RMS for race and step 4250: 0.0440826453268528

Test balanced accuracy for step 4250: 0.8004607558250427


Test accuracy for step 4500: 0.8463239073753357

Test GAP RMS for gender and step 4500: 0.07004451006650925

Test GAP RMS for race and step 4500: 0.04011695832014084

Test balanced accuracy for step 4500: 0.7969246506690979


Test accuracy for step 4750: 0.8413488268852234

Test GAP RMS for gender and step 4750: 0.07390648871660233

Test GAP RMS for race and step 4750: 0.04722343385219574

Test balanced accuracy for step 4750: 0.8042875528335571


Test accuracy for step 5000: 0.842675507068634

Test GAP RMS for gender and step 5000: 0.07211180776357651

Test GAP RMS for race and step 5000: 0.044806286692619324

Test balanced accuracy for step 5000: 0.8002251386642456


Test accuracy for step 5250: 0.8431177735328674

Test GAP RMS for gender and step 5250: 0.07156672328710556

Test GAP RMS for race and step 5250: 0.04547703266143799

Test balanced accuracy for step 5250: 0.800208568572998


Test accuracy for step 5500: 0.8438916802406311

Test GAP RMS for gender and step 5500: 0.07410510629415512

Test GAP RMS for race and step 5500: 0.04111839085817337

Test balanced accuracy for step 5500: 0.7996394634246826


Test accuracy for step 5750: 0.842343807220459

Test GAP RMS for gender and step 5750: 0.07380134612321854

Test GAP RMS for race and step 5750: 0.047409363090991974

Test balanced accuracy for step 5750: 0.8029384613037109


Test accuracy for step 6000: 0.8414593935012817

Test GAP RMS for gender and step 6000: 0.0756082832813263

Test GAP RMS for race and step 6000: 0.04962606728076935

Test balanced accuracy for step 6000: 0.8042062520980835


Test accuracy for step 6250: 0.8406854867935181

Test GAP RMS for gender and step 6250: 0.07411380112171173

Test GAP RMS for race and step 6250: 0.05246707424521446

Test balanced accuracy for step 6250: 0.802151620388031


Test accuracy for step 6500: 0.840022087097168

Test GAP RMS for gender and step 6500: 0.07959306985139847

Test GAP RMS for race and step 6500: 0.046982452273368835

Test balanced accuracy for step 6500: 0.8040285110473633


Test accuracy for step 6750: 0.8445550203323364

Test GAP RMS for gender and step 6750: 0.07347003370523453

Test GAP RMS for race and step 6750: 0.044216837733983994

Test balanced accuracy for step 6750: 0.8008493185043335


Test accuracy for step 7000: 0.8416804671287537

Test GAP RMS for gender and step 7000: 0.07457347214221954

Test GAP RMS for race and step 7000: 0.0486181415617466

Test balanced accuracy for step 7000: 0.8031176328659058


Test accuracy for step 7250: 0.8428966403007507

Test GAP RMS for gender and step 7250: 0.0739155113697052

Test GAP RMS for race and step 7250: 0.04645698517560959

Test balanced accuracy for step 7250: 0.8019145727157593


Test accuracy for step 7500: 0.8434494137763977

Test GAP RMS for gender and step 7500: 0.07529554516077042

Test GAP RMS for race and step 7500: 0.045969460159540176

Test balanced accuracy for step 7500: 0.8013536930084229


Test accuracy for step 7750: 0.8427860736846924

Test GAP RMS for gender and step 7750: 0.07340538501739502

Test GAP RMS for race and step 7750: 0.05127362906932831

Test balanced accuracy for step 7750: 0.8026132583618164


{'epsilon': 0.01, 'lr': 0.0001, 'wlr': 0.0001, 'w_reg': 10.0}
Final test accuracy: 0.8407959938049316
Final test GAP RMS for gender: 0.07772941887378693
Final test GAP RMS for race: 0.046661488711833954
Final test balanced accuracy: 0.8043854236602783


