2020-05-21 16:32:41.570704: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:41.571747: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:41.571761: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2020-05-21 16:32:47.614703: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:47.614922: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)
2020-05-21 16:32:47.614945: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (gl3157.arc-ts.umich.edu): /proc/driver/nvidia/version does not exist
2020-05-21 16:32:47.615301: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-05-21 16:32:47.621940: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3000000000 Hz
2020-05-21 16:32:47.622033: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55803d218a00 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-05-21 16:32:47.622043: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
/sw/arcts/centos7/python3.6-anaconda/5.2.0/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/array_grad.py:563: _EagerTensorBase.cpu (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.identity instead.
2020-05-21 16:59:01.039202: W tensorflow/python/util/util.cc:319] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1786: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
Test accuracy for step 250: 0.6180210113525391

Test GAP RMS for gender and step 250: 0.12780094146728516

Test GAP RMS for race and step 250: 0.017063921317458153

Test balanced accuracy for step 250: 0.4811164140701294


Test accuracy for step 500: 0.8080707788467407

Test GAP RMS for gender and step 500: 0.30943650007247925

Test GAP RMS for race and step 500: 0.07953228056430817

Test balanced accuracy for step 500: 0.8042203187942505


Test accuracy for step 750: 0.8164731860160828

Test GAP RMS for gender and step 750: 0.23694486916065216

Test GAP RMS for race and step 750: 0.06793080270290375

Test balanced accuracy for step 750: 0.8145555853843689


Test accuracy for step 1000: 0.8217799663543701

Test GAP RMS for gender and step 1000: 0.22486451268196106

Test GAP RMS for race and step 1000: 0.06047920882701874

Test balanced accuracy for step 1000: 0.8152831792831421


Test accuracy for step 1250: 0.8212271928787231

Test GAP RMS for gender and step 1250: 0.21494035422801971

Test GAP RMS for race and step 1250: 0.06066778302192688

Test balanced accuracy for step 1250: 0.8178504705429077


Test accuracy for step 1500: 0.8186843395233154

Test GAP RMS for gender and step 1500: 0.19268810749053955

Test GAP RMS for race and step 1500: 0.061984218657016754

Test balanced accuracy for step 1500: 0.82172691822052


Test accuracy for step 1750: 0.8173576593399048

Test GAP RMS for gender and step 1750: 0.20360317826271057

Test GAP RMS for race and step 1750: 0.06519638001918793

Test balanced accuracy for step 1750: 0.8230112791061401


Test accuracy for step 2000: 0.8181315660476685

Test GAP RMS for gender and step 2000: 0.19193218648433685

Test GAP RMS for race and step 2000: 0.06458675861358643

Test balanced accuracy for step 2000: 0.8255289196968079


Test accuracy for step 2250: 0.8194582462310791

Test GAP RMS for gender and step 2250: 0.1891624927520752

Test GAP RMS for race and step 2250: 0.05996621772646904

Test balanced accuracy for step 2250: 0.8220838308334351


Test accuracy for step 2500: 0.8216694593429565

Test GAP RMS for gender and step 2500: 0.16431470215320587

Test GAP RMS for race and step 2500: 0.059112317860126495

Test balanced accuracy for step 2500: 0.8250879049301147


Test accuracy for step 2750: 0.8169154524803162

Test GAP RMS for gender and step 2750: 0.1646711826324463

Test GAP RMS for race and step 2750: 0.06283184885978699

Test balanced accuracy for step 2750: 0.8279666900634766


Test accuracy for step 3000: 0.8183526992797852

Test GAP RMS for gender and step 3000: 0.17063291370868683

Test GAP RMS for race and step 3000: 0.06130436435341835

Test balanced accuracy for step 3000: 0.8264466524124146


Test accuracy for step 3250: 0.8192371726036072

Test GAP RMS for gender and step 3250: 0.15887875854969025

Test GAP RMS for race and step 3250: 0.05783933028578758

Test balanced accuracy for step 3250: 0.8259506225585938


Test accuracy for step 3500: 0.8200110793113708

Test GAP RMS for gender and step 3500: 0.15105682611465454

Test GAP RMS for race and step 3500: 0.06181635707616806

Test balanced accuracy for step 3500: 0.8287769556045532


Test accuracy for step 3750: 0.8180209994316101

Test GAP RMS for gender and step 3750: 0.14915600419044495

Test GAP RMS for race and step 3750: 0.06124907359480858

Test balanced accuracy for step 3750: 0.8283883333206177


Test accuracy for step 4000: 0.8226644396781921

Test GAP RMS for gender and step 4000: 0.14676299691200256

Test GAP RMS for race and step 4000: 0.058026332408189774

Test balanced accuracy for step 4000: 0.8265169858932495


Test accuracy for step 4250: 0.8204532861709595

Test GAP RMS for gender and step 4250: 0.1506652683019638

Test GAP RMS for race and step 4250: 0.06213165819644928

Test balanced accuracy for step 4250: 0.8289147615432739


Test accuracy for step 4500: 0.8269762396812439

Test GAP RMS for gender and step 4500: 0.13455697894096375

Test GAP RMS for race and step 4500: 0.061309441924095154

Test balanced accuracy for step 4500: 0.8289022445678711


Test accuracy for step 4750: 0.8204532861709595

Test GAP RMS for gender and step 4750: 0.13588033616542816

Test GAP RMS for race and step 4750: 0.061754707247018814

Test balanced accuracy for step 4750: 0.8293777704238892


Test accuracy for step 5000: 0.8234383463859558

Test GAP RMS for gender and step 5000: 0.13492228090763092

Test GAP RMS for race and step 5000: 0.06131724268198013

Test balanced accuracy for step 5000: 0.827799916267395


Test accuracy for step 5250: 0.8221116662025452

Test GAP RMS for gender and step 5250: 0.13428975641727448

Test GAP RMS for race and step 5250: 0.063161700963974

Test balanced accuracy for step 5250: 0.8280038833618164


Test accuracy for step 5500: 0.8235489130020142

Test GAP RMS for gender and step 5500: 0.12475377321243286

Test GAP RMS for race and step 5500: 0.06142386794090271

Test balanced accuracy for step 5500: 0.8280272483825684


Test accuracy for step 5750: 0.8204532861709595

Test GAP RMS for gender and step 5750: 0.1189509928226471

Test GAP RMS for race and step 5750: 0.06341433525085449

Test balanced accuracy for step 5750: 0.8269083499908447


Test accuracy for step 6000: 0.8194582462310791

Test GAP RMS for gender and step 6000: 0.12241711467504501

Test GAP RMS for race and step 6000: 0.06146291643381119

Test balanced accuracy for step 6000: 0.8270226716995239


Test accuracy for step 6250: 0.8204532861709595

Test GAP RMS for gender and step 6250: 0.1243213340640068

Test GAP RMS for race and step 6250: 0.06235707178711891

Test balanced accuracy for step 6250: 0.8287603855133057


Test accuracy for step 6500: 0.8200110793113708

Test GAP RMS for gender and step 6500: 0.11809386312961578

Test GAP RMS for race and step 6500: 0.061075955629348755

Test balanced accuracy for step 6500: 0.826770544052124


Test accuracy for step 6750: 0.8239911794662476

Test GAP RMS for gender and step 6750: 0.10070870816707611

Test GAP RMS for race and step 6750: 0.05573609471321106

Test balanced accuracy for step 6750: 0.8224544525146484


Test accuracy for step 7000: 0.8212271928787231

Test GAP RMS for gender and step 7000: 0.10392782092094421

Test GAP RMS for race and step 7000: 0.0596647635102272

Test balanced accuracy for step 7000: 0.8244870901107788


Test accuracy for step 7250: 0.8208954930305481

Test GAP RMS for gender and step 7250: 0.10631796717643738

Test GAP RMS for race and step 7250: 0.05715276673436165

Test balanced accuracy for step 7250: 0.8224159479141235


Test accuracy for step 7500: 0.8229961395263672

Test GAP RMS for gender and step 7500: 0.10586627572774887

Test GAP RMS for race and step 7500: 0.056655269116163254

Test balanced accuracy for step 7500: 0.8234949111938477


Test accuracy for step 7750: 0.8206744194030762

Test GAP RMS for gender and step 7750: 0.09591957181692123

Test GAP RMS for race and step 7750: 0.056239571422338486

Test balanced accuracy for step 7750: 0.8219611644744873


{'epsilon': 0.0001, 'lr': 0.0001, 'wlr': 1e-05, 'w_reg': 20.0}
Final test accuracy: 0.8183526992797852
Final test GAP RMS for gender: 0.09399108588695526
Final test GAP RMS for race: 0.05105537176132202
Final test balanced accuracy: 0.8205817341804504


