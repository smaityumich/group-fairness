2020-05-21 16:32:44.874805: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:44.875517: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:44.875530: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2020-05-21 16:32:50.716190: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:50.716437: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)
2020-05-21 16:32:50.716463: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (gl3168.arc-ts.umich.edu): /proc/driver/nvidia/version does not exist
2020-05-21 16:32:50.716797: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-05-21 16:32:50.723925: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3000000000 Hz
2020-05-21 16:32:50.724028: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x56056ac7ef50 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-05-21 16:32:50.724038: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
/sw/arcts/centos7/python3.6-anaconda/5.2.0/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/array_grad.py:563: _EagerTensorBase.cpu (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.identity instead.
2020-05-21 16:59:09.239563: W tensorflow/python/util/util.cc:319] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1786: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
Test accuracy for step 250: 0.6194582581520081

Test GAP RMS for gender and step 250: 0.12712040543556213

Test GAP RMS for race and step 250: 0.014294201508164406

Test balanced accuracy for step 250: 0.4768182933330536


Test accuracy for step 500: 0.803758978843689

Test GAP RMS for gender and step 500: 0.3220697343349457

Test GAP RMS for race and step 500: 0.0825578048825264

Test balanced accuracy for step 500: 0.8010632991790771


Test accuracy for step 750: 0.8170259594917297

Test GAP RMS for gender and step 750: 0.10951702296733856

Test GAP RMS for race and step 750: 0.04926580190658569

Test balanced accuracy for step 750: 0.8161554932594299


Test accuracy for step 1000: 0.8237700462341309

Test GAP RMS for gender and step 1000: 0.06467927247285843

Test GAP RMS for race and step 1000: 0.05190037935972214

Test balanced accuracy for step 1000: 0.8084177374839783


Test accuracy for step 1250: 0.8175787925720215

Test GAP RMS for gender and step 1250: 0.0653577446937561

Test GAP RMS for race and step 1250: 0.05534857138991356

Test balanced accuracy for step 1250: 0.8064885139465332


Test accuracy for step 1500: 0.8156992793083191

Test GAP RMS for gender and step 1500: 0.06953898072242737

Test GAP RMS for race and step 1500: 0.05891696736216545

Test balanced accuracy for step 1500: 0.8069446086883545


Test accuracy for step 1750: 0.8165837526321411

Test GAP RMS for gender and step 1750: 0.07029838860034943

Test GAP RMS for race and step 1750: 0.054624974727630615

Test balanced accuracy for step 1750: 0.8107700347900391


Test accuracy for step 2000: 0.8163626194000244

Test GAP RMS for gender and step 2000: 0.07112888246774673

Test GAP RMS for race and step 2000: 0.0519222766160965

Test balanced accuracy for step 2000: 0.8098523020744324


Test accuracy for step 2250: 0.8191266059875488

Test GAP RMS for gender and step 2250: 0.07185729593038559

Test GAP RMS for race and step 2250: 0.049142222851514816

Test balanced accuracy for step 2250: 0.805504560470581


Test accuracy for step 2500: 0.8132669925689697

Test GAP RMS for gender and step 2500: 0.07201094925403595

Test GAP RMS for race and step 2500: 0.04986603185534477

Test balanced accuracy for step 2500: 0.8058009147644043


Test accuracy for step 2750: 0.8108347058296204

Test GAP RMS for gender and step 2750: 0.06627441197633743

Test GAP RMS for race and step 2750: 0.04444319009780884

Test balanced accuracy for step 2750: 0.8108307719230652


Test accuracy for step 3000: 0.8135986924171448

Test GAP RMS for gender and step 3000: 0.06347299367189407

Test GAP RMS for race and step 3000: 0.046146541833877563

Test balanced accuracy for step 3000: 0.8087981343269348


Test accuracy for step 3250: 0.8162520527839661

Test GAP RMS for gender and step 3250: 0.07175607234239578

Test GAP RMS for race and step 3250: 0.043831780552864075

Test balanced accuracy for step 3250: 0.8068467974662781


Test accuracy for step 3500: 0.807296872138977

Test GAP RMS for gender and step 3500: 0.07395106554031372

Test GAP RMS for race and step 3500: 0.04365568608045578

Test balanced accuracy for step 3500: 0.804480791091919


Test accuracy for step 3750: 0.8085129857063293

Test GAP RMS for gender and step 3750: 0.07480569928884506

Test GAP RMS for race and step 3750: 0.04583350569009781

Test balanced accuracy for step 3750: 0.8049755096435547


Test accuracy for step 4000: 0.8143725991249084

Test GAP RMS for gender and step 4000: 0.07164660096168518

Test GAP RMS for race and step 4000: 0.04256388545036316

Test balanced accuracy for step 4000: 0.802518367767334


Test accuracy for step 4250: 0.8164731860160828

Test GAP RMS for gender and step 4250: 0.07187282294034958

Test GAP RMS for race and step 4250: 0.04424476623535156

Test balanced accuracy for step 4250: 0.8054494857788086


Test accuracy for step 4500: 0.8168048858642578

Test GAP RMS for gender and step 4500: 0.07808247208595276

Test GAP RMS for race and step 4500: 0.036597710102796555

Test balanced accuracy for step 4500: 0.800266683101654


Test accuracy for step 4750: 0.807296872138977

Test GAP RMS for gender and step 4750: 0.07704681158065796

Test GAP RMS for race and step 4750: 0.04704555496573448

Test balanced accuracy for step 4750: 0.8041720986366272


Test accuracy for step 5000: 0.812161386013031

Test GAP RMS for gender and step 5000: 0.07001357525587082

Test GAP RMS for race and step 5000: 0.04147480055689812

Test balanced accuracy for step 5000: 0.8039901852607727


Test accuracy for step 5250: 0.8143725991249084

Test GAP RMS for gender and step 5250: 0.08029071986675262

Test GAP RMS for race and step 5250: 0.04321468248963356

Test balanced accuracy for step 5250: 0.8000489473342896


Test accuracy for step 5500: 0.8134881258010864

Test GAP RMS for gender and step 5500: 0.07825268059968948

Test GAP RMS for race and step 5500: 0.04264494776725769

Test balanced accuracy for step 5500: 0.8008537292480469


Test accuracy for step 5750: 0.8061912655830383

Test GAP RMS for gender and step 5750: 0.0714116245508194

Test GAP RMS for race and step 5750: 0.04641014710068703

Test balanced accuracy for step 5750: 0.8043677806854248


Test accuracy for step 6000: 0.8068546056747437

Test GAP RMS for gender and step 6000: 0.07188514620065689

Test GAP RMS for race and step 6000: 0.04739033430814743

Test balanced accuracy for step 6000: 0.8048059940338135


Test accuracy for step 6250: 0.8096185922622681

Test GAP RMS for gender and step 6250: 0.07010596245527267

Test GAP RMS for race and step 6250: 0.03990998491644859

Test balanced accuracy for step 6250: 0.8063231706619263


Test accuracy for step 6500: 0.8090657591819763

Test GAP RMS for gender and step 6500: 0.07038106769323349

Test GAP RMS for race and step 6500: 0.04422902688384056

Test balanced accuracy for step 6500: 0.8047232627868652


Test accuracy for step 6750: 0.8120508790016174

Test GAP RMS for gender and step 6750: 0.080400750041008

Test GAP RMS for race and step 6750: 0.046843934804201126

Test balanced accuracy for step 6750: 0.8009846210479736


Test accuracy for step 7000: 0.8082918524742126

Test GAP RMS for gender and step 7000: 0.07456935942173004

Test GAP RMS for race and step 7000: 0.04439210146665573

Test balanced accuracy for step 7000: 0.803594708442688


Test accuracy for step 7250: 0.8132669925689697

Test GAP RMS for gender and step 7250: 0.07696789503097534

Test GAP RMS for race and step 7250: 0.03833157569169998

Test balanced accuracy for step 7250: 0.8047205209732056


Test accuracy for step 7500: 0.8117191791534424

Test GAP RMS for gender and step 7500: 0.07320103794336319

Test GAP RMS for race and step 7500: 0.03769382834434509

Test balanced accuracy for step 7500: 0.8052414655685425


Test accuracy for step 7750: 0.8114980459213257

Test GAP RMS for gender and step 7750: 0.07563400268554688

Test GAP RMS for race and step 7750: 0.04061942547559738

Test balanced accuracy for step 7750: 0.8044779896736145


{'epsilon': 0.0001, 'lr': 0.0001, 'wlr': 0.0001, 'w_reg': 60.0}
Final test accuracy: 0.807517945766449
Final test GAP RMS for gender: 0.08179847151041031
Final test GAP RMS for race: 0.04234107583761215
Final test balanced accuracy: 0.8012313842773438


