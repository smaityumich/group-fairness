2020-05-21 16:32:43.964326: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:43.965140: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:43.965162: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2020-05-21 16:32:53.797350: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:53.797548: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)
2020-05-21 16:32:53.797586: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (gl3099.arc-ts.umich.edu): /proc/driver/nvidia/version does not exist
2020-05-21 16:32:53.797930: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-05-21 16:32:53.804486: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3000000000 Hz
2020-05-21 16:32:53.804601: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5572680fdc50 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-05-21 16:32:53.804616: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
/sw/arcts/centos7/python3.6-anaconda/5.2.0/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/array_grad.py:563: _EagerTensorBase.cpu (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.identity instead.
2020-05-21 16:59:38.142564: W tensorflow/python/util/util.cc:319] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1786: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
Test accuracy for step 250: 0.6187949180603027

Test GAP RMS for gender and step 250: 0.12766416370868683

Test GAP RMS for race and step 250: 0.01666763611137867

Test balanced accuracy for step 250: 0.4791582226753235


Test accuracy for step 500: 0.8133775591850281

Test GAP RMS for gender and step 500: 0.3369963765144348

Test GAP RMS for race and step 500: 0.07966165244579315

Test balanced accuracy for step 500: 0.7888964414596558


Test accuracy for step 750: 0.8260917663574219

Test GAP RMS for gender and step 750: 0.2528811991214752

Test GAP RMS for race and step 750: 0.07815133780241013

Test balanced accuracy for step 750: 0.803469181060791


Test accuracy for step 1000: 0.8393587470054626

Test GAP RMS for gender and step 1000: 0.20713266730308533

Test GAP RMS for race and step 1000: 0.07590433955192566

Test balanced accuracy for step 1000: 0.8022012710571289


Test accuracy for step 1250: 0.8404643535614014

Test GAP RMS for gender and step 1250: 0.1873425543308258

Test GAP RMS for race and step 1250: 0.07468647509813309

Test balanced accuracy for step 1250: 0.803857684135437


Test accuracy for step 1500: 0.8360419869422913

Test GAP RMS for gender and step 1500: 0.1918267458677292

Test GAP RMS for race and step 1500: 0.07752422243356705

Test balanced accuracy for step 1500: 0.8058751225471497


Test accuracy for step 1750: 0.8352680802345276

Test GAP RMS for gender and step 1750: 0.19729748368263245

Test GAP RMS for race and step 1750: 0.0716465562582016

Test balanced accuracy for step 1750: 0.8075246810913086


Test accuracy for step 2000: 0.8355997800827026

Test GAP RMS for gender and step 2000: 0.19994686543941498

Test GAP RMS for race and step 2000: 0.07390555739402771

Test balanced accuracy for step 2000: 0.8099045753479004


Test accuracy for step 2250: 0.8399115800857544

Test GAP RMS for gender and step 2250: 0.17963193356990814

Test GAP RMS for race and step 2250: 0.07053043693304062

Test balanced accuracy for step 2250: 0.8024120330810547


Test accuracy for step 2500: 0.8420121669769287

Test GAP RMS for gender and step 2500: 0.17498064041137695

Test GAP RMS for race and step 2500: 0.07643503695726395

Test balanced accuracy for step 2500: 0.808738648891449


Test accuracy for step 2750: 0.8367053866386414

Test GAP RMS for gender and step 2750: 0.18614521622657776

Test GAP RMS for race and step 2750: 0.07125310599803925

Test balanced accuracy for step 2750: 0.8115609288215637


Test accuracy for step 3000: 0.836594820022583

Test GAP RMS for gender and step 3000: 0.19869309663772583

Test GAP RMS for race and step 3000: 0.07382670044898987

Test balanced accuracy for step 3000: 0.8097901344299316


Test accuracy for step 3250: 0.839469313621521

Test GAP RMS for gender and step 3250: 0.18634116649627686

Test GAP RMS for race and step 3250: 0.07330486178398132

Test balanced accuracy for step 3250: 0.8079848885536194


Test accuracy for step 3500: 0.8407959938049316

Test GAP RMS for gender and step 3500: 0.17632956802845

Test GAP RMS for race and step 3500: 0.07214610278606415

Test balanced accuracy for step 3500: 0.8080896139144897


Test accuracy for step 3750: 0.8384742736816406

Test GAP RMS for gender and step 3750: 0.18102070689201355

Test GAP RMS for race and step 3750: 0.07108675688505173

Test balanced accuracy for step 3750: 0.8118034601211548


Test accuracy for step 4000: 0.840022087097168

Test GAP RMS for gender and step 4000: 0.1838764250278473

Test GAP RMS for race and step 4000: 0.06697829812765121

Test balanced accuracy for step 4000: 0.8064979910850525


Test accuracy for step 4250: 0.8373687267303467

Test GAP RMS for gender and step 4250: 0.1941877156496048

Test GAP RMS for race and step 4250: 0.0650322437286377

Test balanced accuracy for step 4250: 0.809066653251648


Test accuracy for step 4500: 0.842343807220459

Test GAP RMS for gender and step 4500: 0.16511403024196625

Test GAP RMS for race and step 4500: 0.06722000241279602

Test balanced accuracy for step 4500: 0.8017037510871887


Test accuracy for step 4750: 0.8384742736816406

Test GAP RMS for gender and step 4750: 0.1861630082130432

Test GAP RMS for race and step 4750: 0.061957038938999176

Test balanced accuracy for step 4750: 0.812575101852417


Test accuracy for step 5000: 0.8399115800857544

Test GAP RMS for gender and step 5000: 0.18701684474945068

Test GAP RMS for race and step 5000: 0.06528177112340927

Test balanced accuracy for step 5000: 0.8098204135894775


Test accuracy for step 5250: 0.838916540145874

Test GAP RMS for gender and step 5250: 0.19167424738407135

Test GAP RMS for race and step 5250: 0.06375094503164291

Test balanced accuracy for step 5250: 0.8107064962387085


Test accuracy for step 5500: 0.8373687267303467

Test GAP RMS for gender and step 5500: 0.18481600284576416

Test GAP RMS for race and step 5500: 0.057290706783533096

Test balanced accuracy for step 5500: 0.8070602416992188


Test accuracy for step 5750: 0.8379215002059937

Test GAP RMS for gender and step 5750: 0.17289552092552185

Test GAP RMS for race and step 5750: 0.05980006232857704

Test balanced accuracy for step 5750: 0.8135990500450134


Test accuracy for step 6000: 0.8353786468505859

Test GAP RMS for gender and step 6000: 0.19023063778877258

Test GAP RMS for race and step 6000: 0.060495585203170776

Test balanced accuracy for step 6000: 0.8153147101402283


Test accuracy for step 6250: 0.834273099899292

Test GAP RMS for gender and step 6250: 0.2057172656059265

Test GAP RMS for race and step 6250: 0.06151778623461723

Test balanced accuracy for step 6250: 0.8139669895172119


Test accuracy for step 6500: 0.8347153067588806

Test GAP RMS for gender and step 6500: 0.1977066695690155

Test GAP RMS for race and step 6500: 0.06236879900097847

Test balanced accuracy for step 6500: 0.8145678043365479


Test accuracy for step 6750: 0.8388059735298157

Test GAP RMS for gender and step 6750: 0.17365114390850067

Test GAP RMS for race and step 6750: 0.05792311206459999

Test balanced accuracy for step 6750: 0.8115595579147339


Test accuracy for step 7000: 0.8372581601142883

Test GAP RMS for gender and step 7000: 0.18103072047233582

Test GAP RMS for race and step 7000: 0.05748293921351433

Test balanced accuracy for step 7000: 0.8174823522567749


Test accuracy for step 7250: 0.8367053866386414

Test GAP RMS for gender and step 7250: 0.18234369158744812

Test GAP RMS for race and step 7250: 0.06057880073785782

Test balanced accuracy for step 7250: 0.8161911368370056


Test accuracy for step 7500: 0.83338862657547

Test GAP RMS for gender and step 7500: 0.19647441804409027

Test GAP RMS for race and step 7500: 0.06320124864578247

Test balanced accuracy for step 7500: 0.8141544461250305


Test accuracy for step 7750: 0.8353786468505859

Test GAP RMS for gender and step 7750: 0.17312230169773102

Test GAP RMS for race and step 7750: 0.0588143952190876

Test balanced accuracy for step 7750: 0.8159320950508118


{'epsilon': 0.001, 'lr': 0.0001, 'wlr': 1e-06, 'w_reg': 20.0}
Final test accuracy: 0.8339414000511169
Final test GAP RMS for gender: 0.16864927113056183
Final test GAP RMS for race: 0.058350108563899994
Final test balanced accuracy: 0.8183780908584595


