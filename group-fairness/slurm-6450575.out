2020-05-21 16:32:42.219395: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:42.220004: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:42.220017: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2020-05-21 16:32:48.354124: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:48.356065: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)
2020-05-21 16:32:48.357952: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (gl3254.arc-ts.umich.edu): /proc/driver/nvidia/version does not exist
2020-05-21 16:32:48.374156: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-05-21 16:32:48.407172: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3000000000 Hz
2020-05-21 16:32:48.407300: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55aea4eb1a90 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-05-21 16:32:48.407314: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
/sw/arcts/centos7/python3.6-anaconda/5.2.0/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/array_grad.py:563: _EagerTensorBase.cpu (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.identity instead.
2020-05-21 16:59:42.838976: W tensorflow/python/util/util.cc:319] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1786: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
Test accuracy for step 250: 0.6174682378768921

Test GAP RMS for gender and step 250: 0.12841522693634033

Test GAP RMS for race and step 250: 0.01928897574543953

Test balanced accuracy for step 250: 0.48214030265808105


Test accuracy for step 500: 0.8150359392166138

Test GAP RMS for gender and step 500: 0.2591238021850586

Test GAP RMS for race and step 500: 0.0751049667596817

Test balanced accuracy for step 500: 0.8049630522727966


Test accuracy for step 750: 0.8223327994346619

Test GAP RMS for gender and step 750: 0.1825859099626541

Test GAP RMS for race and step 750: 0.05489499866962433

Test balanced accuracy for step 750: 0.8151853084564209


Test accuracy for step 1000: 0.8291873931884766

Test GAP RMS for gender and step 1000: 0.16008083522319794

Test GAP RMS for race and step 1000: 0.054431937634944916

Test balanced accuracy for step 1000: 0.8107616901397705


Test accuracy for step 1250: 0.8322830200195312

Test GAP RMS for gender and step 1250: 0.13809828460216522

Test GAP RMS for race and step 1250: 0.05587117746472359

Test balanced accuracy for step 1250: 0.8140414357185364


Test accuracy for step 1500: 0.831066906452179

Test GAP RMS for gender and step 1500: 0.12500162422657013

Test GAP RMS for race and step 1500: 0.055990129709243774

Test balanced accuracy for step 1500: 0.8201833963394165


Test accuracy for step 1750: 0.8311774730682373

Test GAP RMS for gender and step 1750: 0.13040755689144135

Test GAP RMS for race and step 1750: 0.05080484226346016

Test balanced accuracy for step 1750: 0.8196390867233276


Test accuracy for step 2000: 0.8295190930366516

Test GAP RMS for gender and step 2000: 0.1240721270442009

Test GAP RMS for race and step 2000: 0.05230281502008438

Test balanced accuracy for step 2000: 0.8183891773223877


Test accuracy for step 2250: 0.8354892134666443

Test GAP RMS for gender and step 2250: 0.11121579259634018

Test GAP RMS for race and step 2250: 0.054215207695961

Test balanced accuracy for step 2250: 0.8136900067329407


Test accuracy for step 2500: 0.8378109335899353

Test GAP RMS for gender and step 2500: 0.09814349561929703

Test GAP RMS for race and step 2500: 0.05276279151439667

Test balanced accuracy for step 2500: 0.8180018663406372


Test accuracy for step 2750: 0.8312879800796509

Test GAP RMS for gender and step 2750: 0.11147922277450562

Test GAP RMS for race and step 2750: 0.052087754011154175

Test balanced accuracy for step 2750: 0.81801438331604


Test accuracy for step 3000: 0.8368158936500549

Test GAP RMS for gender and step 3000: 0.10920505225658417

Test GAP RMS for race and step 3000: 0.05207383260130882

Test balanced accuracy for step 3000: 0.817653238773346


Test accuracy for step 3250: 0.837700366973877

Test GAP RMS for gender and step 3250: 0.09622965008020401

Test GAP RMS for race and step 3250: 0.05564754456281662

Test balanced accuracy for step 3250: 0.8116008639335632


Test accuracy for step 3500: 0.838032066822052

Test GAP RMS for gender and step 3500: 0.0890185758471489

Test GAP RMS for race and step 3500: 0.053721778094768524

Test balanced accuracy for step 3500: 0.8124373555183411


Test accuracy for step 3750: 0.836594820022583

Test GAP RMS for gender and step 3750: 0.09135482460260391

Test GAP RMS for race and step 3750: 0.05664211884140968

Test balanced accuracy for step 3750: 0.8151921033859253


Test accuracy for step 4000: 0.840022087097168

Test GAP RMS for gender and step 4000: 0.08664582669734955

Test GAP RMS for race and step 4000: 0.04968582093715668

Test balanced accuracy for step 4000: 0.8072696924209595


Test accuracy for step 4250: 0.8388059735298157

Test GAP RMS for gender and step 4250: 0.09022203087806702

Test GAP RMS for race and step 4250: 0.04962456598877907

Test balanced accuracy for step 4250: 0.807237982749939


Test accuracy for step 4500: 0.8433388471603394

Test GAP RMS for gender and step 4500: 0.07919243723154068

Test GAP RMS for race and step 4500: 0.04719877243041992

Test balanced accuracy for step 4500: 0.8029783964157104


Test accuracy for step 4750: 0.8378109335899353

Test GAP RMS for gender and step 4750: 0.08505494892597198

Test GAP RMS for race and step 4750: 0.04847751557826996

Test balanced accuracy for step 4750: 0.8099761605262756


Test accuracy for step 5000: 0.8396904468536377

Test GAP RMS for gender and step 5000: 0.08297623693943024

Test GAP RMS for race and step 5000: 0.04345332086086273

Test balanced accuracy for step 5000: 0.8055071830749512


Test accuracy for step 5250: 0.8396904468536377

Test GAP RMS for gender and step 5250: 0.08269128203392029

Test GAP RMS for race and step 5250: 0.04714760556817055

Test balanced accuracy for step 5250: 0.8047354817390442


Test accuracy for step 5500: 0.8420121669769287

Test GAP RMS for gender and step 5500: 0.07924263179302216

Test GAP RMS for race and step 5500: 0.049746908247470856

Test balanced accuracy for step 5500: 0.8048801422119141


Test accuracy for step 5750: 0.838032066822052

Test GAP RMS for gender and step 5750: 0.08196517080068588

Test GAP RMS for race and step 5750: 0.05082045495510101

Test balanced accuracy for step 5750: 0.8073440790176392


Test accuracy for step 6000: 0.8390271067619324

Test GAP RMS for gender and step 6000: 0.08221378922462463

Test GAP RMS for race and step 6000: 0.04938823729753494

Test balanced accuracy for step 6000: 0.8093905448913574


Test accuracy for step 6250: 0.83714759349823

Test GAP RMS for gender and step 6250: 0.08435586839914322

Test GAP RMS for race and step 6250: 0.047251004725694656

Test balanced accuracy for step 6250: 0.8052164316177368


Test accuracy for step 6500: 0.8369264602661133

Test GAP RMS for gender and step 6500: 0.08737035095691681

Test GAP RMS for race and step 6500: 0.05044478550553322

Test balanced accuracy for step 6500: 0.807231068611145


Test accuracy for step 6750: 0.8425649404525757

Test GAP RMS for gender and step 6750: 0.07616817951202393

Test GAP RMS for race and step 6750: 0.051926326006650925

Test balanced accuracy for step 6750: 0.8018498420715332


Test accuracy for step 7000: 0.8391376733779907

Test GAP RMS for gender and step 7000: 0.07916631549596786

Test GAP RMS for race and step 7000: 0.04645555466413498

Test balanced accuracy for step 7000: 0.8040616512298584


Test accuracy for step 7250: 0.8404643535614014

Test GAP RMS for gender and step 7250: 0.07829602807760239

Test GAP RMS for race and step 7250: 0.048435959964990616

Test balanced accuracy for step 7250: 0.8020055294036865


Test accuracy for step 7500: 0.8401326537132263

Test GAP RMS for gender and step 7500: 0.0788840726017952

Test GAP RMS for race and step 7500: 0.047479331493377686

Test balanced accuracy for step 7500: 0.8014777898788452


Test accuracy for step 7750: 0.8421227335929871

Test GAP RMS for gender and step 7750: 0.07431773096323013

Test GAP RMS for race and step 7750: 0.05479486659169197

Test balanced accuracy for step 7750: 0.8035640716552734


{'epsilon': 0.01, 'lr': 0.0001, 'wlr': 1e-05, 'w_reg': 10.0}
Final test accuracy: 0.838363766670227
Final test GAP RMS for gender: 0.08113466948270798
Final test GAP RMS for race: 0.049697451293468475
Final test balanced accuracy: 0.8046307563781738


