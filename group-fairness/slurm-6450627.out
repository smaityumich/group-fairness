2020-05-21 16:32:43.111238: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:43.112085: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:43.112096: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2020-05-21 16:32:52.976386: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:52.976722: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)
2020-05-21 16:32:52.976743: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (gl3108.arc-ts.umich.edu): /proc/driver/nvidia/version does not exist
2020-05-21 16:32:52.977044: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-05-21 16:32:52.983359: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3000000000 Hz
2020-05-21 16:32:52.983446: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x559182f02430 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-05-21 16:32:52.983456: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
/sw/arcts/centos7/python3.6-anaconda/5.2.0/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/array_grad.py:563: _EagerTensorBase.cpu (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.identity instead.
2020-05-21 16:59:56.887002: W tensorflow/python/util/util.cc:319] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1786: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
Test accuracy for step 250: 0.6180210113525391

Test GAP RMS for gender and step 250: 0.12716370820999146

Test GAP RMS for race and step 250: 0.016248969361186028

Test balanced accuracy for step 250: 0.4791099727153778


Test accuracy for step 500: 0.8090657591819763

Test GAP RMS for gender and step 500: 0.342763751745224

Test GAP RMS for race and step 500: 0.08468440175056458

Test balanced accuracy for step 500: 0.7966975569725037


Test accuracy for step 750: 0.8216694593429565

Test GAP RMS for gender and step 750: 0.26680612564086914

Test GAP RMS for race and step 750: 0.08183785527944565

Test balanced accuracy for step 750: 0.8096538782119751


Test accuracy for step 1000: 0.8266445398330688

Test GAP RMS for gender and step 1000: 0.23771709203720093

Test GAP RMS for race and step 1000: 0.07397040724754333

Test balanced accuracy for step 1000: 0.8121687173843384


Test accuracy for step 1250: 0.8242122530937195

Test GAP RMS for gender and step 1250: 0.2361266165971756

Test GAP RMS for race and step 1250: 0.06864558160305023

Test balanced accuracy for step 1250: 0.8161182403564453


Test accuracy for step 1500: 0.8203427195549011

Test GAP RMS for gender and step 1500: 0.22297458350658417

Test GAP RMS for race and step 1500: 0.06722155958414078

Test balanced accuracy for step 1500: 0.8172661662101746


Test accuracy for step 1750: 0.8191266059875488

Test GAP RMS for gender and step 1750: 0.23220407962799072

Test GAP RMS for race and step 1750: 0.06471497565507889

Test balanced accuracy for step 1750: 0.8193952441215515


Test accuracy for step 2000: 0.8190160393714905

Test GAP RMS for gender and step 2000: 0.2215680181980133

Test GAP RMS for race and step 2000: 0.06358857452869415

Test balanced accuracy for step 2000: 0.8197852373123169


Test accuracy for step 2250: 0.8224433660507202

Test GAP RMS for gender and step 2250: 0.21591253578662872

Test GAP RMS for race and step 2250: 0.06403426826000214

Test balanced accuracy for step 2250: 0.8186538219451904


Test accuracy for step 2500: 0.8244333863258362

Test GAP RMS for gender and step 2500: 0.1899791806936264

Test GAP RMS for race and step 2500: 0.05898356810212135

Test balanced accuracy for step 2500: 0.8222835659980774


Test accuracy for step 2750: 0.8205638527870178

Test GAP RMS for gender and step 2750: 0.19232182204723358

Test GAP RMS for race and step 2750: 0.06225472316145897

Test balanced accuracy for step 2750: 0.8243575692176819


Test accuracy for step 3000: 0.8211166262626648

Test GAP RMS for gender and step 3000: 0.18806345760822296

Test GAP RMS for race and step 3000: 0.060859713703393936

Test balanced accuracy for step 3000: 0.8241053819656372


Test accuracy for step 3250: 0.8221116662025452

Test GAP RMS for gender and step 3250: 0.1761751025915146

Test GAP RMS for race and step 3250: 0.058099016547203064

Test balanced accuracy for step 3250: 0.8236823081970215


Test accuracy for step 3500: 0.8231067061424255

Test GAP RMS for gender and step 3500: 0.16330383718013763

Test GAP RMS for race and step 3500: 0.05912783369421959

Test balanced accuracy for step 3500: 0.8278894424438477


Test accuracy for step 3750: 0.8214483261108398

Test GAP RMS for gender and step 3750: 0.1565660536289215

Test GAP RMS for race and step 3750: 0.060130525380373

Test balanced accuracy for step 3750: 0.8283373117446899


Test accuracy for step 4000: 0.8245439529418945

Test GAP RMS for gender and step 4000: 0.1528557389974594

Test GAP RMS for race and step 4000: 0.05640179663896561

Test balanced accuracy for step 4000: 0.8263694643974304


Test accuracy for step 4250: 0.8204532861709595

Test GAP RMS for gender and step 4250: 0.1552513688802719

Test GAP RMS for race and step 4250: 0.06038933992385864

Test balanced accuracy for step 4250: 0.8269083499908447


Test accuracy for step 4500: 0.8283029198646545

Test GAP RMS for gender and step 4500: 0.14013215899467468

Test GAP RMS for race and step 4500: 0.05779954046010971

Test balanced accuracy for step 4500: 0.8279266357421875


Test accuracy for step 4750: 0.8212271928787231

Test GAP RMS for gender and step 4750: 0.14167505502700806

Test GAP RMS for race and step 4750: 0.06400605291128159

Test balanced accuracy for step 4750: 0.8294259905815125


Test accuracy for step 5000: 0.8250967264175415

Test GAP RMS for gender and step 5000: 0.13884124159812927

Test GAP RMS for race and step 5000: 0.060768287628889084

Test balanced accuracy for step 5000: 0.8292040824890137


Test accuracy for step 5250: 0.8254284262657166

Test GAP RMS for gender and step 5250: 0.13489967584609985

Test GAP RMS for race and step 5250: 0.06019306182861328

Test balanced accuracy for step 5250: 0.8292688131332397


Test accuracy for step 5500: 0.8279712796211243

Test GAP RMS for gender and step 5500: 0.12427106499671936

Test GAP RMS for race and step 5500: 0.06421653181314468

Test balanced accuracy for step 5500: 0.8277075290679932


Test accuracy for step 5750: 0.8231067061424255

Test GAP RMS for gender and step 5750: 0.11861138790845871

Test GAP RMS for race and step 5750: 0.06432797014713287

Test balanced accuracy for step 5750: 0.8271177411079407


Test accuracy for step 6000: 0.8233277797698975

Test GAP RMS for gender and step 6000: 0.12202005833387375

Test GAP RMS for race and step 6000: 0.06413917988538742

Test balanced accuracy for step 6000: 0.8277268409729004


Test accuracy for step 6250: 0.8228855729103088

Test GAP RMS for gender and step 6250: 0.1224064826965332

Test GAP RMS for race and step 6250: 0.06011349335312843

Test balanced accuracy for step 6250: 0.8292868137359619


Test accuracy for step 6500: 0.8231067061424255

Test GAP RMS for gender and step 6500: 0.11145314574241638

Test GAP RMS for race and step 6500: 0.0609624870121479

Test balanced accuracy for step 6500: 0.8272720575332642


Test accuracy for step 6750: 0.8258706331253052

Test GAP RMS for gender and step 6750: 0.09652146697044373

Test GAP RMS for race and step 6750: 0.06069374829530716

Test balanced accuracy for step 6750: 0.8215352892875671


Test accuracy for step 7000: 0.8244333863258362

Test GAP RMS for gender and step 7000: 0.09825354069471359

Test GAP RMS for race and step 7000: 0.0563146248459816

Test balanced accuracy for step 7000: 0.8247530460357666


Test accuracy for step 7250: 0.8254284262657166

Test GAP RMS for gender and step 7250: 0.09824301302433014

Test GAP RMS for race and step 7250: 0.05653488636016846

Test balanced accuracy for step 7250: 0.8234038949012756


Test accuracy for step 7500: 0.8257600665092468

Test GAP RMS for gender and step 7500: 0.09694165736436844

Test GAP RMS for race and step 7500: 0.050173159688711166

Test balanced accuracy for step 7500: 0.8219252824783325


Test accuracy for step 7750: 0.8235489130020142

Test GAP RMS for gender and step 7750: 0.08999761193990707

Test GAP RMS for race and step 7750: 0.05251502990722656

Test balanced accuracy for step 7750: 0.8215449452400208


{'epsilon': 0.0001, 'lr': 0.0001, 'wlr': 1e-05, 'w_reg': 30.0}
Final test accuracy: 0.8211166262626648
Final test GAP RMS for gender: 0.08751901239156723
Final test GAP RMS for race: 0.051878657191991806
Final test balanced accuracy: 0.8194751739501953


