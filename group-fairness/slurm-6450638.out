2020-05-21 16:32:43.111234: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:43.112065: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:43.112076: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2020-05-21 16:32:52.992590: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:52.992802: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)
2020-05-21 16:32:52.992831: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (gl3108.arc-ts.umich.edu): /proc/driver/nvidia/version does not exist
2020-05-21 16:32:52.993311: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-05-21 16:32:53.000468: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3000000000 Hz
2020-05-21 16:32:53.000565: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55edb6822470 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-05-21 16:32:53.000575: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
/sw/arcts/centos7/python3.6-anaconda/5.2.0/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/array_grad.py:563: _EagerTensorBase.cpu (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.identity instead.
2020-05-21 16:59:11.696767: W tensorflow/python/util/util.cc:319] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1786: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
Test accuracy for step 250: 0.6194582581520081

Test GAP RMS for gender and step 250: 0.12842831015586853

Test GAP RMS for race and step 250: 0.015196235850453377

Test balanced accuracy for step 250: 0.4785160422325134


Test accuracy for step 500: 0.8172470927238464

Test GAP RMS for gender and step 500: 0.36757659912109375

Test GAP RMS for race and step 500: 0.08682303875684738

Test balanced accuracy for step 500: 0.7854334115982056


Test accuracy for step 750: 0.8262023329734802

Test GAP RMS for gender and step 750: 0.2868345081806183

Test GAP RMS for race and step 750: 0.08200997859239578

Test balanced accuracy for step 750: 0.7987576127052307


Test accuracy for step 1000: 0.8375898003578186

Test GAP RMS for gender and step 1000: 0.24616755545139313

Test GAP RMS for race and step 1000: 0.08297306299209595

Test balanced accuracy for step 1000: 0.7964024543762207


Test accuracy for step 1250: 0.8401326537132263

Test GAP RMS for gender and step 1250: 0.2278711497783661

Test GAP RMS for race and step 1250: 0.07729919999837875

Test balanced accuracy for step 1250: 0.7986996173858643


Test accuracy for step 1500: 0.8360419869422913

Test GAP RMS for gender and step 1500: 0.2287614792585373

Test GAP RMS for race and step 1500: 0.0703636184334755

Test balanced accuracy for step 1500: 0.8029426336288452


Test accuracy for step 1750: 0.834273099899292

Test GAP RMS for gender and step 1750: 0.23807574808597565

Test GAP RMS for race and step 1750: 0.07290410250425339

Test balanced accuracy for step 1750: 0.8030087947845459


Test accuracy for step 2000: 0.834825873374939

Test GAP RMS for gender and step 2000: 0.23234839737415314

Test GAP RMS for race and step 2000: 0.07497403770685196

Test balanced accuracy for step 2000: 0.8055347204208374


Test accuracy for step 2250: 0.8378109335899353

Test GAP RMS for gender and step 2250: 0.23203711211681366

Test GAP RMS for race and step 2250: 0.07115743309259415

Test balanced accuracy for step 2250: 0.7997896671295166


Test accuracy for step 2500: 0.838584840297699

Test GAP RMS for gender and step 2500: 0.2223719358444214

Test GAP RMS for race and step 2500: 0.06891950964927673

Test balanced accuracy for step 2500: 0.8058571815490723


Test accuracy for step 2750: 0.8343836665153503

Test GAP RMS for gender and step 2750: 0.23754876852035522

Test GAP RMS for race and step 2750: 0.06864392757415771

Test balanced accuracy for step 2750: 0.8087924718856812


Test accuracy for step 3000: 0.8339414000511169

Test GAP RMS for gender and step 3000: 0.24510890245437622

Test GAP RMS for race and step 3000: 0.0696122944355011

Test balanced accuracy for step 3000: 0.8100436925888062


Test accuracy for step 3250: 0.835157573223114

Test GAP RMS for gender and step 3250: 0.2359907031059265

Test GAP RMS for race and step 3250: 0.06890767067670822

Test balanced accuracy for step 3250: 0.807451605796814


Test accuracy for step 3500: 0.835710346698761

Test GAP RMS for gender and step 3500: 0.22654150426387787

Test GAP RMS for race and step 3500: 0.07132278382778168

Test balanced accuracy for step 3500: 0.807816743850708


Test accuracy for step 3750: 0.8343836665153503

Test GAP RMS for gender and step 3750: 0.22770819067955017

Test GAP RMS for race and step 3750: 0.07311225682497025

Test balanced accuracy for step 3750: 0.8135770559310913


Test accuracy for step 4000: 0.835157573223114

Test GAP RMS for gender and step 4000: 0.2356652319431305

Test GAP RMS for race and step 4000: 0.07001825422048569

Test balanced accuracy for step 4000: 0.8094580769538879


Test accuracy for step 4250: 0.8330569267272949

Test GAP RMS for gender and step 4250: 0.24282346665859222

Test GAP RMS for race and step 4250: 0.06748463213443756

Test balanced accuracy for step 4250: 0.8120832443237305


Test accuracy for step 4500: 0.8382532000541687

Test GAP RMS for gender and step 4500: 0.2168099582195282

Test GAP RMS for race and step 4500: 0.06656713038682938

Test balanced accuracy for step 4500: 0.8062554597854614


Test accuracy for step 4750: 0.8349364399909973

Test GAP RMS for gender and step 4750: 0.22237735986709595

Test GAP RMS for race and step 4750: 0.06528224796056747

Test balanced accuracy for step 4750: 0.8156399726867676


Test accuracy for step 5000: 0.8354892134666443

Test GAP RMS for gender and step 5000: 0.22128194570541382

Test GAP RMS for race and step 5000: 0.06538064032793045

Test balanced accuracy for step 5000: 0.8136900067329407


Test accuracy for step 5250: 0.8334991931915283

Test GAP RMS for gender and step 5250: 0.22942005097866058

Test GAP RMS for race and step 5250: 0.06824560463428497

Test balanced accuracy for step 5250: 0.8149991631507874


Test accuracy for step 5500: 0.8340519666671753

Test GAP RMS for gender and step 5500: 0.22109900414943695

Test GAP RMS for race and step 5500: 0.063576839864254

Test balanced accuracy for step 5500: 0.8144382834434509


Test accuracy for step 5750: 0.8343836665153503

Test GAP RMS for gender and step 5750: 0.20789730548858643

Test GAP RMS for race and step 5750: 0.06475717574357986

Test balanced accuracy for step 5750: 0.816200852394104


Test accuracy for step 6000: 0.8313985466957092

Test GAP RMS for gender and step 6000: 0.22072665393352509

Test GAP RMS for race and step 6000: 0.0654684528708458

Test balanced accuracy for step 6000: 0.8177787065505981


Test accuracy for step 6250: 0.8312879800796509

Test GAP RMS for gender and step 6250: 0.22924108803272247

Test GAP RMS for race and step 6250: 0.06566977500915527

Test balanced accuracy for step 6250: 0.8184773921966553


Test accuracy for step 6500: 0.8298507332801819

Test GAP RMS for gender and step 6500: 0.22757796943187714

Test GAP RMS for race and step 6500: 0.06844744086265564

Test balanced accuracy for step 6500: 0.8175278902053833


Test accuracy for step 6750: 0.8339414000511169

Test GAP RMS for gender and step 6750: 0.21289099752902985

Test GAP RMS for race and step 6750: 0.06551730632781982

Test balanced accuracy for step 6750: 0.8157542943954468


Test accuracy for step 7000: 0.8312879800796509

Test GAP RMS for gender and step 7000: 0.213754802942276

Test GAP RMS for race and step 7000: 0.06596200913190842

Test balanced accuracy for step 7000: 0.8186317086219788


Test accuracy for step 7250: 0.8312879800796509

Test GAP RMS for gender and step 7250: 0.21327489614486694

Test GAP RMS for race and step 7250: 0.06748369336128235

Test balanced accuracy for step 7250: 0.818323016166687


Test accuracy for step 7500: 0.8296296000480652

Test GAP RMS for gender and step 7500: 0.2269410938024521

Test GAP RMS for race and step 7500: 0.06522633135318756

Test balanced accuracy for step 7500: 0.8173818588256836


Test accuracy for step 7750: 0.8307352066040039

Test GAP RMS for gender and step 7750: 0.20990726351737976

Test GAP RMS for race and step 7750: 0.0657898411154747

Test balanced accuracy for step 7750: 0.8218163847923279


{'epsilon': 1e-05, 'lr': 0.0001, 'wlr': 1e-06, 'w_reg': 30.0}
Final test accuracy: 0.8304035663604736
Final test GAP RMS for gender: 0.21041476726531982
Final test GAP RMS for race: 0.06523936986923218
Final test balanced accuracy: 0.8200538158416748


