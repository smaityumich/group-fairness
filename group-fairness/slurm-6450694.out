2020-05-21 16:32:44.739911: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:44.740632: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:44.740645: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2020-05-21 16:32:50.548986: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:50.549162: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)
2020-05-21 16:32:50.549184: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (gl3167.arc-ts.umich.edu): /proc/driver/nvidia/version does not exist
2020-05-21 16:32:50.549496: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-05-21 16:32:50.556390: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3000000000 Hz
2020-05-21 16:32:50.556480: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5555838bbad0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-05-21 16:32:50.556490: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
/sw/arcts/centos7/python3.6-anaconda/5.2.0/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/array_grad.py:563: _EagerTensorBase.cpu (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.identity instead.
2020-05-21 16:59:03.911090: W tensorflow/python/util/util.cc:319] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1786: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
Test accuracy for step 250: 0.6160309314727783

Test GAP RMS for gender and step 250: 0.13047973811626434

Test GAP RMS for race and step 250: 0.013593987561762333

Test balanced accuracy for step 250: 0.4674545228481293


Test accuracy for step 500: 0.7568822503089905

Test GAP RMS for gender and step 500: 0.0

Test GAP RMS for race and step 500: 0.0

Test balanced accuracy for step 500: 0.5


Test accuracy for step 750: 0.7568822503089905

Test GAP RMS for gender and step 750: 0.0

Test GAP RMS for race and step 750: 0.0

Test balanced accuracy for step 750: 0.5


Test accuracy for step 1000: 0.7608623504638672

Test GAP RMS for gender and step 1000: 0.007324780337512493

Test GAP RMS for race and step 1000: 0.005078336223959923

Test balanced accuracy for step 1000: 0.5081855654716492


Test accuracy for step 1250: 0.7635157704353333

Test GAP RMS for gender and step 1250: 0.026602841913700104

Test GAP RMS for race and step 1250: 0.009091218002140522

Test balanced accuracy for step 1250: 0.5137969255447388


Test accuracy for step 1500: 0.7619679570198059

Test GAP RMS for gender and step 1500: 0.021811962127685547

Test GAP RMS for race and step 1500: 0.004783407784998417

Test balanced accuracy for step 1500: 0.510459303855896


Test accuracy for step 1750: 0.7610834836959839

Test GAP RMS for gender and step 1750: 0.009179680608212948

Test GAP RMS for race and step 1750: 0.00578686036169529

Test balanced accuracy for step 1750: 0.5086402893066406


Test accuracy for step 2000: 0.7624101638793945

Test GAP RMS for gender and step 2000: 0.01249005552381277

Test GAP RMS for race and step 2000: 0.010038002394139767

Test balanced accuracy for step 2000: 0.5113688111305237


Test accuracy for step 2250: 0.766058623790741

Test GAP RMS for gender and step 2250: 0.03918638825416565

Test GAP RMS for race and step 2250: 0.005134178791195154

Test balanced accuracy for step 2250: 0.5188722014427185


Test accuracy for step 2500: 0.7749032378196716

Test GAP RMS for gender and step 2500: 0.04970433935523033

Test GAP RMS for race and step 2500: 0.008926918730139732

Test balanced accuracy for step 2500: 0.5375252962112427


Test accuracy for step 2750: 0.7736871242523193

Test GAP RMS for gender and step 2750: 0.06947856396436691

Test GAP RMS for race and step 2750: 0.00503587955608964

Test balanced accuracy for step 2750: 0.5350241661071777


Test accuracy for step 3000: 0.773576557636261

Test GAP RMS for gender and step 3000: 0.07208307832479477

Test GAP RMS for race and step 3000: 0.00269734556786716

Test balanced accuracy for step 3000: 0.5349511504173279


Test accuracy for step 3250: 0.7705914974212646

Test GAP RMS for gender and step 3250: 0.07255282998085022

Test GAP RMS for race and step 3250: 0.002436301903799176

Test balanced accuracy for step 3250: 0.5285032987594604


Test accuracy for step 3500: 0.7720287442207336

Test GAP RMS for gender and step 3500: 0.09819690138101578

Test GAP RMS for race and step 3500: 0.003806295106187463

Test balanced accuracy for step 3500: 0.5317678451538086


Test accuracy for step 3750: 0.7711442708969116

Test GAP RMS for gender and step 3750: 0.09636327624320984

Test GAP RMS for race and step 3750: 0.01080685667693615

Test balanced accuracy for step 3750: 0.5297945141792297


Test accuracy for step 4000: 0.7687119841575623

Test GAP RMS for gender and step 4000: 0.08675878494977951

Test GAP RMS for race and step 4000: 0.0003420603461563587

Test balanced accuracy for step 4000: 0.5246379375457764


Test accuracy for step 4250: 0.7678275108337402

Test GAP RMS for gender and step 4250: 0.0767330601811409

Test GAP RMS for race and step 4250: 0.010273019783198833

Test balanced accuracy for step 4250: 0.522818922996521


Test accuracy for step 4500: 0.7645107507705688

Test GAP RMS for gender and step 4500: 0.07795365154743195

Test GAP RMS for race and step 4500: 0.005611936096101999

Test balanced accuracy for step 4500: 0.5158432722091675


Test accuracy for step 4750: 0.7627418637275696

Test GAP RMS for gender and step 4750: 0.0735398530960083

Test GAP RMS for race and step 4750: 0.00013519446656573564

Test balanced accuracy for step 4750: 0.5122052431106567


Test accuracy for step 5000: 0.7639579772949219

Test GAP RMS for gender and step 5000: 0.06903276592493057

Test GAP RMS for race and step 5000: 0.004200683906674385

Test balanced accuracy for step 5000: 0.5148607492446899


Test accuracy for step 5250: 0.7627418637275696

Test GAP RMS for gender and step 5250: 0.06274053454399109

Test GAP RMS for race and step 5250: 0.004141451325267553

Test balanced accuracy for step 5250: 0.512359619140625


Test accuracy for step 5500: 0.7609729170799255

Test GAP RMS for gender and step 5500: 0.05088184028863907

Test GAP RMS for race and step 5500: 0.001953146420419216

Test balanced accuracy for step 5500: 0.5085672736167908


Test accuracy for step 5750: 0.7606412172317505

Test GAP RMS for gender and step 5750: 0.04679637774825096

Test GAP RMS for race and step 5750: 0.0008949256152845919

Test balanced accuracy for step 5750: 0.5078850984573364


Test accuracy for step 6000: 0.7603095769882202

Test GAP RMS for gender and step 6000: 0.04308582469820976

Test GAP RMS for race and step 6000: 0.0033070261124521494

Test balanced accuracy for step 6000: 0.5070486664772034


Test accuracy for step 6250: 0.7596462368965149

Test GAP RMS for gender and step 6250: 0.036773521453142166

Test GAP RMS for race and step 6250: 0.005732746794819832

Test balanced accuracy for step 6250: 0.5059930682182312


Test accuracy for step 6500: 0.7597567439079285

Test GAP RMS for gender and step 6500: 0.03937692195177078

Test GAP RMS for race and step 6500: 0.005728830583393574

Test balanced accuracy for step 6500: 0.506066083908081


Test accuracy for step 6750: 0.7590934038162231

Test GAP RMS for gender and step 6750: 0.03158070892095566

Test GAP RMS for race and step 6750: 0.0032476915512233973

Test balanced accuracy for step 6750: 0.5045475363731384


Test accuracy for step 7000: 0.7593145370483398

Test GAP RMS for gender and step 7000: 0.033435605466365814

Test GAP RMS for race and step 7000: 0.00395621545612812

Test balanced accuracy for step 7000: 0.5050022602081299


Test accuracy for step 7250: 0.7592039704322815

Test GAP RMS for gender and step 7250: 0.033811330795288086

Test GAP RMS for race and step 7250: 0.0036019536200910807

Test balanced accuracy for step 7250: 0.5047748684883118


Test accuracy for step 7500: 0.7589828372001648

Test GAP RMS for gender and step 7500: 0.02935008890926838

Test GAP RMS for race and step 7500: 0.002893430180847645

Test balanced accuracy for step 7500: 0.5043201446533203


Test accuracy for step 7750: 0.7579878568649292

Test GAP RMS for gender and step 7750: 0.01709352433681488

Test GAP RMS for race and step 7750: 0.00029492718749679625

Test balanced accuracy for step 7750: 0.5022737383842468


{'epsilon': 0.1, 'lr': 0.0001, 'wlr': 0.0001, 'w_reg': 60.0}
Final test accuracy: 0.7587617635726929
Final test GAP RMS for gender: 0.024888847023248672
Final test GAP RMS for race: 0.002184906043112278
Final test balanced accuracy: 0.5038654208183289


