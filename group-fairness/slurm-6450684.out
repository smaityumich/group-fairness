2020-05-21 16:32:45.144113: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:45.144606: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:45.144617: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2020-05-21 16:32:52.098648: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:52.098818: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)
2020-05-21 16:32:52.098841: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (gl3166.arc-ts.umich.edu): /proc/driver/nvidia/version does not exist
2020-05-21 16:32:52.099246: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-05-21 16:32:52.106197: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3000000000 Hz
2020-05-21 16:32:52.106291: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55805864a510 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-05-21 16:32:52.106301: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
/sw/arcts/centos7/python3.6-anaconda/5.2.0/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/array_grad.py:563: _EagerTensorBase.cpu (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.identity instead.
2020-05-21 16:58:54.802167: W tensorflow/python/util/util.cc:319] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1786: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
Test accuracy for step 250: 0.6191266179084778

Test GAP RMS for gender and step 250: 0.1275821030139923

Test GAP RMS for race and step 250: 0.013344145379960537

Test balanced accuracy for step 250: 0.4756731390953064


Test accuracy for step 500: 0.8338308334350586

Test GAP RMS for gender and step 500: 0.3414194881916046

Test GAP RMS for race and step 500: 0.07757822424173355

Test balanced accuracy for step 500: 0.7471539974212646


Test accuracy for step 750: 0.8437811136245728

Test GAP RMS for gender and step 750: 0.2614765167236328

Test GAP RMS for race and step 750: 0.07268527895212173

Test balanced accuracy for step 750: 0.765148401260376


Test accuracy for step 1000: 0.8448866605758667

Test GAP RMS for gender and step 1000: 0.2203403264284134

Test GAP RMS for race and step 1000: 0.04992906004190445

Test balanced accuracy for step 1000: 0.7522968053817749


Test accuracy for step 1250: 0.8465450406074524

Test GAP RMS for gender and step 1250: 0.20020438730716705

Test GAP RMS for race and step 1250: 0.04357842355966568

Test balanced accuracy for step 1250: 0.7507685422897339


Test accuracy for step 1500: 0.8476506471633911

Test GAP RMS for gender and step 1500: 0.1862257868051529

Test GAP RMS for race and step 1500: 0.04000570625066757

Test balanced accuracy for step 1500: 0.7502641677856445


Test accuracy for step 1750: 0.8479822874069214

Test GAP RMS for gender and step 1750: 0.18350602686405182

Test GAP RMS for race and step 1750: 0.04190152883529663

Test balanced accuracy for step 1750: 0.7475507855415344


Test accuracy for step 2000: 0.8478717803955078

Test GAP RMS for gender and step 2000: 0.17642591893672943

Test GAP RMS for race and step 2000: 0.043491847813129425

Test balanced accuracy for step 2000: 0.7419214844703674


Test accuracy for step 2250: 0.8451077938079834

Test GAP RMS for gender and step 2250: 0.1745607554912567

Test GAP RMS for race and step 2250: 0.04373563826084137

Test balanced accuracy for step 2250: 0.7263592481613159


Test accuracy for step 2500: 0.8444444537162781

Test GAP RMS for gender and step 2500: 0.166795551776886

Test GAP RMS for race and step 2500: 0.04045572876930237

Test balanced accuracy for step 2500: 0.7229886054992676


Test accuracy for step 2750: 0.844997227191925

Test GAP RMS for gender and step 2750: 0.16618964076042175

Test GAP RMS for race and step 2750: 0.03505018725991249

Test balanced accuracy for step 2750: 0.7241255044937134


Test accuracy for step 3000: 0.8415699005126953

Test GAP RMS for gender and step 3000: 0.16475185751914978

Test GAP RMS for race and step 3000: 0.023655977100133896

Test balanced accuracy for step 3000: 0.7119835615158081


Test accuracy for step 3250: 0.8395798802375793

Test GAP RMS for gender and step 3250: 0.14140291512012482

Test GAP RMS for race and step 3250: 0.015124266967177391

Test balanced accuracy for step 3250: 0.7014085054397583


Test accuracy for step 3500: 0.8396904468536377

Test GAP RMS for gender and step 3500: 0.12606997787952423

Test GAP RMS for race and step 3500: 0.018334416672587395

Test balanced accuracy for step 3500: 0.6985490322113037


Test accuracy for step 3750: 0.8390271067619324

Test GAP RMS for gender and step 3750: 0.12159242480993271

Test GAP RMS for race and step 3750: 0.018746865913271904

Test balanced accuracy for step 3750: 0.6953327059745789


Test accuracy for step 4000: 0.8322830200195312

Test GAP RMS for gender and step 4000: 0.13355514407157898

Test GAP RMS for race and step 4000: 0.006611595395952463

Test balanced accuracy for step 4000: 0.6748261451721191


Test accuracy for step 4250: 0.8312879800796509

Test GAP RMS for gender and step 4250: 0.13181884586811066

Test GAP RMS for race and step 4250: 0.011895735748112202

Test balanced accuracy for step 4250: 0.6713906526565552


Test accuracy for step 4500: 0.8241016864776611

Test GAP RMS for gender and step 4500: 0.11111288517713547

Test GAP RMS for race and step 4500: 0.010759212076663971

Test balanced accuracy for step 4500: 0.6518266201019287


Test accuracy for step 4750: 0.8270868062973022

Test GAP RMS for gender and step 4750: 0.10864873230457306

Test GAP RMS for race and step 4750: 0.010145869106054306

Test balanced accuracy for step 4750: 0.6592005491256714


Test accuracy for step 5000: 0.8226644396781921

Test GAP RMS for gender and step 5000: 0.10144731402397156

Test GAP RMS for race and step 5000: 0.0051604812033474445

Test balanced accuracy for step 5000: 0.6459382772445679


Test accuracy for step 5250: 0.8208954930305481

Test GAP RMS for gender and step 5250: 0.09043067693710327

Test GAP RMS for race and step 5250: 0.010069268755614758

Test balanced accuracy for step 5250: 0.6402938365936279


Test accuracy for step 5500: 0.8161414861679077

Test GAP RMS for gender and step 5500: 0.07079581916332245

Test GAP RMS for race and step 5500: 0.01852363906800747

Test balanced accuracy for step 5500: 0.6291276216506958


Test accuracy for step 5750: 0.813045859336853

Test GAP RMS for gender and step 5750: 0.06541839241981506

Test GAP RMS for race and step 5750: 0.017634615302085876

Test balanced accuracy for step 5750: 0.6216806769371033


Test accuracy for step 6000: 0.8134881258010864

Test GAP RMS for gender and step 6000: 0.06509926915168762

Test GAP RMS for race and step 6000: 0.015942098572850227

Test balanced accuracy for step 6000: 0.6228988766670227


Test accuracy for step 6250: 0.805527925491333

Test GAP RMS for gender and step 6250: 0.041533518582582474

Test GAP RMS for race and step 6250: 0.010960749350488186

Test balanced accuracy for step 6250: 0.6037496328353882


Test accuracy for step 6500: 0.8053067922592163

Test GAP RMS for gender and step 6500: 0.04183850437402725

Test GAP RMS for race and step 6500: 0.008793615736067295

Test balanced accuracy for step 6500: 0.6026775240898132


Test accuracy for step 6750: 0.7991155385971069

Test GAP RMS for gender and step 6750: 0.021127836778759956

Test GAP RMS for race and step 6750: 0.0021406200248748064

Test balanced accuracy for step 6750: 0.5890184640884399


Test accuracy for step 7000: 0.8006633520126343

Test GAP RMS for gender and step 7000: 0.031966667622327805

Test GAP RMS for race and step 7000: 0.0074545843526721

Test balanced accuracy for step 7000: 0.5923560261726379


Test accuracy for step 7250: 0.7893863916397095

Test GAP RMS for gender and step 7250: 0.004729662090539932

Test GAP RMS for race and step 7250: 0.006084141321480274

Test balanced accuracy for step 7250: 0.5673115849494934


Test accuracy for step 7500: 0.7869541049003601

Test GAP RMS for gender and step 7500: 0.0013037947937846184

Test GAP RMS for race and step 7500: 0.010386421345174313

Test balanced accuracy for step 7500: 0.56215500831604


Test accuracy for step 7750: 0.7888336181640625

Test GAP RMS for gender and step 7750: 0.004753684625029564

Test GAP RMS for race and step 7750: 0.006076108198612928

Test balanced accuracy for step 7750: 0.5669464468955994


{'epsilon': 0.1, 'lr': 0.0001, 'wlr': 1e-06, 'w_reg': 50.0}
Final test accuracy: 0.7848535180091858
Final test GAP RMS for gender: 0.0020091687329113483
Final test GAP RMS for race: 0.01327921636402607
Final test balanced accuracy: 0.5578348636627197


