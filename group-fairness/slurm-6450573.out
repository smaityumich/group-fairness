2020-05-21 16:32:42.219399: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:42.220031: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:42.220050: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2020-05-21 16:32:48.354119: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:48.356066: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)
2020-05-21 16:32:48.357953: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (gl3254.arc-ts.umich.edu): /proc/driver/nvidia/version does not exist
2020-05-21 16:32:48.374172: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-05-21 16:32:48.407182: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3000000000 Hz
2020-05-21 16:32:48.407314: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55724741ccd0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-05-21 16:32:48.407328: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
/sw/arcts/centos7/python3.6-anaconda/5.2.0/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/array_grad.py:563: _EagerTensorBase.cpu (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.identity instead.
2020-05-21 17:00:19.957455: W tensorflow/python/util/util.cc:319] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1786: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
Test accuracy for step 250: 0.616252064704895

Test GAP RMS for gender and step 250: 0.12770846486091614

Test GAP RMS for race and step 250: 0.01619097962975502

Test balanced accuracy for step 250: 0.4838063716888428


Test accuracy for step 500: 0.7953565716743469

Test GAP RMS for gender and step 500: 0.23991574347019196

Test GAP RMS for race and step 500: 0.07432663440704346

Test balanced accuracy for step 500: 0.8135704398155212


Test accuracy for step 750: 0.8007739186286926

Test GAP RMS for gender and step 750: 0.16434518992900848

Test GAP RMS for race and step 750: 0.0672697201371193

Test balanced accuracy for step 750: 0.8240945339202881


Test accuracy for step 1000: 0.8093974590301514

Test GAP RMS for gender and step 1000: 0.1474425196647644

Test GAP RMS for race and step 1000: 0.05913572758436203

Test balanced accuracy for step 1000: 0.8239263296127319


Test accuracy for step 1250: 0.8095080256462097

Test GAP RMS for gender and step 1250: 0.13512124121189117

Test GAP RMS for race and step 1250: 0.058811113238334656

Test balanced accuracy for step 1250: 0.824925422668457


Test accuracy for step 1500: 0.8085129857063293

Test GAP RMS for gender and step 1500: 0.12437422573566437

Test GAP RMS for race and step 1500: 0.056424129754304886

Test balanced accuracy for step 1500: 0.8250397443771362


Test accuracy for step 1750: 0.807296872138977

Test GAP RMS for gender and step 1750: 0.13248255848884583

Test GAP RMS for race and step 1750: 0.058380529284477234

Test balanced accuracy for step 1750: 0.825625479221344


Test accuracy for step 2000: 0.8074073791503906

Test GAP RMS for gender and step 2000: 0.12766584753990173

Test GAP RMS for race and step 2000: 0.06116840988397598

Test balanced accuracy for step 2000: 0.8250811100006104


Test accuracy for step 2250: 0.8119403123855591

Test GAP RMS for gender and step 2250: 0.12092059850692749

Test GAP RMS for race and step 2250: 0.05712607130408287

Test balanced accuracy for step 2250: 0.8243714570999146


Test accuracy for step 2500: 0.8117191791534424

Test GAP RMS for gender and step 2500: 0.10754238814115524

Test GAP RMS for race and step 2500: 0.05366414412856102

Test balanced accuracy for step 2500: 0.8243796825408936


Test accuracy for step 2750: 0.806633472442627

Test GAP RMS for gender and step 2750: 0.11715949326753616

Test GAP RMS for race and step 2750: 0.05446520075201988

Test balanced accuracy for step 2750: 0.8271936774253845


Test accuracy for step 3000: 0.8127142190933228

Test GAP RMS for gender and step 3000: 0.11630403995513916

Test GAP RMS for race and step 3000: 0.056423369795084

Test balanced accuracy for step 3000: 0.8268890976905823


Test accuracy for step 3250: 0.8126036524772644

Test GAP RMS for gender and step 3250: 0.10869403928518295

Test GAP RMS for race and step 3250: 0.055783193558454514

Test balanced accuracy for step 3250: 0.8249639272689819


Test accuracy for step 3500: 0.8132669925689697

Test GAP RMS for gender and step 3500: 0.10107822716236115

Test GAP RMS for race and step 3500: 0.056726861745119095

Test balanced accuracy for step 3500: 0.8247848153114319


Test accuracy for step 3750: 0.8127142190933228

Test GAP RMS for gender and step 3750: 0.09942609071731567

Test GAP RMS for race and step 3750: 0.056648194789886475

Test balanced accuracy for step 3750: 0.8238022327423096


Test accuracy for step 4000: 0.8216694593429565

Test GAP RMS for gender and step 4000: 0.09624513238668442

Test GAP RMS for race and step 4000: 0.05799650773406029

Test balanced accuracy for step 4000: 0.8249335885047913


Test accuracy for step 4250: 0.8177998661994934

Test GAP RMS for gender and step 4250: 0.09967789053916931

Test GAP RMS for race and step 4250: 0.059644993394613266

Test balanced accuracy for step 4250: 0.825464129447937


Test accuracy for step 4500: 0.8235489130020142

Test GAP RMS for gender and step 4500: 0.08806048333644867

Test GAP RMS for race and step 4500: 0.0515427403151989

Test balanced accuracy for step 4500: 0.8213906288146973


Test accuracy for step 4750: 0.8144831657409668

Test GAP RMS for gender and step 4750: 0.09084761887788773

Test GAP RMS for race and step 4750: 0.057229816913604736

Test balanced accuracy for step 4750: 0.8237361311912537


Test accuracy for step 5000: 0.8207849860191345

Test GAP RMS for gender and step 5000: 0.09001479297876358

Test GAP RMS for race and step 5000: 0.05691838264465332

Test balanced accuracy for step 5000: 0.8243492841720581


Test accuracy for step 5250: 0.8210060596466064

Test GAP RMS for gender and step 5250: 0.09120754897594452

Test GAP RMS for race and step 5250: 0.053288575261831284

Test balanced accuracy for step 5250: 0.8224889039993286


Test accuracy for step 5500: 0.8210060596466064

Test GAP RMS for gender and step 5500: 0.08629320561885834

Test GAP RMS for race and step 5500: 0.05282491445541382

Test balanced accuracy for step 5500: 0.8226432800292969


Test accuracy for step 5750: 0.8163626194000244

Test GAP RMS for gender and step 5750: 0.08582650125026703

Test GAP RMS for race and step 5750: 0.05582503601908684

Test balanced accuracy for step 5750: 0.8229712247848511


Test accuracy for step 6000: 0.8154781460762024

Test GAP RMS for gender and step 6000: 0.09192982316017151

Test GAP RMS for race and step 6000: 0.05428849160671234

Test balanced accuracy for step 6000: 0.8222326636314392


Test accuracy for step 6250: 0.8158098459243774

Test GAP RMS for gender and step 6250: 0.09685122221708298

Test GAP RMS for race and step 6250: 0.05254097282886505

Test balanced accuracy for step 6250: 0.823840856552124


Test accuracy for step 6500: 0.8151465058326721

Test GAP RMS for gender and step 6500: 0.09380723536014557

Test GAP RMS for race and step 6500: 0.05383893474936485

Test balanced accuracy for step 6500: 0.8227852582931519


Test accuracy for step 6750: 0.8211166262626648

Test GAP RMS for gender and step 6750: 0.0819157138466835

Test GAP RMS for race and step 6750: 0.05127197131514549

Test balanced accuracy for step 6750: 0.8163883686065674


Test accuracy for step 7000: 0.8177998661994934

Test GAP RMS for gender and step 7000: 0.08847172558307648

Test GAP RMS for race and step 7000: 0.049817685037851334

Test balanced accuracy for step 7000: 0.8223773241043091


Test accuracy for step 7250: 0.8203427195549011

Test GAP RMS for gender and step 7250: 0.09117331355810165

Test GAP RMS for race and step 7250: 0.05011003836989403

Test balanced accuracy for step 7250: 0.8218963742256165


Test accuracy for step 7500: 0.8199005126953125

Test GAP RMS for gender and step 7500: 0.09346417337656021

Test GAP RMS for race and step 7500: 0.05080520734190941

Test balanced accuracy for step 7500: 0.8220672607421875


Test accuracy for step 7750: 0.8193476796150208

Test GAP RMS for gender and step 7750: 0.08764711022377014

Test GAP RMS for race and step 7750: 0.05124531686306

Test balanced accuracy for step 7750: 0.819849967956543


{'epsilon': 1e-05, 'lr': 0.0001, 'wlr': 0.0001, 'w_reg': 10.0}
Final test accuracy: 0.8168048858642578
Final test GAP RMS for gender: 0.08584127575159073
Final test GAP RMS for race: 0.05092332884669304
Final test balanced accuracy: 0.8206396102905273


