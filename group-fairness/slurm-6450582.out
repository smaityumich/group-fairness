2020-05-21 16:32:42.219410: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:42.220025: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:42.220037: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2020-05-21 16:32:48.357478: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:48.358037: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)
2020-05-21 16:32:48.358063: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (gl3254.arc-ts.umich.edu): /proc/driver/nvidia/version does not exist
2020-05-21 16:32:48.374157: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-05-21 16:32:48.407172: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3000000000 Hz
2020-05-21 16:32:48.407301: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x56137f897640 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-05-21 16:32:48.407314: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
/sw/arcts/centos7/python3.6-anaconda/5.2.0/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/array_grad.py:563: _EagerTensorBase.cpu (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.identity instead.
2020-05-21 16:59:42.839001: W tensorflow/python/util/util.cc:319] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1786: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
Test accuracy for step 250: 0.6172471046447754

Test GAP RMS for gender and step 250: 0.12812075018882751

Test GAP RMS for race and step 250: 0.018507419154047966

Test balanced accuracy for step 250: 0.4823029041290283


Test accuracy for step 500: 0.8063018321990967

Test GAP RMS for gender and step 500: 0.2708418071269989

Test GAP RMS for race and step 500: 0.0755104273557663

Test balanced accuracy for step 500: 0.8086080551147461


Test accuracy for step 750: 0.813930332660675

Test GAP RMS for gender and step 750: 0.20640727877616882

Test GAP RMS for race and step 750: 0.059819020330905914

Test balanced accuracy for step 750: 0.8178147077560425


Test accuracy for step 1000: 0.8224433660507202

Test GAP RMS for gender and step 1000: 0.19291549921035767

Test GAP RMS for race and step 1000: 0.05887272208929062

Test balanced accuracy for step 1000: 0.816956102848053


Test accuracy for step 1250: 0.8234383463859558

Test GAP RMS for gender and step 1250: 0.18557016551494598

Test GAP RMS for race and step 1250: 0.056276410818099976

Test balanced accuracy for step 1250: 0.8197741508483887


Test accuracy for step 1500: 0.8210060596466064

Test GAP RMS for gender and step 1500: 0.16757142543792725

Test GAP RMS for race and step 1500: 0.060873471200466156

Test balanced accuracy for step 1500: 0.8240323066711426


Test accuracy for step 1750: 0.8193476796150208

Test GAP RMS for gender and step 1750: 0.17657454311847687

Test GAP RMS for race and step 1750: 0.05913048982620239

Test balanced accuracy for step 1750: 0.8249431848526001


Test accuracy for step 2000: 0.8160309791564941

Test GAP RMS for gender and step 2000: 0.17327608168125153

Test GAP RMS for race and step 2000: 0.06573748588562012

Test balanced accuracy for step 2000: 0.824449896812439


Test accuracy for step 2250: 0.8197899460792542

Test GAP RMS for gender and step 2250: 0.17546363174915314

Test GAP RMS for race and step 2250: 0.05852724611759186

Test balanced accuracy for step 2250: 0.8223029375076294


Test accuracy for step 2500: 0.8213377594947815

Test GAP RMS for gender and step 2500: 0.15646345913410187

Test GAP RMS for race and step 2500: 0.05777323618531227

Test balanced accuracy for step 2500: 0.8265665769577026


Test accuracy for step 2750: 0.8163626194000244

Test GAP RMS for gender and step 2750: 0.16371765732765198

Test GAP RMS for race and step 2750: 0.06385572999715805

Test balanced accuracy for step 2750: 0.828527569770813


Test accuracy for step 3000: 0.8170259594917297

Test GAP RMS for gender and step 3000: 0.17128242552280426

Test GAP RMS for race and step 3000: 0.061032459139823914

Test balanced accuracy for step 3000: 0.8266506195068359


Test accuracy for step 3250: 0.8176893591880798

Test GAP RMS for gender and step 3250: 0.16508083045482635

Test GAP RMS for race and step 3250: 0.05970469117164612

Test balanced accuracy for step 3250: 0.8266258239746094


Test accuracy for step 3500: 0.8182421326637268

Test GAP RMS for gender and step 3500: 0.15726979076862335

Test GAP RMS for race and step 3500: 0.06082543358206749

Test balanced accuracy for step 3500: 0.8288431167602539


Test accuracy for step 3750: 0.8156992793083191

Test GAP RMS for gender and step 3750: 0.1575814038515091

Test GAP RMS for race and step 3750: 0.06471528857946396

Test balanced accuracy for step 3750: 0.8274719715118408


Test accuracy for step 4000: 0.8212271928787231

Test GAP RMS for gender and step 4000: 0.16093580424785614

Test GAP RMS for race and step 4000: 0.05752865970134735

Test balanced accuracy for step 4000: 0.826493501663208


Test accuracy for step 4250: 0.8179104328155518

Test GAP RMS for gender and step 4250: 0.16274122893810272

Test GAP RMS for race and step 4250: 0.06275292485952377

Test balanced accuracy for step 4250: 0.8293956518173218


Test accuracy for step 4500: 0.8232172727584839

Test GAP RMS for gender and step 4500: 0.1503523737192154

Test GAP RMS for race and step 4500: 0.05865933746099472

Test balanced accuracy for step 4500: 0.8268821239471436


Test accuracy for step 4750: 0.8164731860160828

Test GAP RMS for gender and step 4750: 0.15304285287857056

Test GAP RMS for race and step 4750: 0.06380622833967209

Test balanced accuracy for step 4750: 0.8292179107666016


Test accuracy for step 5000: 0.8206744194030762

Test GAP RMS for gender and step 5000: 0.15314874053001404

Test GAP RMS for race and step 5000: 0.06040950492024422

Test balanced accuracy for step 5000: 0.8298325538635254


Test accuracy for step 5250: 0.8181315660476685

Test GAP RMS for gender and step 5250: 0.15457715094089508

Test GAP RMS for race and step 5250: 0.06451749056577682

Test balanced accuracy for step 5250: 0.8296961188316345


Test accuracy for step 5500: 0.8206744194030762

Test GAP RMS for gender and step 5500: 0.14592109620571136

Test GAP RMS for race and step 5500: 0.06375645846128464

Test balanced accuracy for step 5500: 0.8298325538635254


Test accuracy for step 5750: 0.8175787925720215

Test GAP RMS for gender and step 5750: 0.13894668221473694

Test GAP RMS for race and step 5750: 0.06524821370840073

Test balanced accuracy for step 5750: 0.8296396732330322


Test accuracy for step 6000: 0.8147042393684387

Test GAP RMS for gender and step 6000: 0.150937020778656

Test GAP RMS for race and step 6000: 0.06619583815336227

Test balanced accuracy for step 6000: 0.8291298151016235


Test accuracy for step 6250: 0.8142620325088501

Test GAP RMS for gender and step 6250: 0.15487460792064667

Test GAP RMS for race and step 6250: 0.07046622782945633

Test balanced accuracy for step 6250: 0.8279116153717041


Test accuracy for step 6500: 0.8134881258010864

Test GAP RMS for gender and step 6500: 0.14978666603565216

Test GAP RMS for race and step 6500: 0.06787436455488205

Test balanced accuracy for step 6500: 0.8274003267288208


Test accuracy for step 6750: 0.8223327994346619

Test GAP RMS for gender and step 6750: 0.13274572789669037

Test GAP RMS for race and step 6750: 0.06415660679340363

Test balanced accuracy for step 6750: 0.8295390009880066


Test accuracy for step 7000: 0.8177998661994934

Test GAP RMS for gender and step 7000: 0.14020706713199615

Test GAP RMS for race and step 7000: 0.0658470019698143

Test balanced accuracy for step 7000: 0.8304030299186707


Test accuracy for step 7250: 0.8181315660476685

Test GAP RMS for gender and step 7250: 0.14327271282672882

Test GAP RMS for race and step 7250: 0.06516261398792267

Test balanced accuracy for step 7250: 0.828307032585144


Test accuracy for step 7500: 0.8182421326637268

Test GAP RMS for gender and step 7500: 0.14698876440525055

Test GAP RMS for race and step 7500: 0.06469635665416718

Test balanced accuracy for step 7500: 0.8277627229690552


Test accuracy for step 7750: 0.8191266059875488

Test GAP RMS for gender and step 7750: 0.1303672045469284

Test GAP RMS for race and step 7750: 0.06335818022489548

Test balanced accuracy for step 7750: 0.8298903703689575


{'epsilon': 0.0001, 'lr': 0.0001, 'wlr': 5e-06, 'w_reg': 10.0}
Final test accuracy: 0.8168048858642578
Final test GAP RMS for gender: 0.12596437335014343
Final test GAP RMS for race: 0.06468289345502853
Final test balanced accuracy: 0.8280479907989502


