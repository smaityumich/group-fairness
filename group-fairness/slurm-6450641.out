2020-05-21 16:32:43.113583: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:43.113678: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:43.113688: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2020-05-21 16:32:52.971688: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:52.972120: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)
2020-05-21 16:32:52.972162: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (gl3108.arc-ts.umich.edu): /proc/driver/nvidia/version does not exist
2020-05-21 16:32:52.972723: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-05-21 16:32:52.981144: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3000000000 Hz
2020-05-21 16:32:52.981291: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55783b193ba0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-05-21 16:32:52.981304: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
/sw/arcts/centos7/python3.6-anaconda/5.2.0/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/array_grad.py:563: _EagerTensorBase.cpu (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.identity instead.
2020-05-21 16:59:08.690102: W tensorflow/python/util/util.cc:319] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1786: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
Test accuracy for step 250: 0.6166943311691284

Test GAP RMS for gender and step 250: 0.12814408540725708

Test GAP RMS for race and step 250: 0.016897743567824364

Test balanced accuracy for step 250: 0.4839441776275635


Test accuracy for step 500: 0.8283029198646545

Test GAP RMS for gender and step 500: 0.10419009625911713

Test GAP RMS for race and step 500: 0.048642005771398544

Test balanced accuracy for step 500: 0.7975214719772339


Test accuracy for step 750: 0.8334991931915283

Test GAP RMS for gender and step 750: 0.05990224331617355

Test GAP RMS for race and step 750: 0.04854079708456993

Test balanced accuracy for step 750: 0.7994107604026794


Test accuracy for step 1000: 0.8369264602661133

Test GAP RMS for gender and step 1000: 0.06764067709445953

Test GAP RMS for race and step 1000: 0.03710097819566727

Test balanced accuracy for step 1000: 0.7927230596542358


Test accuracy for step 1250: 0.8364842534065247

Test GAP RMS for gender and step 1250: 0.07485213130712509

Test GAP RMS for race and step 1250: 0.03997034579515457

Test balanced accuracy for step 1250: 0.7973698377609253


Test accuracy for step 1500: 0.8347153067588806

Test GAP RMS for gender and step 1500: 0.07958242297172546

Test GAP RMS for race and step 1500: 0.03744298219680786

Test balanced accuracy for step 1500: 0.8002141714096069


Test accuracy for step 1750: 0.8336097002029419

Test GAP RMS for gender and step 1750: 0.07781044393777847

Test GAP RMS for race and step 1750: 0.039492033421993256

Test balanced accuracy for step 1750: 0.7985577583312988


Test accuracy for step 2000: 0.8341625332832336

Test GAP RMS for gender and step 2000: 0.08567003905773163

Test GAP RMS for race and step 2000: 0.037019990384578705

Test balanced accuracy for step 2000: 0.7993859648704529


Test accuracy for step 2250: 0.8353786468505859

Test GAP RMS for gender and step 2250: 0.08882193267345428

Test GAP RMS for race and step 2250: 0.0331140011548996

Test balanced accuracy for step 2250: 0.7980285882949829


Test accuracy for step 2500: 0.832504153251648

Test GAP RMS for gender and step 2500: 0.08634519577026367

Test GAP RMS for race and step 2500: 0.042078450322151184

Test balanced accuracy for step 2500: 0.7992164492607117


Test accuracy for step 2750: 0.8313985466957092

Test GAP RMS for gender and step 2750: 0.08567336201667786

Test GAP RMS for race and step 2750: 0.045335616916418076

Test balanced accuracy for step 2750: 0.7998751401901245


Test accuracy for step 3000: 0.8327252864837646

Test GAP RMS for gender and step 3000: 0.08563806116580963

Test GAP RMS for race and step 3000: 0.043517738580703735

Test balanced accuracy for step 3000: 0.8001342415809631


Test accuracy for step 3250: 0.835710346698761

Test GAP RMS for gender and step 3250: 0.09370331466197968

Test GAP RMS for race and step 3250: 0.039355065673589706

Test balanced accuracy for step 3250: 0.7984020113945007


Test accuracy for step 3500: 0.8305140733718872

Test GAP RMS for gender and step 3500: 0.0875406265258789

Test GAP RMS for race and step 3500: 0.04423835873603821

Test balanced accuracy for step 3500: 0.7989822030067444


Test accuracy for step 3750: 0.8302929997444153

Test GAP RMS for gender and step 3750: 0.08728011697530746

Test GAP RMS for race and step 3750: 0.04885779693722725

Test balanced accuracy for step 3750: 0.7991448640823364


Test accuracy for step 4000: 0.8355997800827026

Test GAP RMS for gender and step 4000: 0.09225495904684067

Test GAP RMS for race and step 4000: 0.04113984853029251

Test balanced accuracy for step 4000: 0.7997180223464966


Test accuracy for step 4250: 0.8354892134666443

Test GAP RMS for gender and step 4250: 0.09562675654888153

Test GAP RMS for race and step 4250: 0.04400879889726639

Test balanced accuracy for step 4250: 0.7959408164024353


Test accuracy for step 4500: 0.8363736867904663

Test GAP RMS for gender and step 4500: 0.10160229355096817

Test GAP RMS for race and step 4500: 0.0389954037964344

Test balanced accuracy for step 4500: 0.7945187091827393


Test accuracy for step 4750: 0.8322830200195312

Test GAP RMS for gender and step 4750: 0.0914730355143547

Test GAP RMS for race and step 4750: 0.045929308980703354

Test balanced accuracy for step 4750: 0.797063946723938


Test accuracy for step 5000: 0.8320618867874146

Test GAP RMS for gender and step 5000: 0.0943988636136055

Test GAP RMS for race and step 5000: 0.041664108633995056

Test balanced accuracy for step 5000: 0.7961461544036865


Test accuracy for step 5250: 0.8328357934951782

Test GAP RMS for gender and step 5250: 0.0951433926820755

Test GAP RMS for race and step 5250: 0.04360121488571167

Test balanced accuracy for step 5250: 0.7961944341659546


Test accuracy for step 5500: 0.8323935866355896

Test GAP RMS for gender and step 5500: 0.0914422944188118

Test GAP RMS for race and step 5500: 0.04291126877069473

Test balanced accuracy for step 5500: 0.7965196371078491


Test accuracy for step 5750: 0.8289662599563599

Test GAP RMS for gender and step 5750: 0.09709127247333527

Test GAP RMS for race and step 5750: 0.04114684835076332

Test balanced accuracy for step 5750: 0.7995031476020813


Test accuracy for step 6000: 0.8274184465408325

Test GAP RMS for gender and step 6000: 0.09032773971557617

Test GAP RMS for race and step 6000: 0.04303164780139923

Test balanced accuracy for step 6000: 0.7994066476821899


Test accuracy for step 6250: 0.8266445398330688

Test GAP RMS for gender and step 6250: 0.0905986949801445

Test GAP RMS for race and step 6250: 0.039795175194740295

Test balanced accuracy for step 6250: 0.795962929725647


Test accuracy for step 6500: 0.8250967264175415

Test GAP RMS for gender and step 6500: 0.09079873561859131

Test GAP RMS for race and step 6500: 0.03956323489546776

Test balanced accuracy for step 6500: 0.7983359098434448


Test accuracy for step 6750: 0.8302929997444153

Test GAP RMS for gender and step 6750: 0.10176936537027359

Test GAP RMS for race and step 6750: 0.04500683397054672

Test balanced accuracy for step 6750: 0.7955949902534485


Test accuracy for step 7000: 0.8267551064491272

Test GAP RMS for gender and step 7000: 0.0990615263581276

Test GAP RMS for race and step 7000: 0.03824162110686302

Test balanced accuracy for step 7000: 0.7983511090278625


Test accuracy for step 7250: 0.8289662599563599

Test GAP RMS for gender and step 7250: 0.09223950654268265

Test GAP RMS for race and step 7250: 0.03853491693735123

Test balanced accuracy for step 7250: 0.7964162826538086


Test accuracy for step 7500: 0.8275290131568909

Test GAP RMS for gender and step 7500: 0.09058204293251038

Test GAP RMS for race and step 7500: 0.036202572286129

Test balanced accuracy for step 7500: 0.7965472340583801


Test accuracy for step 7750: 0.8270868062973022

Test GAP RMS for gender and step 7750: 0.095060333609581

Test GAP RMS for race and step 7750: 0.03960281237959862

Test balanced accuracy for step 7750: 0.7982615232467651


{'epsilon': 0.001, 'lr': 0.0001, 'wlr': 0.001, 'w_reg': 40.0}
Final test accuracy: 0.8274184465408325
Final test GAP RMS for gender: 0.0983448326587677
Final test GAP RMS for race: 0.03645613044500351
Final test balanced accuracy: 0.7989436388015747


