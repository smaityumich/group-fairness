2020-05-21 16:32:41.398715: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:41.400984: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:41.401010: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2020-05-21 16:32:47.020757: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:47.022027: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)
2020-05-21 16:32:47.022062: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (gl3156.arc-ts.umich.edu): /proc/driver/nvidia/version does not exist
2020-05-21 16:32:47.022418: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-05-21 16:32:47.029476: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3000000000 Hz
2020-05-21 16:32:47.029592: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x56129571f7a0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-05-21 16:32:47.029602: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
/sw/arcts/centos7/python3.6-anaconda/5.2.0/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/array_grad.py:563: _EagerTensorBase.cpu (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.identity instead.
2020-05-21 17:00:05.580181: W tensorflow/python/util/util.cc:319] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1786: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
Test accuracy for step 250: 0.6151465177536011

Test GAP RMS for gender and step 250: 0.12854954600334167

Test GAP RMS for race and step 250: 0.019789906218647957

Test balanced accuracy for step 250: 0.48431074619293213


Test accuracy for step 500: 0.8127142190933228

Test GAP RMS for gender and step 500: 0.1360444575548172

Test GAP RMS for race and step 500: 0.052178755402565

Test balanced accuracy for step 500: 0.8123810291290283


Test accuracy for step 750: 0.8144831657409668

Test GAP RMS for gender and step 750: 0.08215507864952087

Test GAP RMS for race and step 750: 0.04926545172929764

Test balanced accuracy for step 750: 0.8133952617645264


Test accuracy for step 1000: 0.8276395797729492

Test GAP RMS for gender and step 1000: 0.06701871752738953

Test GAP RMS for race and step 1000: 0.052898552268743515

Test balanced accuracy for step 1000: 0.8120543360710144


Test accuracy for step 1250: 0.8237700462341309

Test GAP RMS for gender and step 1250: 0.07195530831813812

Test GAP RMS for race and step 1250: 0.052046455442905426

Test balanced accuracy for step 1250: 0.8119674921035767


Test accuracy for step 1500: 0.8193476796150208

Test GAP RMS for gender and step 1500: 0.07537664473056793

Test GAP RMS for race and step 1500: 0.04840710759162903

Test balanced accuracy for step 1500: 0.8121329545974731


Test accuracy for step 1750: 0.8199005126953125

Test GAP RMS for gender and step 1750: 0.07813204824924469

Test GAP RMS for race and step 1750: 0.050357986241579056

Test balanced accuracy for step 1750: 0.8152762651443481


Test accuracy for step 2000: 0.8203427195549011

Test GAP RMS for gender and step 2000: 0.07876922190189362

Test GAP RMS for race and step 2000: 0.050644781440496445

Test balanced accuracy for step 2000: 0.8154140710830688


Test accuracy for step 2250: 0.8232172727584839

Test GAP RMS for gender and step 2250: 0.07525241374969482

Test GAP RMS for race and step 2250: 0.050987981259822845

Test balanced accuracy for step 2250: 0.8080525398254395


Test accuracy for step 2500: 0.8197899460792542

Test GAP RMS for gender and step 2500: 0.07621263712644577

Test GAP RMS for race and step 2500: 0.049275994300842285

Test balanced accuracy for step 2500: 0.8124251365661621


Test accuracy for step 2750: 0.8152570724487305

Test GAP RMS for gender and step 2750: 0.07379994541406631

Test GAP RMS for race and step 2750: 0.05195760726928711

Test balanced accuracy for step 2750: 0.8139065504074097


Test accuracy for step 3000: 0.8216694593429565

Test GAP RMS for gender and step 3000: 0.07702904939651489

Test GAP RMS for race and step 3000: 0.05279965698719025

Test balanced accuracy for step 3000: 0.8156731128692627


Test accuracy for step 3250: 0.8232172727584839

Test GAP RMS for gender and step 3250: 0.07904604077339172

Test GAP RMS for race and step 3250: 0.04707622528076172

Test balanced accuracy for step 3250: 0.8119110465049744


Test accuracy for step 3500: 0.8176893591880798

Test GAP RMS for gender and step 3500: 0.08218560367822647

Test GAP RMS for race and step 3500: 0.049130991101264954

Test balanced accuracy for step 3500: 0.810111403465271


Test accuracy for step 3750: 0.8185737729072571

Test GAP RMS for gender and step 3750: 0.07944247871637344

Test GAP RMS for race and step 3750: 0.04792061820626259

Test balanced accuracy for step 3750: 0.8100782632827759


Test accuracy for step 4000: 0.8236594796180725

Test GAP RMS for gender and step 4000: 0.07862287759780884

Test GAP RMS for race and step 4000: 0.04800117760896683

Test balanced accuracy for step 4000: 0.8080359697341919


Test accuracy for step 4250: 0.8239911794662476

Test GAP RMS for gender and step 4250: 0.07750445604324341

Test GAP RMS for race and step 4250: 0.049898985773324966

Test balanced accuracy for step 4250: 0.8087180852890015


Test accuracy for step 4500: 0.8257600665092468

Test GAP RMS for gender and step 4500: 0.08039562404155731

Test GAP RMS for race and step 4500: 0.04897022992372513

Test balanced accuracy for step 4500: 0.8055651783943176


Test accuracy for step 4750: 0.8190160393714905

Test GAP RMS for gender and step 4750: 0.08417540043592453

Test GAP RMS for race and step 4750: 0.04817286133766174

Test balanced accuracy for step 4750: 0.8089814186096191


Test accuracy for step 5000: 0.8227750062942505

Test GAP RMS for gender and step 5000: 0.08231079578399658

Test GAP RMS for race and step 5000: 0.04577391594648361

Test balanced accuracy for step 5000: 0.807606041431427


Test accuracy for step 5250: 0.8235489130020142

Test GAP RMS for gender and step 5250: 0.08321681618690491

Test GAP RMS for race and step 5250: 0.043658364564180374

Test balanced accuracy for step 5250: 0.8065738677978516


Test accuracy for step 5500: 0.8226644396781921

Test GAP RMS for gender and step 5500: 0.08259519934654236

Test GAP RMS for race and step 5500: 0.045365966856479645

Test balanced accuracy for step 5500: 0.8058352470397949


Test accuracy for step 5750: 0.8175787925720215

Test GAP RMS for gender and step 5750: 0.08184947818517685

Test GAP RMS for race and step 5750: 0.04968101903796196

Test balanced accuracy for step 5750: 0.8086493015289307


Test accuracy for step 6000: 0.8187949061393738

Test GAP RMS for gender and step 6000: 0.08127890527248383

Test GAP RMS for race and step 6000: 0.047892991453409195

Test balanced accuracy for step 6000: 0.8105330467224121


Test accuracy for step 6250: 0.8197899460792542

Test GAP RMS for gender and step 6250: 0.0806175097823143

Test GAP RMS for race and step 6250: 0.04739587754011154

Test balanced accuracy for step 6250: 0.8096469640731812


Test accuracy for step 6500: 0.8204532861709595

Test GAP RMS for gender and step 6500: 0.0810057520866394

Test GAP RMS for race and step 6500: 0.04478899762034416

Test balanced accuracy for step 6500: 0.8096221685409546


Test accuracy for step 6750: 0.8231067061424255

Test GAP RMS for gender and step 6750: 0.0827406570315361

Test GAP RMS for race and step 6750: 0.04132406786084175

Test balanced accuracy for step 6750: 0.8048926591873169


Test accuracy for step 7000: 0.8204532861709595

Test GAP RMS for gender and step 7000: 0.08196637779474258

Test GAP RMS for race and step 7000: 0.04703574627637863

Test balanced accuracy for step 7000: 0.8080787658691406


Test accuracy for step 7250: 0.8250967264175415

Test GAP RMS for gender and step 7250: 0.0799633115530014

Test GAP RMS for race and step 7250: 0.04292428120970726

Test balanced accuracy for step 7250: 0.8094484806060791


Test accuracy for step 7500: 0.8248755931854248

Test GAP RMS for gender and step 7500: 0.07887314260005951

Test GAP RMS for race and step 7500: 0.040618058294057846

Test balanced accuracy for step 7500: 0.8110001087188721


Test accuracy for step 7750: 0.8227750062942505

Test GAP RMS for gender and step 7750: 0.08041771501302719

Test GAP RMS for race and step 7750: 0.04532165452837944

Test balanced accuracy for step 7750: 0.808377742767334


{'epsilon': 0.001, 'lr': 0.0001, 'wlr': 0.001, 'w_reg': 20.0}
Final test accuracy: 0.8193476796150208
Final test GAP RMS for gender: 0.08630695194005966
Final test GAP RMS for race: 0.04671211168169975
Final test balanced accuracy: 0.8065767288208008


