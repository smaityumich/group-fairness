2020-05-21 16:32:45.144111: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:45.144598: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:45.144613: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2020-05-21 16:32:52.088823: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:52.089052: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)
2020-05-21 16:32:52.089080: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (gl3166.arc-ts.umich.edu): /proc/driver/nvidia/version does not exist
2020-05-21 16:32:52.089502: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-05-21 16:32:52.097708: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3000000000 Hz
2020-05-21 16:32:52.097811: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55674dde38c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-05-21 16:32:52.097823: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
/sw/arcts/centos7/python3.6-anaconda/5.2.0/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/array_grad.py:563: _EagerTensorBase.cpu (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.identity instead.
2020-05-21 16:58:55.424162: W tensorflow/python/util/util.cc:319] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1786: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
Test accuracy for step 250: 0.6194582581520081

Test GAP RMS for gender and step 250: 0.12690797448158264

Test GAP RMS for race and step 250: 0.014036868698894978

Test balanced accuracy for step 250: 0.47697263956069946


Test accuracy for step 500: 0.8183526992797852

Test GAP RMS for gender and step 500: 0.40112343430519104

Test GAP RMS for race and step 500: 0.09394565224647522

Test balanced accuracy for step 500: 0.7802988290786743


Test accuracy for step 750: 0.8300718665122986

Test GAP RMS for gender and step 750: 0.32191646099090576

Test GAP RMS for race and step 750: 0.07840660959482193

Test balanced accuracy for step 750: 0.7871145009994507


Test accuracy for step 1000: 0.8414593935012817

Test GAP RMS for gender and step 1000: 0.2859079837799072

Test GAP RMS for race and step 1000: 0.08343885093927383

Test balanced accuracy for step 1000: 0.7880004644393921


Test accuracy for step 1250: 0.8424543738365173

Test GAP RMS for gender and step 1250: 0.2689077854156494

Test GAP RMS for race and step 1250: 0.0884433463215828

Test balanced accuracy for step 1250: 0.7908185720443726


Test accuracy for step 1500: 0.8416804671287537

Test GAP RMS for gender and step 1500: 0.2582423985004425

Test GAP RMS for race and step 1500: 0.07495532929897308

Test balanced accuracy for step 1500: 0.7944745421409607


Test accuracy for step 1750: 0.8361525535583496

Test GAP RMS for gender and step 1750: 0.27655029296875

Test GAP RMS for race and step 1750: 0.0734381154179573

Test balanced accuracy for step 1750: 0.7954529523849487


Test accuracy for step 2000: 0.834273099899292

Test GAP RMS for gender and step 2000: 0.2744387984275818

Test GAP RMS for race and step 2000: 0.0715237632393837

Test balanced accuracy for step 2000: 0.7982242703437805


Test accuracy for step 2250: 0.8370370268821716

Test GAP RMS for gender and step 2250: 0.2662976384162903

Test GAP RMS for race and step 2250: 0.06902020424604416

Test balanced accuracy for step 2250: 0.7958829402923584


Test accuracy for step 2500: 0.8370370268821716

Test GAP RMS for gender and step 2500: 0.24586737155914307

Test GAP RMS for race and step 2500: 0.0743732750415802

Test balanced accuracy for step 2500: 0.8006675243377686


Test accuracy for step 2750: 0.8341625332832336

Test GAP RMS for gender and step 2750: 0.24400098621845245

Test GAP RMS for race and step 2750: 0.06608184427022934

Test balanced accuracy for step 2750: 0.8054052591323853


Test accuracy for step 3000: 0.8332780599594116

Test GAP RMS for gender and step 3000: 0.24978990852832794

Test GAP RMS for race and step 3000: 0.07005297392606735

Test balanced accuracy for step 3000: 0.8100684881210327


Test accuracy for step 3250: 0.8341625332832336

Test GAP RMS for gender and step 3250: 0.23463962972164154

Test GAP RMS for race and step 3250: 0.0679849237203598

Test balanced accuracy for step 3250: 0.8072572946548462


Test accuracy for step 3500: 0.8334991931915283

Test GAP RMS for gender and step 3500: 0.2308572232723236

Test GAP RMS for race and step 3500: 0.06984851509332657

Test balanced accuracy for step 3500: 0.807436466217041


Test accuracy for step 3750: 0.8339414000511169

Test GAP RMS for gender and step 3750: 0.22098800539970398

Test GAP RMS for race and step 3750: 0.07786311954259872

Test balanced accuracy for step 3750: 0.8132848739624023


Test accuracy for step 4000: 0.8349364399909973

Test GAP RMS for gender and step 4000: 0.2227112054824829

Test GAP RMS for race and step 4000: 0.06887137144804001

Test balanced accuracy for step 4000: 0.8091576099395752


Test accuracy for step 4250: 0.8339414000511169

Test GAP RMS for gender and step 4250: 0.2244328111410141

Test GAP RMS for race and step 4250: 0.06775080412626266

Test balanced accuracy for step 4250: 0.8140565752983093


Test accuracy for step 4500: 0.8373687267303467

Test GAP RMS for gender and step 4500: 0.1951693445444107

Test GAP RMS for race and step 4500: 0.0698423758149147

Test balanced accuracy for step 4500: 0.8053624629974365


Test accuracy for step 4750: 0.83338862657547

Test GAP RMS for gender and step 4750: 0.19883687794208527

Test GAP RMS for race and step 4750: 0.06318534910678864

Test balanced accuracy for step 4750: 0.8144631385803223


Test accuracy for step 5000: 0.835710346698761

Test GAP RMS for gender and step 5000: 0.1911674290895462

Test GAP RMS for race and step 5000: 0.06206035614013672

Test balanced accuracy for step 5000: 0.8122926950454712


Test accuracy for step 5250: 0.8346047401428223

Test GAP RMS for gender and step 5250: 0.18753476440906525

Test GAP RMS for race and step 5250: 0.06226423755288124

Test balanced accuracy for step 5250: 0.8132600784301758


Test accuracy for step 5500: 0.8367053866386414

Test GAP RMS for gender and step 5500: 0.16466885805130005

Test GAP RMS for race and step 5500: 0.0613517090678215

Test balanced accuracy for step 5500: 0.8144934177398682


Test accuracy for step 5750: 0.8360419869422913

Test GAP RMS for gender and step 5750: 0.15343239903450012

Test GAP RMS for race and step 5750: 0.05998864769935608

Test balanced accuracy for step 5750: 0.8180680274963379


Test accuracy for step 6000: 0.8341625332832336

Test GAP RMS for gender and step 6000: 0.1547713577747345

Test GAP RMS for race and step 6000: 0.058554019778966904

Test balanced accuracy for step 6000: 0.8200675845146179


Test accuracy for step 6250: 0.8344941735267639

Test GAP RMS for gender and step 6250: 0.15215876698493958

Test GAP RMS for race and step 6250: 0.057512715458869934

Test balanced accuracy for step 6250: 0.8216757774353027


Test accuracy for step 6500: 0.8338308334350586

Test GAP RMS for gender and step 6500: 0.14376676082611084

Test GAP RMS for race and step 6500: 0.057142481207847595

Test balanced accuracy for step 6500: 0.8233983516693115


Test accuracy for step 6750: 0.8363736867904663

Test GAP RMS for gender and step 6750: 0.12261879444122314

Test GAP RMS for race and step 6750: 0.05738244205713272

Test balanced accuracy for step 6750: 0.8202935457229614


Test accuracy for step 7000: 0.8334991931915283

Test GAP RMS for gender and step 7000: 0.12391899526119232

Test GAP RMS for race and step 7000: 0.06041860580444336

Test balanced accuracy for step 7000: 0.8250312805175781


Test accuracy for step 7250: 0.831951379776001

Test GAP RMS for gender and step 7250: 0.11913976818323135

Test GAP RMS for race and step 7250: 0.058469053357839584

Test balanced accuracy for step 7250: 0.8258609175682068


Test accuracy for step 7500: 0.831951379776001

Test GAP RMS for gender and step 7500: 0.11718077957630157

Test GAP RMS for race and step 7500: 0.05450982227921486

Test balanced accuracy for step 7500: 0.8238544464111328


Test accuracy for step 7750: 0.8286346197128296

Test GAP RMS for gender and step 7750: 0.11287485063076019

Test GAP RMS for race and step 7750: 0.05773051828145981

Test balanced accuracy for step 7750: 0.8242872357368469


{'epsilon': 0.0001, 'lr': 0.0001, 'wlr': 5e-06, 'w_reg': 50.0}
Final test accuracy: 0.8277501463890076
Final test GAP RMS for gender: 0.10703945904970169
Final test GAP RMS for race: 0.055664628744125366
Final test balanced accuracy: 0.8218508362770081


