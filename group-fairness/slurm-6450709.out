2020-05-21 16:32:44.224033: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:44.224635: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:44.224646: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2020-05-21 16:32:49.168302: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:49.168537: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)
2020-05-21 16:32:49.168567: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (gl3105.arc-ts.umich.edu): /proc/driver/nvidia/version does not exist
2020-05-21 16:32:49.168986: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-05-21 16:32:49.176026: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3000000000 Hz
2020-05-21 16:32:49.176123: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x56026292de80 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-05-21 16:32:49.176133: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
/sw/arcts/centos7/python3.6-anaconda/5.2.0/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/array_grad.py:563: _EagerTensorBase.cpu (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.identity instead.
2020-05-21 16:58:43.199767: W tensorflow/python/util/util.cc:319] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1786: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
Test accuracy for step 250: 0.6187949180603027

Test GAP RMS for gender and step 250: 0.12793704867362976

Test GAP RMS for race and step 250: 0.013945057988166809

Test balanced accuracy for step 250: 0.4745280146598816


Test accuracy for step 500: 0.8350470066070557

Test GAP RMS for gender and step 500: 0.3434288203716278

Test GAP RMS for race and step 500: 0.059187211096286774

Test balanced accuracy for step 500: 0.7351471185684204


Test accuracy for step 750: 0.8437811136245728

Test GAP RMS for gender and step 750: 0.26601696014404297

Test GAP RMS for race and step 750: 0.06451416015625

Test balanced accuracy for step 750: 0.7580487728118896


Test accuracy for step 1000: 0.8445550203323364

Test GAP RMS for gender and step 1000: 0.22121907770633698

Test GAP RMS for race and step 1000: 0.045099109411239624

Test balanced accuracy for step 1000: 0.7437433004379272


Test accuracy for step 1250: 0.845550000667572

Test GAP RMS for gender and step 1250: 0.19937971234321594

Test GAP RMS for race and step 1250: 0.05063352733850479

Test balanced accuracy for step 1250: 0.741931140422821


Test accuracy for step 1500: 0.8457711338996887

Test GAP RMS for gender and step 1500: 0.18362706899642944

Test GAP RMS for race and step 1500: 0.04065883532166481

Test balanced accuracy for step 1500: 0.7389904260635376


Test accuracy for step 1750: 0.845550000667572

Test GAP RMS for gender and step 1750: 0.1887316256761551

Test GAP RMS for race and step 1750: 0.03965715691447258

Test balanced accuracy for step 1750: 0.734059751033783


Test accuracy for step 2000: 0.8456605672836304

Test GAP RMS for gender and step 2000: 0.19279897212982178

Test GAP RMS for race and step 2000: 0.041698187589645386

Test balanced accuracy for step 2000: 0.7288851737976074


Test accuracy for step 2250: 0.841791033744812

Test GAP RMS for gender and step 2250: 0.18185670673847198

Test GAP RMS for race and step 2250: 0.031372733414173126

Test balanced accuracy for step 2250: 0.71382737159729


Test accuracy for step 2500: 0.840353786945343

Test GAP RMS for gender and step 2500: 0.15842364728450775

Test GAP RMS for race and step 2500: 0.023301992565393448

Test balanced accuracy for step 2500: 0.7076303362846375


Test accuracy for step 2750: 0.8404643535614014

Test GAP RMS for gender and step 2750: 0.1597307026386261

Test GAP RMS for race and step 2750: 0.01896495930850506

Test balanced accuracy for step 2750: 0.7072403430938721


Test accuracy for step 3000: 0.836263120174408

Test GAP RMS for gender and step 3000: 0.16441315412521362

Test GAP RMS for race and step 3000: 0.01798504777252674

Test balanced accuracy for step 3000: 0.6928894519805908


Test accuracy for step 3250: 0.8349364399909973

Test GAP RMS for gender and step 3250: 0.1464301198720932

Test GAP RMS for race and step 3250: 0.007926561869680882

Test balanced accuracy for step 3250: 0.6838329434394836


Test accuracy for step 3500: 0.8337202668190002

Test GAP RMS for gender and step 3500: 0.1448695957660675

Test GAP RMS for race and step 3500: 0.00510057620704174

Test balanced accuracy for step 3500: 0.6793254017829895


Test accuracy for step 3750: 0.8318408131599426

Test GAP RMS for gender and step 3750: 0.14060448110103607

Test GAP RMS for race and step 3750: 0.006114628631621599

Test balanced accuracy for step 3750: 0.6742252707481384


Test accuracy for step 4000: 0.8241016864776611

Test GAP RMS for gender and step 4000: 0.11736036092042923

Test GAP RMS for race and step 4000: 0.005351928062736988

Test balanced accuracy for step 4000: 0.65120929479599


Test accuracy for step 4250: 0.8228855729103088

Test GAP RMS for gender and step 4250: 0.11491237580776215

Test GAP RMS for race and step 4250: 0.004909672774374485

Test balanced accuracy for step 4250: 0.6473190784454346


Test accuracy for step 4500: 0.8162520527839661

Test GAP RMS for gender and step 4500: 0.08717472106218338

Test GAP RMS for race and step 4500: 0.007776819169521332

Test balanced accuracy for step 4500: 0.6295093297958374


Test accuracy for step 4750: 0.8174682259559631

Test GAP RMS for gender and step 4750: 0.091682069003582

Test GAP RMS for race and step 4750: 0.015830982476472855

Test balanced accuracy for step 4750: 0.6321647763252258


Test accuracy for step 5000: 0.8106135725975037

Test GAP RMS for gender and step 5000: 0.07202266156673431

Test GAP RMS for race and step 5000: 0.009134258143603802

Test balanced accuracy for step 5000: 0.6163697242736816


Test accuracy for step 5250: 0.8090657591819763

Test GAP RMS for gender and step 5250: 0.05886692926287651

Test GAP RMS for race and step 5250: 0.009342732839286327

Test balanced accuracy for step 5250: 0.6121060848236084


Test accuracy for step 5500: 0.804090678691864

Test GAP RMS for gender and step 5500: 0.04446009173989296

Test GAP RMS for race and step 5500: 0.013957281596958637

Test balanced accuracy for step 5500: 0.6007937788963318


Test accuracy for step 5750: 0.8005527853965759

Test GAP RMS for gender and step 5750: 0.032778549939394

Test GAP RMS for race and step 5750: 0.012012522667646408

Test balanced accuracy for step 5750: 0.5925917029380798


Test accuracy for step 6000: 0.8016583919525146

Test GAP RMS for gender and step 6000: 0.04172612354159355

Test GAP RMS for race and step 6000: 0.007888698019087315

Test balanced accuracy for step 6000: 0.5948654413223267


Test accuracy for step 6250: 0.7919292449951172

Test GAP RMS for gender and step 6250: 0.02379615791141987

Test GAP RMS for race and step 6250: 0.002107159700244665

Test balanced accuracy for step 6250: 0.5725412368774414


Test accuracy for step 6500: 0.7876174449920654

Test GAP RMS for gender and step 6500: 0.01621140167117119

Test GAP RMS for race and step 6500: 0.0009450838551856577

Test balanced accuracy for step 6500: 0.5633648633956909


Test accuracy for step 6750: 0.7840796113014221

Test GAP RMS for gender and step 6750: 0.006795894354581833

Test GAP RMS for race and step 6750: 0.008436857722699642

Test balanced accuracy for step 6750: 0.5560888648033142


Test accuracy for step 7000: 0.7845218181610107

Test GAP RMS for gender and step 7000: 0.008298397064208984

Test GAP RMS for race and step 7000: 0.0070199910551309586

Test balanced accuracy for step 7000: 0.5569983720779419


Test accuracy for step 7250: 0.7766721844673157

Test GAP RMS for gender and step 7250: 0.0027466618921607733

Test GAP RMS for race and step 7250: 0.0014762224163860083

Test balanced accuracy for step 7250: 0.5408546328544617


Test accuracy for step 7500: 0.773908257484436

Test GAP RMS for gender and step 7500: 0.009529637172818184

Test GAP RMS for race and step 7500: 0.002655419986695051

Test balanced accuracy for step 7500: 0.5351702570915222


Test accuracy for step 7750: 0.7761194109916687

Test GAP RMS for gender and step 7750: 0.0020208030473440886

Test GAP RMS for race and step 7750: 0.0070810578763484955

Test balanced accuracy for step 7750: 0.5397177934646606


{'epsilon': 0.1, 'lr': 0.0001, 'wlr': 1e-06, 'w_reg': 60.0}
Final test accuracy: 0.770702064037323
Final test GAP RMS for gender: 0.004788978956639767
Final test GAP RMS for race: 0.00525252940133214
Final test balanced accuracy: 0.5285763144493103


