2020-05-21 16:32:43.798643: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:43.798746: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:43.798756: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2020-05-21 16:32:50.809642: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:50.811941: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)
2020-05-21 16:32:50.811977: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (gl3264.arc-ts.umich.edu): /proc/driver/nvidia/version does not exist
2020-05-21 16:32:50.812372: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-05-21 16:32:50.819443: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3000000000 Hz
2020-05-21 16:32:50.819544: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x556453932740 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-05-21 16:32:50.819557: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
/sw/arcts/centos7/python3.6-anaconda/5.2.0/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/array_grad.py:563: _EagerTensorBase.cpu (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.identity instead.
2020-05-21 16:59:07.030021: W tensorflow/python/util/util.cc:319] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1786: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
Test accuracy for step 250: 0.6195688247680664

Test GAP RMS for gender and step 250: 0.12707580626010895

Test GAP RMS for race and step 250: 0.014148896560072899

Test balanced accuracy for step 250: 0.4770456552505493


Test accuracy for step 500: 0.8247650861740112

Test GAP RMS for gender and step 500: 0.3712790906429291

Test GAP RMS for race and step 500: 0.10341514647006989

Test balanced accuracy for step 500: 0.7783612012863159


Test accuracy for step 750: 0.8353786468505859

Test GAP RMS for gender and step 750: 0.2871200144290924

Test GAP RMS for race and step 750: 0.07450918108224869

Test balanced accuracy for step 750: 0.7907745838165283


Test accuracy for step 1000: 0.8434494137763977

Test GAP RMS for gender and step 1000: 0.25755971670150757

Test GAP RMS for race and step 1000: 0.08173830807209015

Test balanced accuracy for step 1000: 0.7856109142303467


Test accuracy for step 1250: 0.8452183604240417

Test GAP RMS for gender and step 1250: 0.244026780128479

Test GAP RMS for race and step 1250: 0.08766911923885345

Test balanced accuracy for step 1250: 0.786779522895813


Test accuracy for step 1500: 0.8458817005157471

Test GAP RMS for gender and step 1500: 0.23905010521411896

Test GAP RMS for race and step 1500: 0.08144944161176682

Test balanced accuracy for step 1500: 0.7918479442596436


Test accuracy for step 1750: 0.8451077938079834

Test GAP RMS for gender and step 1750: 0.24433466792106628

Test GAP RMS for race and step 1750: 0.07967673242092133

Test balanced accuracy for step 1750: 0.7904106378555298


Test accuracy for step 2000: 0.8454394936561584

Test GAP RMS for gender and step 2000: 0.23728445172309875

Test GAP RMS for race and step 2000: 0.0697278380393982

Test balanced accuracy for step 2000: 0.7907841205596924


Test accuracy for step 2250: 0.8468767404556274

Test GAP RMS for gender and step 2250: 0.22993941605091095

Test GAP RMS for race and step 2250: 0.07077775150537491

Test balanced accuracy for step 2250: 0.7846338748931885


Test accuracy for step 2500: 0.8472083806991577

Test GAP RMS for gender and step 2500: 0.21804700791835785

Test GAP RMS for race and step 2500: 0.06793762743473053

Test balanced accuracy for step 2500: 0.7870137691497803


Test accuracy for step 2750: 0.8454394936561584

Test GAP RMS for gender and step 2750: 0.22275906801223755

Test GAP RMS for race and step 2750: 0.05854097381234169

Test balanced accuracy for step 2750: 0.7898581027984619


Test accuracy for step 3000: 0.8446655869483948

Test GAP RMS for gender and step 3000: 0.2265802025794983

Test GAP RMS for race and step 3000: 0.05816681310534477

Test balanced accuracy for step 3000: 0.7904272079467773


Test accuracy for step 3250: 0.8462134003639221

Test GAP RMS for gender and step 3250: 0.22422991693019867

Test GAP RMS for race and step 3250: 0.06442387402057648

Test balanced accuracy for step 3250: 0.788208544254303


Test accuracy for step 3500: 0.8466556072235107

Test GAP RMS for gender and step 3500: 0.20850470662117004

Test GAP RMS for race and step 3500: 0.06719080358743668

Test balanced accuracy for step 3500: 0.7900440692901611


Test accuracy for step 3750: 0.8452183604240417

Test GAP RMS for gender and step 3750: 0.21031902730464935

Test GAP RMS for race and step 3750: 0.0600508376955986

Test balanced accuracy for step 3750: 0.7935705184936523


Test accuracy for step 4000: 0.8451077938079834

Test GAP RMS for gender and step 4000: 0.22137905657291412

Test GAP RMS for race and step 4000: 0.06128912419080734

Test balanced accuracy for step 4000: 0.7879412174224854


Test accuracy for step 4250: 0.845550000667572

Test GAP RMS for gender and step 4250: 0.21841782331466675

Test GAP RMS for race and step 4250: 0.06314090639352798

Test balanced accuracy for step 4250: 0.7907028198242188


Test accuracy for step 4500: 0.8488667607307434

Test GAP RMS for gender and step 4500: 0.20370255410671234

Test GAP RMS for race and step 4500: 0.06214223429560661

Test balanced accuracy for step 4500: 0.7856398820877075


Test accuracy for step 4750: 0.8433388471603394

Test GAP RMS for gender and step 4750: 0.21647821366786957

Test GAP RMS for race and step 4750: 0.0629863440990448

Test balanced accuracy for step 4750: 0.7932549715042114


Test accuracy for step 5000: 0.844112753868103

Test GAP RMS for gender and step 5000: 0.21425417065620422

Test GAP RMS for race and step 5000: 0.059499140828847885

Test balanced accuracy for step 5000: 0.792222797870636


Test accuracy for step 5250: 0.8434494137763977

Test GAP RMS for gender and step 5250: 0.21804188191890717

Test GAP RMS for race and step 5250: 0.06169092655181885

Test balanced accuracy for step 5250: 0.7930192947387695


Test accuracy for step 5500: 0.8452183604240417

Test GAP RMS for gender and step 5500: 0.20401285588741302

Test GAP RMS for race and step 5500: 0.060921214520931244

Test balanced accuracy for step 5500: 0.7937248945236206


Test accuracy for step 5750: 0.8427860736846924

Test GAP RMS for gender and step 5750: 0.20708702504634857

Test GAP RMS for race and step 5750: 0.06170734763145447

Test balanced accuracy for step 5750: 0.796130895614624


Test accuracy for step 6000: 0.8416804671287537

Test GAP RMS for gender and step 6000: 0.22387076914310455

Test GAP RMS for race and step 6000: 0.06548339128494263

Test balanced accuracy for step 6000: 0.8004938364028931


Test accuracy for step 6250: 0.8406854867935181

Test GAP RMS for gender and step 6250: 0.2282155454158783

Test GAP RMS for race and step 6250: 0.06868354976177216

Test balanced accuracy for step 6250: 0.7996821403503418


Test accuracy for step 6500: 0.8399115800857544

Test GAP RMS for gender and step 6500: 0.21927691996097565

Test GAP RMS for race and step 6500: 0.06126298010349274

Test balanced accuracy for step 6500: 0.8008686304092407


Test accuracy for step 6750: 0.8415699005126953

Test GAP RMS for gender and step 6750: 0.2116517722606659

Test GAP RMS for race and step 6750: 0.06371808052062988

Test balanced accuracy for step 6750: 0.797951340675354


Test accuracy for step 7000: 0.84090656042099

Test GAP RMS for gender and step 7000: 0.20883825421333313

Test GAP RMS for race and step 7000: 0.06432124972343445

Test balanced accuracy for step 7000: 0.8033781051635742


Test accuracy for step 7250: 0.8395798802375793

Test GAP RMS for gender and step 7250: 0.21949155628681183

Test GAP RMS for race and step 7250: 0.06404373794794083

Test balanced accuracy for step 7250: 0.8038907051086426


Test accuracy for step 7500: 0.8384742736816406

Test GAP RMS for gender and step 7500: 0.23426136374473572

Test GAP RMS for race and step 7500: 0.06128408759832382

Test balanced accuracy for step 7500: 0.8057841658592224


Test accuracy for step 7750: 0.839469313621521

Test GAP RMS for gender and step 7750: 0.21593640744686127

Test GAP RMS for race and step 7750: 0.0650586187839508

Test balanced accuracy for step 7750: 0.8104543685913086


{'epsilon': 0.0001, 'lr': 0.0001, 'wlr': 1e-06, 'w_reg': 40.0}
Final test accuracy: 0.840022087097168
Final test GAP RMS for gender: 0.21024742722511292
Final test GAP RMS for race: 0.06501110643148422
Final test balanced accuracy: 0.8122085332870483


