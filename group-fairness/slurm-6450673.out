2020-05-21 16:32:43.786605: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:43.786705: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:43.786715: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2020-05-21 16:32:50.791490: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:50.791750: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)
2020-05-21 16:32:50.791785: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (gl3264.arc-ts.umich.edu): /proc/driver/nvidia/version does not exist
2020-05-21 16:32:50.792312: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-05-21 16:32:50.800910: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3000000000 Hz
2020-05-21 16:32:50.801052: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x559c0d780080 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-05-21 16:32:50.801065: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
/sw/arcts/centos7/python3.6-anaconda/5.2.0/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/array_grad.py:563: _EagerTensorBase.cpu (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.identity instead.
2020-05-21 16:59:18.125321: W tensorflow/python/util/util.cc:319] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1786: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
Test accuracy for step 250: 0.6182421445846558

Test GAP RMS for gender and step 250: 0.12684109807014465

Test GAP RMS for race and step 250: 0.016148967668414116

Test balanced accuracy for step 250: 0.4791017174720764


Test accuracy for step 500: 0.7870646715164185

Test GAP RMS for gender and step 500: 0.3100229501724243

Test GAP RMS for race and step 500: 0.08482523262500763

Test balanced accuracy for step 500: 0.8043886423110962


Test accuracy for step 750: 0.7974571585655212

Test GAP RMS for gender and step 750: 0.17214547097682953

Test GAP RMS for race and step 750: 0.06866120547056198

Test balanced accuracy for step 750: 0.8219034671783447


Test accuracy for step 1000: 0.8113874793052673

Test GAP RMS for gender and step 1000: 0.10679595172405243

Test GAP RMS for race and step 1000: 0.058774158358573914

Test balanced accuracy for step 1000: 0.8156718015670776


Test accuracy for step 1250: 0.8076285123825073

Test GAP RMS for gender and step 1250: 0.08635344356298447

Test GAP RMS for race and step 1250: 0.0574130155146122

Test balanced accuracy for step 1250: 0.8122625946998596


Test accuracy for step 1500: 0.8042012453079224

Test GAP RMS for gender and step 1500: 0.07717980444431305

Test GAP RMS for race and step 1500: 0.05509335920214653

Test balanced accuracy for step 1500: 0.8120049238204956


Test accuracy for step 1750: 0.7992261052131653

Test GAP RMS for gender and step 1750: 0.07412178814411163

Test GAP RMS for race and step 1750: 0.053403452038764954

Test balanced accuracy for step 1750: 0.812422513961792


Test accuracy for step 2000: 0.8016583919525146

Test GAP RMS for gender and step 2000: 0.06938064843416214

Test GAP RMS for race and step 2000: 0.054284464567899704

Test balanced accuracy for step 2000: 0.8107881546020508


Test accuracy for step 2250: 0.8065229654312134

Test GAP RMS for gender and step 2250: 0.07010848075151443

Test GAP RMS for race and step 2250: 0.05381143093109131

Test balanced accuracy for step 2250: 0.8084454536437988


Test accuracy for step 2500: 0.801768958568573

Test GAP RMS for gender and step 2500: 0.06943341344594955

Test GAP RMS for race and step 2500: 0.04847532510757446

Test balanced accuracy for step 2500: 0.8080830574035645


Test accuracy for step 2750: 0.7963515520095825

Test GAP RMS for gender and step 2750: 0.06465083360671997

Test GAP RMS for race and step 2750: 0.04572049900889397

Test balanced accuracy for step 2750: 0.8116039633750916


Test accuracy for step 3000: 0.8039801120758057

Test GAP RMS for gender and step 3000: 0.06465916335582733

Test GAP RMS for race and step 3000: 0.04709113389253616

Test balanced accuracy for step 3000: 0.8110871315002441


Test accuracy for step 3250: 0.807849645614624

Test GAP RMS for gender and step 3250: 0.07257639616727829

Test GAP RMS for race and step 3250: 0.043207548558712006

Test balanced accuracy for step 3250: 0.8110195994377136


Test accuracy for step 3500: 0.8025428652763367

Test GAP RMS for gender and step 3500: 0.07218186557292938

Test GAP RMS for race and step 3500: 0.046392228454351425

Test balanced accuracy for step 3500: 0.807050883769989


Test accuracy for step 3750: 0.8029850721359253

Test GAP RMS for gender and step 3750: 0.06948953866958618

Test GAP RMS for race and step 3750: 0.04617892578244209

Test balanced accuracy for step 3750: 0.8079603910446167


Test accuracy for step 4000: 0.8117191791534424

Test GAP RMS for gender and step 4000: 0.07081912457942963

Test GAP RMS for race and step 4000: 0.050977278500795364

Test balanced accuracy for step 4000: 0.8064761161804199


Test accuracy for step 4250: 0.8113874793052673

Test GAP RMS for gender and step 4250: 0.07098951190710068

Test GAP RMS for race and step 4250: 0.047786418348550797

Test balanced accuracy for step 4250: 0.8081091642379761


Test accuracy for step 4500: 0.8160309791564941

Test GAP RMS for gender and step 4500: 0.08213711529970169

Test GAP RMS for race and step 4500: 0.03947421908378601

Test balanced accuracy for step 4500: 0.8017618656158447


Test accuracy for step 4750: 0.8042012453079224

Test GAP RMS for gender and step 4750: 0.06808342039585114

Test GAP RMS for race and step 4750: 0.04445989057421684

Test balanced accuracy for step 4750: 0.8087637424468994


Test accuracy for step 5000: 0.808402419090271

Test GAP RMS for gender and step 5000: 0.07041038572788239

Test GAP RMS for race and step 5000: 0.040588270872831345

Test balanced accuracy for step 5000: 0.8059828281402588


Test accuracy for step 5250: 0.8122719526290894

Test GAP RMS for gender and step 5250: 0.07631542533636093

Test GAP RMS for race and step 5250: 0.03999542444944382

Test balanced accuracy for step 5250: 0.8040632009506226


Test accuracy for step 5500: 0.8111664056777954

Test GAP RMS for gender and step 5500: 0.07926864176988602

Test GAP RMS for race and step 5500: 0.04390106722712517

Test balanced accuracy for step 5500: 0.8036415576934814


Test accuracy for step 5750: 0.8029850721359253

Test GAP RMS for gender and step 5750: 0.06913874298334122

Test GAP RMS for race and step 5750: 0.043376270681619644

Test balanced accuracy for step 5750: 0.8051822185516357


Test accuracy for step 6000: 0.8053067922592163

Test GAP RMS for gender and step 6000: 0.06816788017749786

Test GAP RMS for race and step 6000: 0.04445142298936844

Test balanced accuracy for step 6000: 0.8081050515174866


Test accuracy for step 6250: 0.8086235523223877

Test GAP RMS for gender and step 6250: 0.06846684962511063

Test GAP RMS for race and step 6250: 0.03536788374185562

Test balanced accuracy for step 6250: 0.809524416923523


Test accuracy for step 6500: 0.807296872138977

Test GAP RMS for gender and step 6500: 0.06628990918397903

Test GAP RMS for race and step 6500: 0.03802235797047615

Test balanced accuracy for step 6500: 0.8086479902267456


Test accuracy for step 6750: 0.810724139213562

Test GAP RMS for gender and step 6750: 0.0830465778708458

Test GAP RMS for race and step 6750: 0.037531763315200806

Test balanced accuracy for step 6750: 0.8013429641723633


Test accuracy for step 7000: 0.8053067922592163

Test GAP RMS for gender and step 7000: 0.07461872696876526

Test GAP RMS for race and step 7000: 0.038752276450395584

Test balanced accuracy for step 7000: 0.8053269386291504


Test accuracy for step 7250: 0.8119403123855591

Test GAP RMS for gender and step 7250: 0.07214787602424622

Test GAP RMS for race and step 7250: 0.037893373519182205

Test balanced accuracy for step 7250: 0.806159257888794


Test accuracy for step 7500: 0.8119403123855591

Test GAP RMS for gender and step 7500: 0.0650373175740242

Test GAP RMS for race and step 7500: 0.03205594792962074

Test balanced accuracy for step 7500: 0.8106350898742676


Test accuracy for step 7750: 0.8102819323539734

Test GAP RMS for gender and step 7750: 0.07307875156402588

Test GAP RMS for race and step 7750: 0.0364580899477005

Test balanced accuracy for step 7750: 0.805217981338501


{'epsilon': 1e-05, 'lr': 0.0001, 'wlr': 0.0001, 'w_reg': 50.0}
Final test accuracy: 0.8076285123825073
Final test GAP RMS for gender: 0.07651428878307343
Final test GAP RMS for race: 0.03650983050465584
Final test balanced accuracy: 0.8063976168632507


