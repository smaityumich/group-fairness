2020-05-21 16:32:45.144114: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:45.144604: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:45.144614: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2020-05-21 16:32:52.099417: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:52.101236: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)
2020-05-21 16:32:52.101259: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (gl3166.arc-ts.umich.edu): /proc/driver/nvidia/version does not exist
2020-05-21 16:32:52.101601: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-05-21 16:32:52.108494: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3000000000 Hz
2020-05-21 16:32:52.108582: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5640ebc634c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-05-21 16:32:52.108592: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
/sw/arcts/centos7/python3.6-anaconda/5.2.0/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/array_grad.py:563: _EagerTensorBase.cpu (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.identity instead.
2020-05-21 16:58:51.590421: W tensorflow/python/util/util.cc:319] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1786: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
Test accuracy for step 250: 0.6174682378768921

Test GAP RMS for gender and step 250: 0.12816700339317322

Test GAP RMS for race and step 250: 0.015322881750762463

Test balanced accuracy for step 250: 0.47041040658950806


Test accuracy for step 500: 0.7942509651184082

Test GAP RMS for gender and step 500: 0.12338744103908539

Test GAP RMS for race and step 500: 0.02325906790792942

Test balanced accuracy for step 500: 0.5848788619041443


Test accuracy for step 750: 0.8095080256462097

Test GAP RMS for gender and step 750: 0.11327791959047318

Test GAP RMS for race and step 750: 0.01997959427535534

Test balanced accuracy for step 750: 0.6185718774795532


Test accuracy for step 1000: 0.7978993654251099

Test GAP RMS for gender and step 1000: 0.047186557203531265

Test GAP RMS for race and step 1000: 0.003549948800355196

Test balanced accuracy for step 1000: 0.5871346592903137


Test accuracy for step 1250: 0.7899391651153564

Test GAP RMS for gender and step 1250: 0.028591470792889595

Test GAP RMS for race and step 1250: 0.000947047199588269

Test balanced accuracy for step 1250: 0.5689114928245544


Test accuracy for step 1500: 0.7798783779144287

Test GAP RMS for gender and step 1500: 0.005924611818045378

Test GAP RMS for race and step 1500: 0.010034006088972092

Test balanced accuracy for step 1500: 0.5476028919219971


Test accuracy for step 1750: 0.7621890306472778

Test GAP RMS for gender and step 1750: 0.00760923745110631

Test GAP RMS for race and step 1750: 0.006020707543939352

Test balanced accuracy for step 1750: 0.5109140276908875


Test accuracy for step 2000: 0.7589828372001648

Test GAP RMS for gender and step 2000: 0.000680327822919935

Test GAP RMS for race and step 2000: 0.002893430180847645

Test balanced accuracy for step 2000: 0.5043201446533203


Test accuracy for step 2250: 0.7568822503089905

Test GAP RMS for gender and step 2250: 0.0

Test GAP RMS for race and step 2250: 0.0

Test balanced accuracy for step 2250: 0.5


Test accuracy for step 2500: 0.7568822503089905

Test GAP RMS for gender and step 2500: 0.0

Test GAP RMS for race and step 2500: 0.0

Test balanced accuracy for step 2500: 0.5


Test accuracy for step 2750: 0.7568822503089905

Test GAP RMS for gender and step 2750: 0.0

Test GAP RMS for race and step 2750: 0.0

Test balanced accuracy for step 2750: 0.5


Test accuracy for step 3000: 0.7568822503089905

Test GAP RMS for gender and step 3000: 0.0

Test GAP RMS for race and step 3000: 0.0

Test balanced accuracy for step 3000: 0.5


Test accuracy for step 3250: 0.7568822503089905

Test GAP RMS for gender and step 3250: 0.0

Test GAP RMS for race and step 3250: 0.0

Test balanced accuracy for step 3250: 0.5


Test accuracy for step 3500: 0.7568822503089905

Test GAP RMS for gender and step 3500: 0.0

Test GAP RMS for race and step 3500: 0.0

Test balanced accuracy for step 3500: 0.5


Test accuracy for step 3750: 0.7568822503089905

Test GAP RMS for gender and step 3750: 0.0

Test GAP RMS for race and step 3750: 0.0

Test balanced accuracy for step 3750: 0.5


Test accuracy for step 4000: 0.7568822503089905

Test GAP RMS for gender and step 4000: 0.0

Test GAP RMS for race and step 4000: 0.0

Test balanced accuracy for step 4000: 0.5


Test accuracy for step 4250: 0.7572139501571655

Test GAP RMS for gender and step 4250: 0.0011271628318354487

Test GAP RMS for race and step 4250: 0.001062785740941763

Test balanced accuracy for step 4250: 0.5006821155548096


Test accuracy for step 4500: 0.7569928169250488

Test GAP RMS for gender and step 4500: 0.00037572093424387276

Test GAP RMS for race and step 4500: 0.0003542619233485311

Test balanced accuracy for step 4500: 0.5002273917198181


Test accuracy for step 4750: 0.7597567439079285

Test GAP RMS for gender and step 4750: 0.008475648239254951

Test GAP RMS for race and step 4750: 0.005373263265937567

Test balanced accuracy for step 4750: 0.5059117674827576


Test accuracy for step 5000: 0.7634052038192749

Test GAP RMS for gender and step 5000: 0.0012895407853648067

Test GAP RMS for race and step 5000: 0.0017137211980298162

Test balanced accuracy for step 5000: 0.5134152173995972


Test accuracy for step 5250: 0.7641791105270386

Test GAP RMS for gender and step 5250: 0.0038721770979464054

Test GAP RMS for race and step 5250: 0.00035600652336142957

Test balanced accuracy for step 5250: 0.5150068402290344


Test accuracy for step 5500: 0.766058623790741

Test GAP RMS for gender and step 5500: 0.010516632348299026

Test GAP RMS for race and step 5500: 0.005134178791195154

Test balanced accuracy for step 5500: 0.5188722014427185


Test accuracy for step 5750: 0.7708126306533813

Test GAP RMS for gender and step 5750: 0.024885477498173714

Test GAP RMS for race and step 5750: 0.000746270059607923

Test balanced accuracy for step 5750: 0.5289580821990967


Test accuracy for step 6000: 0.781978964805603

Test GAP RMS for gender and step 6000: 0.017837993800640106

Test GAP RMS for race and step 6000: 0.010627216659486294

Test balanced accuracy for step 6000: 0.5520774126052856


Test accuracy for step 6250: 0.7858485579490662

Test GAP RMS for gender and step 6250: 0.012506854720413685

Test GAP RMS for race and step 6250: 0.002091696485877037

Test balanced accuracy for step 6250: 0.5600355267524719


Test accuracy for step 6500: 0.7913764715194702

Test GAP RMS for gender and step 6500: 0.003673768602311611

Test GAP RMS for race and step 6500: 0.00047628936590626836

Test balanced accuracy for step 6500: 0.5714043378829956


Test accuracy for step 6750: 0.7931453585624695

Test GAP RMS for gender and step 6750: 0.0004130525921937078

Test GAP RMS for race and step 6750: 0.009037336334586143

Test balanced accuracy for step 6750: 0.5751966834068298


Test accuracy for step 7000: 0.8021005988121033

Test GAP RMS for gender and step 7000: 0.007130013778805733

Test GAP RMS for race and step 7000: 0.01185387559235096

Test balanced accuracy for step 7000: 0.5968553423881531


Test accuracy for step 7250: 0.8001105785369873

Test GAP RMS for gender and step 7250: 0.008623834699392319

Test GAP RMS for race and step 7250: 0.007501038257032633

Test balanced accuracy for step 7250: 0.5919908881187439


Test accuracy for step 7500: 0.803758978843689

Test GAP RMS for gender and step 7500: 0.011136982589960098

Test GAP RMS for race and step 7500: 0.018168460577726364

Test balanced accuracy for step 7500: 0.6007289886474609


Test accuracy for step 7750: 0.80983966588974

Test GAP RMS for gender and step 7750: 0.005358277354389429

Test GAP RMS for race and step 7750: 0.02618170715868473

Test balanced accuracy for step 7750: 0.6149324178695679


{'epsilon': 0.1, 'lr': 0.0001, 'wlr': 5e-06, 'w_reg': 50.0}
Final test accuracy: 0.8111664056777954
Final test GAP RMS for gender: 0.003488829592242837
Final test GAP RMS for race: 0.026953263208270073
Final test balanced accuracy: 0.6178153157234192


