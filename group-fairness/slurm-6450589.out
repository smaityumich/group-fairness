2020-05-21 16:32:41.398713: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:41.400984: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:41.401010: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2020-05-21 16:32:47.023111: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:47.023519: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)
2020-05-21 16:32:47.023545: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (gl3156.arc-ts.umich.edu): /proc/driver/nvidia/version does not exist
2020-05-21 16:32:47.023873: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-05-21 16:32:47.031494: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3000000000 Hz
2020-05-21 16:32:47.031592: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x555c5299edf0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-05-21 16:32:47.031604: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
/sw/arcts/centos7/python3.6-anaconda/5.2.0/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/array_grad.py:563: _EagerTensorBase.cpu (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.identity instead.
2020-05-21 17:00:01.087080: W tensorflow/python/util/util.cc:319] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1786: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
Test accuracy for step 250: 0.6180210113525391

Test GAP RMS for gender and step 250: 0.12809208035469055

Test GAP RMS for race and step 250: 0.013608935289084911

Test balanced accuracy for step 250: 0.4730907082557678


Test accuracy for step 500: 0.8413488268852234

Test GAP RMS for gender and step 500: 0.1404011994600296

Test GAP RMS for race and step 500: 0.02092784270644188

Test balanced accuracy for step 500: 0.7252651453018188


Test accuracy for step 750: 0.8430072069168091

Test GAP RMS for gender and step 750: 0.04144878312945366

Test GAP RMS for race and step 750: 0.02729007415473461

Test balanced accuracy for step 750: 0.716019868850708


Test accuracy for step 1000: 0.8489773273468018

Test GAP RMS for gender and step 1000: 0.07080358266830444

Test GAP RMS for race and step 1000: 0.04170449078083038

Test balanced accuracy for step 1000: 0.768735408782959


Test accuracy for step 1250: 0.8496406674385071

Test GAP RMS for gender and step 1250: 0.07452616095542908

Test GAP RMS for race and step 1250: 0.03676623851060867

Test balanced accuracy for step 1250: 0.778742790222168


Test accuracy for step 1500: 0.8483139872550964

Test GAP RMS for gender and step 1500: 0.06890968233346939

Test GAP RMS for race and step 1500: 0.040873873978853226

Test balanced accuracy for step 1500: 0.7862007021903992


Test accuracy for step 1750: 0.8483139872550964

Test GAP RMS for gender and step 1750: 0.06546593457460403

Test GAP RMS for race and step 1750: 0.042621176689863205

Test balanced accuracy for step 1750: 0.7840399742126465


Test accuracy for step 2000: 0.8475400805473328

Test GAP RMS for gender and step 2000: 0.06936632841825485

Test GAP RMS for race and step 2000: 0.0427677147090435

Test balanced accuracy for step 2000: 0.7870785593986511


Test accuracy for step 2250: 0.8482034206390381

Test GAP RMS for gender and step 2250: 0.07010117918252945

Test GAP RMS for race and step 2250: 0.04496061056852341

Test balanced accuracy for step 2250: 0.785973310470581


Test accuracy for step 2500: 0.8489773273468018

Test GAP RMS for gender and step 2500: 0.069614939391613

Test GAP RMS for race and step 2500: 0.04721963405609131

Test balanced accuracy for step 2500: 0.7928125858306885


Test accuracy for step 2750: 0.8495301008224487

Test GAP RMS for gender and step 2750: 0.06405314803123474

Test GAP RMS for race and step 2750: 0.038958653807640076

Test balanced accuracy for step 2750: 0.7907083034515381


Test accuracy for step 3000: 0.8476506471633911

Test GAP RMS for gender and step 3000: 0.07188387215137482

Test GAP RMS for race and step 3000: 0.04635274037718773

Test balanced accuracy for step 3000: 0.7933251857757568


Test accuracy for step 3250: 0.8478717803955078

Test GAP RMS for gender and step 3250: 0.07664856314659119

Test GAP RMS for race and step 3250: 0.052351564168930054

Test balanced accuracy for step 3250: 0.7962493896484375


Test accuracy for step 3500: 0.8498618006706238

Test GAP RMS for gender and step 3500: 0.062378861010074615

Test GAP RMS for race and step 3500: 0.037140343338251114

Test balanced accuracy for step 3500: 0.7906187176704407


Test accuracy for step 3750: 0.8478717803955078

Test GAP RMS for gender and step 3750: 0.0645739957690239

Test GAP RMS for race and step 3750: 0.047728028148412704

Test balanced accuracy for step 3750: 0.7971754670143127


Test accuracy for step 4000: 0.8477612137794495

Test GAP RMS for gender and step 4000: 0.07170308381319046

Test GAP RMS for race and step 4000: 0.052161186933517456

Test balanced accuracy for step 4000: 0.7980284690856934


Test accuracy for step 4250: 0.842675507068634

Test GAP RMS for gender and step 4250: 0.07989462465047836

Test GAP RMS for race and step 4250: 0.04432660713791847

Test balanced accuracy for step 4250: 0.8017685413360596


Test accuracy for step 4500: 0.8420121669769287

Test GAP RMS for gender and step 4500: 0.07940629124641418

Test GAP RMS for race and step 4500: 0.053656406700611115

Test balanced accuracy for step 4500: 0.8050345182418823


Test accuracy for step 4750: 0.8401326537132263

Test GAP RMS for gender and step 4750: 0.07327382266521454

Test GAP RMS for race and step 4750: 0.05545966327190399

Test balanced accuracy for step 4750: 0.8041015863418579


Test accuracy for step 5000: 0.8316196799278259

Test GAP RMS for gender and step 5000: 0.08223672956228256

Test GAP RMS for race and step 5000: 0.05318396911025047

Test balanced accuracy for step 5000: 0.8106707334518433


Test accuracy for step 5250: 0.838032066822052

Test GAP RMS for gender and step 5250: 0.08120962232351303

Test GAP RMS for race and step 5250: 0.052142951637506485

Test balanced accuracy for step 5250: 0.8051833510398865


Test accuracy for step 5500: 0.8361525535583496

Test GAP RMS for gender and step 5500: 0.07915886491537094

Test GAP RMS for race and step 5500: 0.05054834112524986

Test balanced accuracy for step 5500: 0.8045591115951538


Test accuracy for step 5750: 0.8216694593429565

Test GAP RMS for gender and step 5750: 0.0851263701915741

Test GAP RMS for race and step 5750: 0.05300624668598175

Test balanced accuracy for step 5750: 0.8133580088615417


Test accuracy for step 6000: 0.8201215863227844

Test GAP RMS for gender and step 6000: 0.08829803764820099

Test GAP RMS for race and step 6000: 0.05219290032982826

Test balanced accuracy for step 6000: 0.8175830841064453


Test accuracy for step 6250: 0.7974571585655212

Test GAP RMS for gender and step 6250: 0.09960000962018967

Test GAP RMS for race and step 6250: 0.053070444613695145

Test balanced accuracy for step 6250: 0.8188166618347168


Test accuracy for step 6500: 0.7610834836959839

Test GAP RMS for gender and step 6500: 0.10667752474546432

Test GAP RMS for race and step 6500: 0.059129100292921066

Test balanced accuracy for step 6500: 0.8080613017082214


Test accuracy for step 6750: 0.7940298318862915

Test GAP RMS for gender and step 6750: 0.08819859474897385

Test GAP RMS for race and step 6750: 0.049113016575574875

Test balanced accuracy for step 6750: 0.8153178095817566


Test accuracy for step 7000: 0.7807628512382507

Test GAP RMS for gender and step 7000: 0.09527357667684555

Test GAP RMS for race and step 7000: 0.05243154242634773

Test balanced accuracy for step 7000: 0.8142706155776978


Test accuracy for step 7250: 0.79856276512146

Test GAP RMS for gender and step 7250: 0.08589331805706024

Test GAP RMS for race and step 7250: 0.046573277562856674

Test balanced accuracy for step 7250: 0.8144537210464478


Test accuracy for step 7500: 0.8176893591880798

Test GAP RMS for gender and step 7500: 0.07833757996559143

Test GAP RMS for race and step 7500: 0.03825030475854874

Test balanced accuracy for step 7500: 0.8115004301071167


Test accuracy for step 7750: 0.8224433660507202

Test GAP RMS for gender and step 7750: 0.07875246554613113

Test GAP RMS for race and step 7750: 0.04739069193601608

Test balanced accuracy for step 7750: 0.8080043196678162


{'epsilon': 0.1, 'lr': 0.0001, 'wlr': 0.001, 'w_reg': 20.0}
Final test accuracy: 0.8056384921073914
Final test GAP RMS for gender: 0.08348219841718674
Final test GAP RMS for race: 0.05497187003493309
Final test balanced accuracy: 0.8111022710800171


