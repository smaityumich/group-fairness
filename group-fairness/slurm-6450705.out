2020-05-21 16:32:44.874805: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:44.875498: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:44.875510: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2020-05-21 16:32:50.708279: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:50.708501: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)
2020-05-21 16:32:50.708522: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (gl3168.arc-ts.umich.edu): /proc/driver/nvidia/version does not exist
2020-05-21 16:32:50.708842: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-05-21 16:32:50.715861: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3000000000 Hz
2020-05-21 16:32:50.715952: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5584caa534e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-05-21 16:32:50.715962: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
/sw/arcts/centos7/python3.6-anaconda/5.2.0/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/array_grad.py:563: _EagerTensorBase.cpu (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.identity instead.
2020-05-21 16:59:07.696413: W tensorflow/python/util/util.cc:319] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1786: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
Test accuracy for step 250: 0.6189054846763611

Test GAP RMS for gender and step 250: 0.1276707500219345

Test GAP RMS for race and step 250: 0.013710021041333675

Test balanced accuracy for step 250: 0.4749097228050232


Test accuracy for step 500: 0.834273099899292

Test GAP RMS for gender and step 500: 0.34789568185806274

Test GAP RMS for race and step 500: 0.04785005748271942

Test balanced accuracy for step 500: 0.7323207855224609


Test accuracy for step 750: 0.843559980392456

Test GAP RMS for gender and step 750: 0.23650945723056793

Test GAP RMS for race and step 750: 0.04786081984639168

Test balanced accuracy for step 750: 0.742931604385376


Test accuracy for step 1000: 0.8437811136245728

Test GAP RMS for gender and step 1000: 0.1765083223581314

Test GAP RMS for race and step 1000: 0.0406179204583168

Test balanced accuracy for step 1000: 0.7319651246070862


Test accuracy for step 1250: 0.8453289270401001

Test GAP RMS for gender and step 1250: 0.14581486582756042

Test GAP RMS for race and step 1250: 0.033480048179626465

Test balanced accuracy for step 1250: 0.732987642288208


Test accuracy for step 1500: 0.846434473991394

Test GAP RMS for gender and step 1500: 0.12703748047351837

Test GAP RMS for race and step 1500: 0.03438207879662514

Test balanced accuracy for step 1500: 0.7355700731277466


Test accuracy for step 1750: 0.8470978736877441

Test GAP RMS for gender and step 1750: 0.11393304914236069

Test GAP RMS for race and step 1750: 0.030907701700925827

Test balanced accuracy for step 1750: 0.7358539700508118


Test accuracy for step 2000: 0.8465450406074524

Test GAP RMS for gender and step 2000: 0.10761426389217377

Test GAP RMS for race and step 2000: 0.036963120102882385

Test balanced accuracy for step 2000: 0.7320932745933533


Test accuracy for step 2250: 0.8446655869483948

Test GAP RMS for gender and step 2250: 0.09005236625671387

Test GAP RMS for race and step 2250: 0.026323698461055756

Test balanced accuracy for step 2250: 0.7200478315353394


Test accuracy for step 2500: 0.8413488268852234

Test GAP RMS for gender and step 2500: 0.07123488932847977

Test GAP RMS for race and step 2500: 0.01569114439189434

Test balanced accuracy for step 2500: 0.7121461629867554


Test accuracy for step 2750: 0.8425649404525757

Test GAP RMS for gender and step 2750: 0.05846313759684563

Test GAP RMS for race and step 2750: 0.01845747046172619

Test balanced accuracy for step 2750: 0.7129495739936829


Test accuracy for step 3000: 0.8395798802375793

Test GAP RMS for gender and step 3000: 0.045748114585876465

Test GAP RMS for race and step 3000: 0.010136081837117672

Test balanced accuracy for step 3000: 0.7017171382904053


Test accuracy for step 3250: 0.8391376733779907

Test GAP RMS for gender and step 3250: 0.03237123042345047

Test GAP RMS for race and step 3250: 0.00942169688642025

Test balanced accuracy for step 3250: 0.6944797039031982


Test accuracy for step 3500: 0.839469313621521

Test GAP RMS for gender and step 3500: 0.02128058671951294

Test GAP RMS for race and step 3500: 0.009567352011799812

Test balanced accuracy for step 3500: 0.6954704523086548


Test accuracy for step 3750: 0.8378109335899353

Test GAP RMS for gender and step 3750: 0.015840519219636917

Test GAP RMS for race and step 3750: 0.016756877303123474

Test balanced accuracy for step 3750: 0.690516471862793


Test accuracy for step 4000: 0.832504153251648

Test GAP RMS for gender and step 4000: 0.010191710665822029

Test GAP RMS for race and step 4000: 0.009992633946239948

Test balanced accuracy for step 4000: 0.6749721765518188


Test accuracy for step 4250: 0.8283029198646545

Test GAP RMS for gender and step 4250: 0.007429412100464106

Test GAP RMS for race and step 4250: 0.02119901403784752

Test balanced accuracy for step 4250: 0.663553774356842


Test accuracy for step 4500: 0.8256495594978333

Test GAP RMS for gender and step 4500: 0.010764009319245815

Test GAP RMS for race and step 4500: 0.0028585167601704597

Test balanced accuracy for step 4500: 0.6539295315742493


Test accuracy for step 4750: 0.8277501463890076

Test GAP RMS for gender and step 4750: 0.018099265173077583

Test GAP RMS for race and step 4750: 0.007582681719213724

Test balanced accuracy for step 4750: 0.660719096660614


Test accuracy for step 5000: 0.8227750062942505

Test GAP RMS for gender and step 5000: 0.010134088806807995

Test GAP RMS for race and step 5000: 0.002796895569190383

Test balanced accuracy for step 5000: 0.6467829942703247


Test accuracy for step 5250: 0.8223327994346619

Test GAP RMS for gender and step 5250: 0.011305258609354496

Test GAP RMS for race and step 5250: 0.007165455259382725

Test balanced accuracy for step 5250: 0.6447930932044983


Test accuracy for step 5500: 0.8199005126953125

Test GAP RMS for gender and step 5500: 0.019266854971647263

Test GAP RMS for race and step 5500: 0.015696970745921135

Test balanced accuracy for step 5500: 0.6387104988098145


Test accuracy for step 5750: 0.8171365261077881

Test GAP RMS for gender and step 5750: 0.021892791613936424

Test GAP RMS for race and step 5750: 0.021077100187540054

Test balanced accuracy for step 5750: 0.632563054561615


Test accuracy for step 6000: 0.8151465058326721

Test GAP RMS for gender and step 6000: 0.0237966887652874

Test GAP RMS for race and step 6000: 0.010536843910813332

Test balanced accuracy for step 6000: 0.6283159255981445


Test accuracy for step 6250: 0.80983966588974

Test GAP RMS for gender and step 6250: 0.019857168197631836

Test GAP RMS for race and step 6250: 0.01783815026283264

Test balanced accuracy for step 6250: 0.6146237850189209


Test accuracy for step 6500: 0.8088446855545044

Test GAP RMS for gender and step 6500: 0.018397653475403786

Test GAP RMS for race and step 6500: 0.01429750956594944

Test balanced accuracy for step 6500: 0.6124230027198792


Test accuracy for step 6750: 0.8042012453079224

Test GAP RMS for gender and step 6750: 0.02230711840093136

Test GAP RMS for race and step 6750: 0.007333140820264816

Test balanced accuracy for step 6750: 0.6013298034667969


Test accuracy for step 7000: 0.804643452167511

Test GAP RMS for gender and step 7000: 0.020423810929059982

Test GAP RMS for race and step 7000: 0.009105723351240158

Test balanced accuracy for step 7000: 0.602393627166748


Test accuracy for step 7250: 0.7960199117660522

Test GAP RMS for gender and step 7250: 0.028223035857081413

Test GAP RMS for race and step 7250: 0.0003595803282223642

Test balanced accuracy for step 7250: 0.5828062295913696


Test accuracy for step 7500: 0.7900497317314148

Test GAP RMS for gender and step 7500: 0.027293460443615913

Test GAP RMS for race and step 7500: 0.009502221830189228

Test balanced accuracy for step 7500: 0.5696018934249878


Test accuracy for step 7750: 0.7910447716712952

Test GAP RMS for gender and step 7750: 0.028738342225551605

Test GAP RMS for race and step 7750: 0.002161460928618908

Test balanced accuracy for step 7750: 0.5718026161193848


{'epsilon': 0.01, 'lr': 0.0001, 'wlr': 5e-06, 'w_reg': 60.0}
Final test accuracy: 0.7847429513931274
Final test GAP RMS for gender: 0.023348545655608177
Final test GAP RMS for race: 0.008752292022109032
Final test balanced accuracy: 0.5580704808235168


