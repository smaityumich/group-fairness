2020-05-21 16:32:44.739910: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:44.740631: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:44.740644: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2020-05-21 16:32:50.547862: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:50.548018: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)
2020-05-21 16:32:50.548041: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (gl3167.arc-ts.umich.edu): /proc/driver/nvidia/version does not exist
2020-05-21 16:32:50.548368: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-05-21 16:32:50.555366: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3000000000 Hz
2020-05-21 16:32:50.555455: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55bd2736f060 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-05-21 16:32:50.555465: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
/sw/arcts/centos7/python3.6-anaconda/5.2.0/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/array_grad.py:563: _EagerTensorBase.cpu (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.identity instead.
2020-05-21 16:59:09.498703: W tensorflow/python/util/util.cc:319] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1786: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
Test accuracy for step 250: 0.6193476915359497

Test GAP RMS for gender and step 250: 0.12738052010536194

Test GAP RMS for race and step 250: 0.013404861092567444

Test balanced accuracy for step 250: 0.476436585187912


Test accuracy for step 500: 0.8274184465408325

Test GAP RMS for gender and step 500: 0.36901092529296875

Test GAP RMS for race and step 500: 0.10034550726413727

Test balanced accuracy for step 500: 0.7739404439926147


Test accuracy for step 750: 0.8339414000511169

Test GAP RMS for gender and step 750: 0.3110046982765198

Test GAP RMS for race and step 750: 0.07406817376613617

Test balanced accuracy for step 750: 0.7882816791534424


Test accuracy for step 1000: 0.8424543738365173

Test GAP RMS for gender and step 1000: 0.2812923192977905

Test GAP RMS for race and step 1000: 0.08111199736595154

Test balanced accuracy for step 1000: 0.7861883640289307


Test accuracy for step 1250: 0.8444444537162781

Test GAP RMS for gender and step 1250: 0.2729765474796295

Test GAP RMS for race and step 1250: 0.08301623165607452

Test balanced accuracy for step 1250: 0.7884290218353271


Test accuracy for step 1500: 0.8443338871002197

Test GAP RMS for gender and step 1500: 0.2613794803619385

Test GAP RMS for race and step 1500: 0.0750359520316124

Test balanced accuracy for step 1500: 0.7922145128250122


Test accuracy for step 1750: 0.8421227335929871

Test GAP RMS for gender and step 1750: 0.26832401752471924

Test GAP RMS for race and step 1750: 0.07789935171604156

Test balanced accuracy for step 1750: 0.7892104387283325


Test accuracy for step 2000: 0.8415699005126953

Test GAP RMS for gender and step 2000: 0.26695549488067627

Test GAP RMS for race and step 2000: 0.07165073603391647

Test balanced accuracy for step 2000: 0.7891539335250854


Test accuracy for step 2250: 0.844997227191925

Test GAP RMS for gender and step 2250: 0.2586308419704437

Test GAP RMS for race and step 2250: 0.07508385181427002

Test balanced accuracy for step 2250: 0.788022518157959


Test accuracy for step 2500: 0.8458817005157471

Test GAP RMS for gender and step 2500: 0.2435224950313568

Test GAP RMS for race and step 2500: 0.06488869339227676

Test balanced accuracy for step 2500: 0.7904589176177979


Test accuracy for step 2750: 0.842343807220459

Test GAP RMS for gender and step 2750: 0.2631419599056244

Test GAP RMS for race and step 2750: 0.07028482109308243

Test balanced accuracy for step 2750: 0.7929062843322754


Test accuracy for step 3000: 0.839469313621521

Test GAP RMS for gender and step 3000: 0.27221059799194336

Test GAP RMS for race and step 3000: 0.07012132555246353

Test balanced accuracy for step 3000: 0.7944028973579407


Test accuracy for step 3250: 0.8433388471603394

Test GAP RMS for gender and step 3250: 0.2566608190536499

Test GAP RMS for race and step 3250: 0.06681130081415176

Test balanced accuracy for step 3250: 0.7938723564147949


Test accuracy for step 3500: 0.8436705470085144

Test GAP RMS for gender and step 3500: 0.24927350878715515

Test GAP RMS for race and step 3500: 0.06447811424732208

Test balanced accuracy for step 3500: 0.794245719909668


Test accuracy for step 3750: 0.838916540145874

Test GAP RMS for gender and step 3750: 0.26007288694381714

Test GAP RMS for race and step 3750: 0.06766749173402786

Test balanced accuracy for step 3750: 0.7994396686553955


Test accuracy for step 4000: 0.839469313621521

Test GAP RMS for gender and step 4000: 0.26543450355529785

Test GAP RMS for race and step 4000: 0.06244455277919769

Test balanced accuracy for step 4000: 0.7953289747238159


Test accuracy for step 4250: 0.8381426334381104

Test GAP RMS for gender and step 4250: 0.26677191257476807

Test GAP RMS for race and step 4250: 0.06740009784698486

Test balanced accuracy for step 4250: 0.7955329418182373


Test accuracy for step 4500: 0.8448866605758667

Test GAP RMS for gender and step 4500: 0.2416897714138031

Test GAP RMS for race and step 4500: 0.06059060990810394

Test balanced accuracy for step 4500: 0.7914993762969971


Test accuracy for step 4750: 0.8388059735298157

Test GAP RMS for gender and step 4750: 0.2517251670360565

Test GAP RMS for race and step 4750: 0.06695139408111572

Test balanced accuracy for step 4750: 0.7987492084503174


Test accuracy for step 5000: 0.839469313621521

Test GAP RMS for gender and step 5000: 0.25658923387527466

Test GAP RMS for race and step 5000: 0.06838100403547287

Test balanced accuracy for step 5000: 0.7985700964927673


Test accuracy for step 5250: 0.8375898003578186

Test GAP RMS for gender and step 5250: 0.2586146891117096

Test GAP RMS for race and step 5250: 0.06780402362346649

Test balanced accuracy for step 5250: 0.7984088659286499


Test accuracy for step 5500: 0.8396904468536377

Test GAP RMS for gender and step 5500: 0.24265936017036438

Test GAP RMS for race and step 5500: 0.0662466511130333

Test balanced accuracy for step 5500: 0.8005682229995728


Test accuracy for step 5750: 0.8388059735298157

Test GAP RMS for gender and step 5750: 0.24115905165672302

Test GAP RMS for race and step 5750: 0.07167158275842667

Test balanced accuracy for step 5750: 0.8018360733985901


Test accuracy for step 6000: 0.8349364399909973

Test GAP RMS for gender and step 6000: 0.26048776507377625

Test GAP RMS for race and step 6000: 0.06839068979024887

Test balanced accuracy for step 6000: 0.8062251806259155


Test accuracy for step 6250: 0.8364842534065247

Test GAP RMS for gender and step 6250: 0.2667497992515564

Test GAP RMS for race and step 6250: 0.06885921210050583

Test balanced accuracy for step 6250: 0.8072476387023926


Test accuracy for step 6500: 0.8347153067588806

Test GAP RMS for gender and step 6500: 0.25916776061058044

Test GAP RMS for race and step 6500: 0.07317304611206055

Test balanced accuracy for step 6500: 0.8066964149475098


Test accuracy for step 6750: 0.838032066822052

Test GAP RMS for gender and step 6750: 0.24199236929416656

Test GAP RMS for race and step 6750: 0.0632346048951149

Test balanced accuracy for step 6750: 0.8033312559127808


Test accuracy for step 7000: 0.8353786468505859

Test GAP RMS for gender and step 7000: 0.25614243745803833

Test GAP RMS for race and step 7000: 0.06621765345335007

Test balanced accuracy for step 7000: 0.8086780905723572


Test accuracy for step 7250: 0.8347153067588806

Test GAP RMS for gender and step 7250: 0.2538135349750519

Test GAP RMS for race and step 7250: 0.06433343887329102

Test balanced accuracy for step 7250: 0.8082398772239685


Test accuracy for step 7500: 0.8327252864837646

Test GAP RMS for gender and step 7500: 0.26194602251052856

Test GAP RMS for race and step 7500: 0.068549744784832

Test balanced accuracy for step 7500: 0.8075425624847412


Test accuracy for step 7750: 0.83338862657547

Test GAP RMS for gender and step 7750: 0.2518019676208496

Test GAP RMS for race and step 7750: 0.0641389787197113

Test balanced accuracy for step 7750: 0.8115306496620178


{'epsilon': 1e-05, 'lr': 0.0001, 'wlr': 1e-06, 'w_reg': 50.0}
Final test accuracy: 0.8341625332832336
Final test GAP RMS for gender: 0.2430979162454605
Final test GAP RMS for race: 0.06607095152139664
Final test balanced accuracy: 0.8104984760284424


