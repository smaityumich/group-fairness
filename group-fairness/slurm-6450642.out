2020-05-21 16:32:43.111487: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:43.112090: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:43.112104: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2020-05-21 16:32:52.985408: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:52.985647: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)
2020-05-21 16:32:52.985675: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (gl3108.arc-ts.umich.edu): /proc/driver/nvidia/version does not exist
2020-05-21 16:32:52.986049: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-05-21 16:32:52.993117: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3000000000 Hz
2020-05-21 16:32:52.993221: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x56440e6ac7c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-05-21 16:32:52.993232: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
/sw/arcts/centos7/python3.6-anaconda/5.2.0/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/array_grad.py:563: _EagerTensorBase.cpu (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.identity instead.
2020-05-21 16:58:55.744836: W tensorflow/python/util/util.cc:319] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1786: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
Test accuracy for step 250: 0.608734130859375

Test GAP RMS for gender and step 250: 0.133192241191864

Test GAP RMS for race and step 250: 0.01879204995930195

Test balanced accuracy for step 250: 0.4833158552646637


Test accuracy for step 500: 0.808402419090271

Test GAP RMS for gender and step 500: 0.14753000438213348

Test GAP RMS for race and step 500: 0.05527409166097641

Test balanced accuracy for step 500: 0.8106130361557007


Test accuracy for step 750: 0.8059701323509216

Test GAP RMS for gender and step 750: 0.06776512414216995

Test GAP RMS for race and step 750: 0.050076939165592194

Test balanced accuracy for step 750: 0.8077715635299683


Test accuracy for step 1000: 0.8173576593399048

Test GAP RMS for gender and step 1000: 0.0677078515291214

Test GAP RMS for race and step 1000: 0.05383778363466263

Test balanced accuracy for step 1000: 0.804181694984436


Test accuracy for step 1250: 0.8133775591850281

Test GAP RMS for gender and step 1250: 0.07527951151132584

Test GAP RMS for race and step 1250: 0.0486871637403965

Test balanced accuracy for step 1250: 0.8074173927307129


Test accuracy for step 1500: 0.807517945766449

Test GAP RMS for gender and step 1500: 0.07165064662694931

Test GAP RMS for race and step 1500: 0.04215395823121071

Test balanced accuracy for step 1500: 0.8067876100540161


Test accuracy for step 1750: 0.8053067922592163

Test GAP RMS for gender and step 1750: 0.06665132194757462

Test GAP RMS for race and step 1750: 0.049274079501628876

Test balanced accuracy for step 1750: 0.8077963590621948


Test accuracy for step 2000: 0.8070757389068604

Test GAP RMS for gender and step 2000: 0.06730802357196808

Test GAP RMS for race and step 2000: 0.0473877377808094

Test balanced accuracy for step 2000: 0.8097366690635681


Test accuracy for step 2250: 0.812493085861206

Test GAP RMS for gender and step 2250: 0.07377409934997559

Test GAP RMS for race and step 2250: 0.03896027058362961

Test balanced accuracy for step 2250: 0.804517924785614


Test accuracy for step 2500: 0.776229977607727

Test GAP RMS for gender and step 2500: 0.06819836795330048

Test GAP RMS for race and step 2500: 0.04156337305903435

Test balanced accuracy for step 2500: 0.8092697262763977


Test accuracy for step 2750: 0.8022111654281616

Test GAP RMS for gender and step 2750: 0.06772463023662567

Test GAP RMS for race and step 2750: 0.047273628413677216

Test balanced accuracy for step 2750: 0.8094555735588074


Test accuracy for step 3000: 0.8082918524742126

Test GAP RMS for gender and step 3000: 0.06747999787330627

Test GAP RMS for race and step 3000: 0.04498869553208351

Test balanced accuracy for step 3000: 0.8093053102493286


Test accuracy for step 3250: 0.8123825192451477

Test GAP RMS for gender and step 3250: 0.0695311427116394

Test GAP RMS for race and step 3250: 0.043440088629722595

Test balanced accuracy for step 3250: 0.8078404068946838


Test accuracy for step 3500: 0.806965172290802

Test GAP RMS for gender and step 3500: 0.0758991688489914

Test GAP RMS for race and step 3500: 0.044885024428367615

Test balanced accuracy for step 3500: 0.8065767884254456


Test accuracy for step 3750: 0.809286892414093

Test GAP RMS for gender and step 3750: 0.0766298770904541

Test GAP RMS for race and step 3750: 0.041983868926763535

Test balanced accuracy for step 3750: 0.8065670728683472


Test accuracy for step 4000: 0.8164731860160828

Test GAP RMS for gender and step 4000: 0.07390975952148438

Test GAP RMS for race and step 4000: 0.04045863077044487

Test balanced accuracy for step 4000: 0.8066841959953308


Test accuracy for step 4250: 0.8155887126922607

Test GAP RMS for gender and step 4250: 0.07687404751777649

Test GAP RMS for race and step 4250: 0.041763391345739365

Test balanced accuracy for step 4250: 0.8059455752372742


Test accuracy for step 4500: 0.8186843395233154

Test GAP RMS for gender and step 4500: 0.07936497777700424

Test GAP RMS for race and step 4500: 0.037444818764925

Test balanced accuracy for step 4500: 0.8030516505241394


Test accuracy for step 4750: 0.8085129857063293

Test GAP RMS for gender and step 4750: 0.07665977627038956

Test GAP RMS for race and step 4750: 0.04242207109928131

Test balanced accuracy for step 4750: 0.8052841424942017


Test accuracy for step 5000: 0.8131564259529114

Test GAP RMS for gender and step 5000: 0.08121401071548462

Test GAP RMS for race and step 5000: 0.03677358105778694

Test balanced accuracy for step 5000: 0.8037214279174805


Test accuracy for step 5250: 0.8163626194000244

Test GAP RMS for gender and step 5250: 0.08026713132858276

Test GAP RMS for race and step 5250: 0.037065401673316956

Test balanced accuracy for step 5250: 0.8030613660812378


Test accuracy for step 5500: 0.8156992793083191

Test GAP RMS for gender and step 5500: 0.07956057041883469

Test GAP RMS for race and step 5500: 0.034454599022865295

Test balanced accuracy for step 5500: 0.8038578033447266


Test accuracy for step 5750: 0.8086235523223877

Test GAP RMS for gender and step 5750: 0.07857407629489899

Test GAP RMS for race and step 5750: 0.04353104531764984

Test balanced accuracy for step 5750: 0.8059746026992798


Test accuracy for step 6000: 0.807849645614624

Test GAP RMS for gender and step 6000: 0.07510577142238617

Test GAP RMS for race and step 6000: 0.04595058783888817

Test balanced accuracy for step 6000: 0.8057720065116882


Test accuracy for step 6250: 0.8110558390617371

Test GAP RMS for gender and step 6250: 0.07128515839576721

Test GAP RMS for race and step 6250: 0.043948039412498474

Test balanced accuracy for step 6250: 0.8072726726531982


Test accuracy for step 6500: 0.8113874793052673

Test GAP RMS for gender and step 6500: 0.07403308153152466

Test GAP RMS for race and step 6500: 0.041607923805713654

Test balanced accuracy for step 6500: 0.8081091642379761


Test accuracy for step 6750: 0.8137092590332031

Test GAP RMS for gender and step 6750: 0.09028545767068863

Test GAP RMS for race and step 6750: 0.03270271420478821

Test balanced accuracy for step 6750: 0.7976043224334717


Test accuracy for step 7000: 0.8044223189353943

Test GAP RMS for gender and step 7000: 0.07324539124965668

Test GAP RMS for race and step 7000: 0.041654396802186966

Test balanced accuracy for step 7000: 0.805823028087616


Test accuracy for step 7250: 0.8150359392166138

Test GAP RMS for gender and step 7250: 0.07831486314535141

Test GAP RMS for race and step 7250: 0.0425877682864666

Test balanced accuracy for step 7250: 0.8051173686981201


Test accuracy for step 7500: 0.8133775591850281

Test GAP RMS for gender and step 7500: 0.07246986031532288

Test GAP RMS for race and step 7500: 0.038037221878767014

Test balanced accuracy for step 7500: 0.8066456317901611


Test accuracy for step 7750: 0.8099502325057983

Test GAP RMS for gender and step 7750: 0.07586852461099625

Test GAP RMS for race and step 7750: 0.03878699243068695

Test balanced accuracy for step 7750: 0.8025294542312622


{'epsilon': 0.0001, 'lr': 0.0001, 'wlr': 0.001, 'w_reg': 40.0}
Final test accuracy: 0.8085129857063293
Final test GAP RMS for gender: 0.07782062143087387
Final test GAP RMS for race: 0.03987972065806389
Final test balanced accuracy: 0.8014256954193115


