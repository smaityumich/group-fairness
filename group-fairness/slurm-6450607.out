2020-05-21 16:32:41.098541: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:41.099625: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:41.099636: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2020-05-21 16:32:47.184493: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:47.184858: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)
2020-05-21 16:32:47.184880: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (gl3100.arc-ts.umich.edu): /proc/driver/nvidia/version does not exist
2020-05-21 16:32:47.185192: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-05-21 16:32:47.192005: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3000000000 Hz
2020-05-21 16:32:47.192088: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x559d422f6700 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-05-21 16:32:47.192098: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
/sw/arcts/centos7/python3.6-anaconda/5.2.0/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/array_grad.py:563: _EagerTensorBase.cpu (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.identity instead.
2020-05-21 16:58:19.855492: W tensorflow/python/util/util.cc:319] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1786: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
Test accuracy for step 250: 0.6183526515960693

Test GAP RMS for gender and step 250: 0.12758155167102814

Test GAP RMS for race and step 250: 0.014811791479587555

Test balanced accuracy for step 250: 0.48056384921073914


Test accuracy for step 500: 0.8095080256462097

Test GAP RMS for gender and step 500: 0.3335588574409485

Test GAP RMS for race and step 500: 0.08134765177965164

Test balanced accuracy for step 500: 0.7999222278594971


Test accuracy for step 750: 0.8236594796180725

Test GAP RMS for gender and step 750: 0.2442551553249359

Test GAP RMS for race and step 750: 0.06941938400268555

Test balanced accuracy for step 750: 0.8115858435630798


Test accuracy for step 1000: 0.8304035663604736

Test GAP RMS for gender and step 1000: 0.22049537301063538

Test GAP RMS for race and step 1000: 0.07952505350112915

Test balanced accuracy for step 1000: 0.8097130060195923


Test accuracy for step 1250: 0.8301824331283569

Test GAP RMS for gender and step 1250: 0.20976465940475464

Test GAP RMS for race and step 1250: 0.07414528727531433

Test balanced accuracy for step 1250: 0.8108016848564148


Test accuracy for step 1500: 0.8285240530967712

Test GAP RMS for gender and step 1500: 0.2012767344713211

Test GAP RMS for race and step 1500: 0.06780735403299332

Test balanced accuracy for step 1500: 0.8155710697174072


Test accuracy for step 1750: 0.8254284262657166

Test GAP RMS for gender and step 1750: 0.21355073153972626

Test GAP RMS for race and step 1750: 0.061780571937561035

Test balanced accuracy for step 1750: 0.8159955739974976


Test accuracy for step 2000: 0.8237700462341309

Test GAP RMS for gender and step 2000: 0.21107099950313568

Test GAP RMS for race and step 2000: 0.05986815690994263

Test balanced accuracy for step 2000: 0.8182955384254456


Test accuracy for step 2250: 0.8279712796211243

Test GAP RMS for gender and step 2250: 0.20278386771678925

Test GAP RMS for race and step 2250: 0.06280738860368729

Test balanced accuracy for step 2250: 0.8184471130371094


Test accuracy for step 2500: 0.8281923532485962

Test GAP RMS for gender and step 2500: 0.19242963194847107

Test GAP RMS for race and step 2500: 0.06109234690666199

Test balanced accuracy for step 2500: 0.8205995559692383


Test accuracy for step 2750: 0.8231067061424255

Test GAP RMS for gender and step 2750: 0.19994571805000305

Test GAP RMS for race and step 2750: 0.0600116066634655

Test balanced accuracy for step 2750: 0.8232592344284058


Test accuracy for step 3000: 0.8229961395263672

Test GAP RMS for gender and step 3000: 0.20453102886676788

Test GAP RMS for race and step 3000: 0.060260653495788574

Test balanced accuracy for step 3000: 0.8227231502532959


Test accuracy for step 3250: 0.8237700462341309

Test GAP RMS for gender and step 3250: 0.20302362740039825

Test GAP RMS for race and step 3250: 0.059402041137218475

Test balanced accuracy for step 3250: 0.8221540451049805


Test accuracy for step 3500: 0.8247650861740112

Test GAP RMS for gender and step 3500: 0.1843067854642868

Test GAP RMS for race and step 3500: 0.056945279240608215

Test balanced accuracy for step 3500: 0.8246634602546692


Test accuracy for step 3750: 0.8227750062942505

Test GAP RMS for gender and step 3750: 0.17980459332466125

Test GAP RMS for race and step 3750: 0.059880875051021576

Test balanced accuracy for step 3750: 0.8258183002471924


Test accuracy for step 4000: 0.8259811997413635

Test GAP RMS for gender and step 4000: 0.18642400205135345

Test GAP RMS for race and step 4000: 0.05628727003931999

Test balanced accuracy for step 4000: 0.8220713138580322


Test accuracy for step 4250: 0.8233277797698975

Test GAP RMS for gender and step 4250: 0.1814204454421997

Test GAP RMS for race and step 4250: 0.0606871172785759

Test balanced accuracy for step 4250: 0.8255660533905029


Test accuracy for step 4500: 0.8300718665122986

Test GAP RMS for gender and step 4500: 0.17060476541519165

Test GAP RMS for race and step 4500: 0.05647064000368118

Test balanced accuracy for step 4500: 0.8247736692428589


Test accuracy for step 4750: 0.8229961395263672

Test GAP RMS for gender and step 4750: 0.16709338128566742

Test GAP RMS for race and step 4750: 0.05999547988176346

Test balanced accuracy for step 4750: 0.827507734298706


Test accuracy for step 5000: 0.8253178596496582

Test GAP RMS for gender and step 5000: 0.16590861976146698

Test GAP RMS for race and step 5000: 0.05896778404712677

Test balanced accuracy for step 5000: 0.8264176845550537


Test accuracy for step 5250: 0.8241016864776611

Test GAP RMS for gender and step 5250: 0.16528823971748352

Test GAP RMS for race and step 5250: 0.06097439303994179

Test balanced accuracy for step 5250: 0.827157735824585


Test accuracy for step 5500: 0.8250967264175415

Test GAP RMS for gender and step 5500: 0.15764251351356506

Test GAP RMS for race and step 5500: 0.06324880570173264

Test balanced accuracy for step 5500: 0.8281236886978149


Test accuracy for step 5750: 0.8229961395263672

Test GAP RMS for gender and step 5750: 0.14957429468631744

Test GAP RMS for race and step 5750: 0.06286301463842392

Test balanced accuracy for step 5750: 0.828742504119873


Test accuracy for step 6000: 0.8217799663543701

Test GAP RMS for gender and step 6000: 0.15208624303340912

Test GAP RMS for race and step 6000: 0.06444854289293289

Test balanced accuracy for step 6000: 0.8294824361801147


Test accuracy for step 6250: 0.8212271928787231

Test GAP RMS for gender and step 6250: 0.15126700699329376

Test GAP RMS for race and step 6250: 0.06196189299225807

Test balanced accuracy for step 6250: 0.8288086652755737


Test accuracy for step 6500: 0.8211166262626648

Test GAP RMS for gender and step 6500: 0.14869162440299988

Test GAP RMS for race and step 6500: 0.06277288496494293

Test balanced accuracy for step 6500: 0.8299703001976013


Test accuracy for step 6750: 0.8262023329734802

Test GAP RMS for gender and step 6750: 0.13471460342407227

Test GAP RMS for race and step 6750: 0.06282150000333786

Test balanced accuracy for step 6750: 0.83008873462677


Test accuracy for step 7000: 0.8208954930305481

Test GAP RMS for gender and step 7000: 0.13955943286418915

Test GAP RMS for race and step 7000: 0.06200515106320381

Test balanced accuracy for step 7000: 0.8284351825714111


Test accuracy for step 7250: 0.8242122530937195

Test GAP RMS for gender and step 7250: 0.14059248566627502

Test GAP RMS for race and step 7250: 0.060170285403728485

Test balanced accuracy for step 7250: 0.8295458555221558


Test accuracy for step 7500: 0.8243228197097778

Test GAP RMS for gender and step 7500: 0.14459489285945892

Test GAP RMS for race and step 7500: 0.06299961358308792

Test balanced accuracy for step 7500: 0.8288471698760986


Test accuracy for step 7750: 0.8220010995864868

Test GAP RMS for gender and step 7750: 0.13031817972660065

Test GAP RMS for race and step 7750: 0.06233222410082817

Test balanced accuracy for step 7750: 0.8288568258285522


{'epsilon': 0.0001, 'lr': 0.0001, 'wlr': 5e-06, 'w_reg': 20.0}
Final test accuracy: 0.8207849860191345
Final test GAP RMS for gender: 0.12703046202659607
Final test GAP RMS for race: 0.061505481600761414
Final test balanced accuracy: 0.8268187046051025


