2020-05-21 16:32:45.144111: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:45.144596: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:45.144608: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2020-05-21 16:32:52.084274: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:52.084505: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)
2020-05-21 16:32:52.084536: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (gl3166.arc-ts.umich.edu): /proc/driver/nvidia/version does not exist
2020-05-21 16:32:52.085028: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-05-21 16:32:52.093279: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3000000000 Hz
2020-05-21 16:32:52.093397: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55b0c2b930d0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-05-21 16:32:52.093408: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
/sw/arcts/centos7/python3.6-anaconda/5.2.0/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/array_grad.py:563: _EagerTensorBase.cpu (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.identity instead.
2020-05-21 16:59:20.348236: W tensorflow/python/util/util.cc:319] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1786: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
Test accuracy for step 250: 0.6194582581520081

Test GAP RMS for gender and step 250: 0.12842831015586853

Test GAP RMS for race and step 250: 0.015196235850453377

Test balanced accuracy for step 250: 0.4785160422325134


Test accuracy for step 500: 0.8151465058326721

Test GAP RMS for gender and step 500: 0.3766013979911804

Test GAP RMS for race and step 500: 0.0888131856918335

Test balanced accuracy for step 500: 0.7857434749603271


Test accuracy for step 750: 0.8263128995895386

Test GAP RMS for gender and step 750: 0.30712971091270447

Test GAP RMS for race and step 750: 0.07991176843643188

Test balanced accuracy for step 750: 0.7989850044250488


Test accuracy for step 1000: 0.8295190930366516

Test GAP RMS for gender and step 1000: 0.2903378903865814

Test GAP RMS for race and step 1000: 0.08463245630264282

Test balanced accuracy for step 1000: 0.8015660643577576


Test accuracy for step 1250: 0.8285240530967712

Test GAP RMS for gender and step 1250: 0.28343623876571655

Test GAP RMS for race and step 1250: 0.07287667691707611

Test balanced accuracy for step 1250: 0.8075453639030457


Test accuracy for step 1500: 0.8244333863258362

Test GAP RMS for gender and step 1500: 0.2625023126602173

Test GAP RMS for race and step 1500: 0.07378824055194855

Test balanced accuracy for step 1500: 0.8111710548400879


Test accuracy for step 1750: 0.8214483261108398

Test GAP RMS for gender and step 1750: 0.2559618651866913

Test GAP RMS for race and step 1750: 0.07027408480644226

Test balanced accuracy for step 1750: 0.8130576610565186


Test accuracy for step 2000: 0.8226644396781921

Test GAP RMS for gender and step 2000: 0.2468172311782837

Test GAP RMS for race and step 2000: 0.06905578821897507

Test balanced accuracy for step 2000: 0.815250039100647


Test accuracy for step 2250: 0.8264234662055969

Test GAP RMS for gender and step 2250: 0.23446261882781982

Test GAP RMS for race and step 2250: 0.07057763636112213

Test balanced accuracy for step 2250: 0.8152638077735901


Test accuracy for step 2500: 0.8280817866325378

Test GAP RMS for gender and step 2500: 0.2099764496088028

Test GAP RMS for race and step 2500: 0.06035500764846802

Test balanced accuracy for step 2500: 0.8174397349357605


Test accuracy for step 2750: 0.8232172727584839

Test GAP RMS for gender and step 2750: 0.21874065697193146

Test GAP RMS for race and step 2750: 0.06325346231460571

Test balanced accuracy for step 2750: 0.8179303407669067


Test accuracy for step 3000: 0.8246545195579529

Test GAP RMS for gender and step 3000: 0.21801385283470154

Test GAP RMS for race and step 3000: 0.06298716366291046

Test balanced accuracy for step 3000: 0.8199601769447327


Test accuracy for step 3250: 0.8263128995895386

Test GAP RMS for gender and step 3250: 0.20047368109226227

Test GAP RMS for race and step 3250: 0.06157887354493141

Test balanced accuracy for step 3250: 0.8199753761291504


Test accuracy for step 3500: 0.8273078799247742

Test GAP RMS for gender and step 3500: 0.17910577356815338

Test GAP RMS for race and step 3500: 0.05695539340376854

Test balanced accuracy for step 3500: 0.8235651254653931


Test accuracy for step 3750: 0.8253178596496582

Test GAP RMS for gender and step 3750: 0.16967369616031647

Test GAP RMS for race and step 3750: 0.05986251309514046

Test balanced accuracy for step 3750: 0.8244112730026245


Test accuracy for step 4000: 0.8277501463890076

Test GAP RMS for gender and step 4000: 0.16361969709396362

Test GAP RMS for race and step 4000: 0.05756765976548195

Test balanced accuracy for step 4000: 0.823857307434082


Test accuracy for step 4250: 0.8237700462341309

Test GAP RMS for gender and step 4250: 0.16077090799808502

Test GAP RMS for race and step 4250: 0.059199608862400055

Test balanced accuracy for step 4250: 0.8241604566574097


Test accuracy for step 4500: 0.8295190930366516

Test GAP RMS for gender and step 4500: 0.14227771759033203

Test GAP RMS for race and step 4500: 0.05855458602309227

Test balanced accuracy for step 4500: 0.8240997791290283


Test accuracy for step 4750: 0.8263128995895386

Test GAP RMS for gender and step 4750: 0.13845351338386536

Test GAP RMS for race and step 4750: 0.06132231652736664

Test balanced accuracy for step 4750: 0.8293901085853577


Test accuracy for step 5000: 0.8281923532485962

Test GAP RMS for gender and step 5000: 0.13272768259048462

Test GAP RMS for race and step 5000: 0.060019321739673615

Test balanced accuracy for step 5000: 0.8269275426864624


Test accuracy for step 5250: 0.8291873931884766

Test GAP RMS for gender and step 5250: 0.1283651888370514

Test GAP RMS for race and step 5250: 0.05670347064733505

Test balanced accuracy for step 5250: 0.8278935551643372


Test accuracy for step 5500: 0.8305140733718872

Test GAP RMS for gender and step 5500: 0.11687744408845901

Test GAP RMS for race and step 5500: 0.05732066556811333

Test balanced accuracy for step 5500: 0.827380895614624


Test accuracy for step 5750: 0.8270868062973022

Test GAP RMS for gender and step 5750: 0.10840147733688354

Test GAP RMS for race and step 5750: 0.06086840480566025

Test balanced accuracy for step 5750: 0.826042890548706


Test accuracy for step 6000: 0.8264234662055969

Test GAP RMS for gender and step 6000: 0.11267802119255066

Test GAP RMS for race and step 6000: 0.05865130200982094

Test balanced accuracy for step 6000: 0.8260676860809326


Test accuracy for step 6250: 0.8283029198646545

Test GAP RMS for gender and step 6250: 0.10926752537488937

Test GAP RMS for race and step 6250: 0.05961371958255768

Test balanced accuracy for step 6250: 0.8254572153091431


Test accuracy for step 6500: 0.8281923532485962

Test GAP RMS for gender and step 6500: 0.1015961766242981

Test GAP RMS for race and step 6500: 0.06069879233837128

Test balanced accuracy for step 6500: 0.8255385160446167


Test accuracy for step 6750: 0.8298507332801819

Test GAP RMS for gender and step 6750: 0.09216249734163284

Test GAP RMS for race and step 6750: 0.05665542185306549

Test balanced accuracy for step 6750: 0.8210777044296265


Test accuracy for step 7000: 0.8276395797729492

Test GAP RMS for gender and step 7000: 0.09003394097089767

Test GAP RMS for race and step 7000: 0.0556560717523098

Test balanced accuracy for step 7000: 0.8210060596466064


Test accuracy for step 7250: 0.8289662599563599

Test GAP RMS for gender and step 7250: 0.09372236579656601

Test GAP RMS for race and step 7250: 0.054970815777778625

Test balanced accuracy for step 7250: 0.8192586898803711


Test accuracy for step 7500: 0.8297401666641235

Test GAP RMS for gender and step 7500: 0.09200479090213776

Test GAP RMS for race and step 7500: 0.05465278774499893

Test balanced accuracy for step 7500: 0.8189982771873474


Test accuracy for step 7750: 0.8244333863258362

Test GAP RMS for gender and step 7750: 0.08540485054254532

Test GAP RMS for race and step 7750: 0.0570862777531147

Test balanced accuracy for step 7750: 0.8173446655273438


{'epsilon': 0.0001, 'lr': 0.0001, 'wlr': 1e-05, 'w_reg': 50.0}
Final test accuracy: 0.8238806128501892
Final test GAP RMS for gender: 0.08257965743541718
Final test GAP RMS for race: 0.05458669736981392
Final test balanced accuracy: 0.8135839700698853


