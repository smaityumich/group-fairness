2020-05-21 16:32:41.570705: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:41.571784: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:41.571799: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2020-05-21 16:32:47.589106: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:47.589269: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)
2020-05-21 16:32:47.589301: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (gl3157.arc-ts.umich.edu): /proc/driver/nvidia/version does not exist
2020-05-21 16:32:47.589750: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-05-21 16:32:47.596475: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3000000000 Hz
2020-05-21 16:32:47.596585: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x559a4b92c310 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-05-21 16:32:47.596595: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
/sw/arcts/centos7/python3.6-anaconda/5.2.0/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/array_grad.py:563: _EagerTensorBase.cpu (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.identity instead.
2020-05-21 17:00:34.918847: W tensorflow/python/util/util.cc:319] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1786: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
Test accuracy for step 250: 0.5962409973144531

Test GAP RMS for gender and step 250: 0.1441928744316101

Test GAP RMS for race and step 250: 0.026104332879185677

Test balanced accuracy for step 250: 0.478303998708725


Test accuracy for step 500: 0.7626312971115112

Test GAP RMS for gender and step 500: 0.1990921050310135

Test GAP RMS for race and step 500: 0.07666806876659393

Test balanced accuracy for step 500: 0.808620810508728


Test accuracy for step 750: 0.7940298318862915

Test GAP RMS for gender and step 750: 0.12809491157531738

Test GAP RMS for race and step 750: 0.060791853815317154

Test balanced accuracy for step 750: 0.8204110860824585


Test accuracy for step 1000: 0.8152570724487305

Test GAP RMS for gender and step 1000: 0.07996412366628647

Test GAP RMS for race and step 1000: 0.05347851663827896

Test balanced accuracy for step 1000: 0.8146781921386719


Test accuracy for step 1250: 0.8025428652763367

Test GAP RMS for gender and step 1250: 0.08736171573400497

Test GAP RMS for race and step 1250: 0.05145609751343727

Test balanced accuracy for step 1250: 0.8184720873832703


Test accuracy for step 1500: 0.8027639389038086

Test GAP RMS for gender and step 1500: 0.08069800585508347

Test GAP RMS for race and step 1500: 0.048309702426195145

Test balanced accuracy for step 1500: 0.8142966032028198


Test accuracy for step 1750: 0.8047540187835693

Test GAP RMS for gender and step 1750: 0.08256620168685913

Test GAP RMS for race and step 1750: 0.04952521622180939

Test balanced accuracy for step 1750: 0.8166916370391846


Test accuracy for step 2000: 0.801768958568573

Test GAP RMS for gender and step 2000: 0.08392579853534698

Test GAP RMS for race and step 2000: 0.05095941945910454

Test balanced accuracy for step 2000: 0.8182694911956787


Test accuracy for step 2250: 0.8102819323539734

Test GAP RMS for gender and step 2250: 0.08059312403202057

Test GAP RMS for race and step 2250: 0.05084756389260292

Test balanced accuracy for step 2250: 0.814632773399353


Test accuracy for step 2500: 0.8096185922622681

Test GAP RMS for gender and step 2500: 0.07426188886165619

Test GAP RMS for race and step 2500: 0.05155644938349724

Test balanced accuracy for step 2500: 0.8146576285362244


Test accuracy for step 2750: 0.7983416318893433

Test GAP RMS for gender and step 2750: 0.09178416430950165

Test GAP RMS for race and step 2750: 0.04844653978943825

Test balanced accuracy for step 2750: 0.8206356763839722


Test accuracy for step 3000: 0.8105030655860901

Test GAP RMS for gender and step 3000: 0.08110053837299347

Test GAP RMS for race and step 3000: 0.05326211825013161

Test balanced accuracy for step 3000: 0.816476583480835


Test accuracy for step 3250: 0.812493085861206

Test GAP RMS for gender and step 3250: 0.07664532959461212

Test GAP RMS for race and step 3250: 0.052576713263988495

Test balanced accuracy for step 3250: 0.8153218030929565


Test accuracy for step 3500: 0.8081812858581543

Test GAP RMS for gender and step 3500: 0.07911217212677002

Test GAP RMS for race and step 3500: 0.048983268439769745

Test balanced accuracy for step 3500: 0.8135538101196289


Test accuracy for step 3750: 0.8105030655860901

Test GAP RMS for gender and step 3750: 0.07687995582818985

Test GAP RMS for race and step 3750: 0.052803635597229004

Test balanced accuracy for step 3750: 0.8138527870178223


Test accuracy for step 4000: 0.8216694593429565

Test GAP RMS for gender and step 4000: 0.07805701345205307

Test GAP RMS for race and step 4000: 0.04499359428882599

Test balanced accuracy for step 4000: 0.8104255199432373


Test accuracy for step 4250: 0.8159204125404358

Test GAP RMS for gender and step 4250: 0.07807383686304092

Test GAP RMS for race and step 4250: 0.04789826646447182

Test balanced accuracy for step 4250: 0.8134187459945679


Test accuracy for step 4500: 0.801768958568573

Test GAP RMS for gender and step 4500: 0.08524886518716812

Test GAP RMS for race and step 4500: 0.050680242478847504

Test balanced accuracy for step 4500: 0.81765216588974


Test accuracy for step 4750: 0.8085129857063293

Test GAP RMS for gender and step 4750: 0.07855625450611115

Test GAP RMS for race and step 4750: 0.05081736296415329

Test balanced accuracy for step 4750: 0.815161943435669


Test accuracy for step 5000: 0.8143725991249084

Test GAP RMS for gender and step 5000: 0.08076141029596329

Test GAP RMS for race and step 5000: 0.04535052180290222

Test balanced accuracy for step 5000: 0.8130135536193848


Test accuracy for step 5250: 0.7993366718292236

Test GAP RMS for gender and step 5250: 0.08365286141633987

Test GAP RMS for race and step 5250: 0.05307784676551819

Test balanced accuracy for step 5250: 0.8203669190406799


Test accuracy for step 5500: 0.8159204125404358

Test GAP RMS for gender and step 5500: 0.08335878700017929

Test GAP RMS for race and step 5500: 0.04435166344046593

Test balanced accuracy for step 5500: 0.8143447637557983


Test accuracy for step 5750: 0.8128247857093811

Test GAP RMS for gender and step 5750: 0.08130893111228943

Test GAP RMS for race and step 5750: 0.045308664441108704

Test balanced accuracy for step 5750: 0.8127627372741699


Test accuracy for step 6000: 0.812161386013031

Test GAP RMS for gender and step 6000: 0.08191968500614166

Test GAP RMS for race and step 6000: 0.04945863410830498

Test balanced accuracy for step 6000: 0.8158743977546692


Test accuracy for step 6250: 0.807849645614624

Test GAP RMS for gender and step 6250: 0.08329299092292786

Test GAP RMS for race and step 6250: 0.049091264605522156

Test balanced accuracy for step 6250: 0.8147237300872803


Test accuracy for step 6500: 0.8127142190933228

Test GAP RMS for gender and step 6500: 0.08272028714418411

Test GAP RMS for race and step 6500: 0.04755327105522156

Test balanced accuracy for step 6500: 0.8157765865325928


Test accuracy for step 6750: 0.8160309791564941

Test GAP RMS for gender and step 6750: 0.08522942662239075

Test GAP RMS for race and step 6750: 0.04400024935603142

Test balanced accuracy for step 6750: 0.8093245029449463


Test accuracy for step 7000: 0.8140408992767334

Test GAP RMS for gender and step 7000: 0.08174555003643036

Test GAP RMS for race and step 7000: 0.04789157211780548

Test balanced accuracy for step 7000: 0.8146466016769409


Test accuracy for step 7250: 0.8143725991249084

Test GAP RMS for gender and step 7250: 0.08280561119318008

Test GAP RMS for race and step 7250: 0.04805217310786247

Test balanced accuracy for step 7250: 0.8168721199035645


Test accuracy for step 7500: 0.8145936727523804

Test GAP RMS for gender and step 7500: 0.08146221190690994

Test GAP RMS for race and step 7500: 0.047268811613321304

Test balanced accuracy for step 7500: 0.8153203725814819


Test accuracy for step 7750: 0.8175787925720215

Test GAP RMS for gender and step 7750: 0.08174619823694229

Test GAP RMS for race and step 7750: 0.04267466068267822

Test balanced accuracy for step 7750: 0.81497722864151


{'epsilon': 1e-05, 'lr': 0.0001, 'wlr': 0.001, 'w_reg': 20.0}
Final test accuracy: 0.8114980459213257
Final test GAP RMS for gender: 0.08160431683063507
Final test GAP RMS for race: 0.047060731798410416
Final test balanced accuracy: 0.8157448768615723


