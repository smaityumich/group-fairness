2020-05-21 16:32:42.219408: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:42.220031: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:42.220045: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2020-05-21 16:32:48.356630: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:48.358019: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)
2020-05-21 16:32:48.358047: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (gl3254.arc-ts.umich.edu): /proc/driver/nvidia/version does not exist
2020-05-21 16:32:48.374151: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-05-21 16:32:48.407177: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3000000000 Hz
2020-05-21 16:32:48.407304: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x557ad4ed8bc0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-05-21 16:32:48.407316: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
/sw/arcts/centos7/python3.6-anaconda/5.2.0/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/array_grad.py:563: _EagerTensorBase.cpu (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.identity instead.
2020-05-21 16:59:23.212812: W tensorflow/python/util/util.cc:319] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1786: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
Test accuracy for step 250: 0.6181315779685974

Test GAP RMS for gender and step 250: 0.12710534036159515

Test GAP RMS for race and step 250: 0.016055824235081673

Test balanced accuracy for step 250: 0.47902870178222656


Test accuracy for step 500: 0.8327252864837646

Test GAP RMS for gender and step 500: 0.28335803747177124

Test GAP RMS for race and step 500: 0.09019336104393005

Test balanced accuracy for step 500: 0.7862435579299927


Test accuracy for step 750: 0.844997227191925

Test GAP RMS for gender and step 750: 0.16049443185329437

Test GAP RMS for race and step 750: 0.0788835659623146

Test balanced accuracy for step 750: 0.7920353412628174


Test accuracy for step 1000: 0.8497512340545654

Test GAP RMS for gender and step 1000: 0.11263280361890793

Test GAP RMS for race and step 1000: 0.06414170563220978

Test balanced accuracy for step 1000: 0.7795875072479248


Test accuracy for step 1250: 0.8517413139343262

Test GAP RMS for gender and step 1250: 0.09633767604827881

Test GAP RMS for race and step 1250: 0.06125185266137123

Test balanced accuracy for step 1250: 0.7798217535018921


Test accuracy for step 1500: 0.8510779142379761

Test GAP RMS for gender and step 1500: 0.0925394743680954

Test GAP RMS for race and step 1500: 0.05464603379368782

Test balanced accuracy for step 1500: 0.776451051235199


Test accuracy for step 1750: 0.8515201807022095

Test GAP RMS for gender and step 1750: 0.0876888632774353

Test GAP RMS for race and step 1750: 0.060352642089128494

Test balanced accuracy for step 1750: 0.7761258482933044


Test accuracy for step 2000: 0.8519623875617981

Test GAP RMS for gender and step 2000: 0.08118925988674164

Test GAP RMS for race and step 2000: 0.04903031140565872

Test balanced accuracy for step 2000: 0.7724051475524902


Test accuracy for step 2250: 0.8537313342094421

Test GAP RMS for gender and step 2250: 0.06877631694078445

Test GAP RMS for race and step 2250: 0.0411570742726326

Test balanced accuracy for step 2250: 0.7689434289932251


Test accuracy for step 2500: 0.8524046540260315

Test GAP RMS for gender and step 2500: 0.055265311151742935

Test GAP RMS for race and step 2500: 0.038735851645469666

Test balanced accuracy for step 2500: 0.7668322920799255


Test accuracy for step 2750: 0.8524046540260315

Test GAP RMS for gender and step 2750: 0.06536385416984558

Test GAP RMS for race and step 2750: 0.047413792461156845

Test balanced accuracy for step 2750: 0.7757840752601624


Test accuracy for step 3000: 0.8529574275016785

Test GAP RMS for gender and step 3000: 0.06281623244285583

Test GAP RMS for race and step 3000: 0.04300922527909279

Test balanced accuracy for step 3000: 0.7707473039627075


Test accuracy for step 3250: 0.8530679941177368

Test GAP RMS for gender and step 3250: 0.056134846061468124

Test GAP RMS for race and step 3250: 0.041125766932964325

Test balanced accuracy for step 3250: 0.7685052156448364


Test accuracy for step 3500: 0.8525152206420898

Test GAP RMS for gender and step 3500: 0.05470879003405571

Test GAP RMS for race and step 3500: 0.040934935212135315

Test balanced accuracy for step 3500: 0.7698377966880798


Test accuracy for step 3750: 0.8527362942695618

Test GAP RMS for gender and step 3750: 0.052791330963373184

Test GAP RMS for race and step 3750: 0.03866145387291908

Test balanced accuracy for step 3750: 0.7716816663742065


Test accuracy for step 4000: 0.8524046540260315

Test GAP RMS for gender and step 4000: 0.04911353439092636

Test GAP RMS for race and step 4000: 0.04070017859339714

Test balanced accuracy for step 4000: 0.7648258805274963


Test accuracy for step 4250: 0.8529574275016785

Test GAP RMS for gender and step 4250: 0.054027292877435684

Test GAP RMS for race and step 4250: 0.035389527678489685

Test balanced accuracy for step 4250: 0.7709016799926758


Test accuracy for step 4500: 0.8530679941177368

Test GAP RMS for gender and step 4500: 0.04672106355428696

Test GAP RMS for race and step 4500: 0.04027996212244034

Test balanced accuracy for step 4500: 0.7637206315994263


Test accuracy for step 4750: 0.8522940874099731

Test GAP RMS for gender and step 4750: 0.05243266373872757

Test GAP RMS for race and step 4750: 0.027114367112517357

Test balanced accuracy for step 4750: 0.7752479910850525


Test accuracy for step 5000: 0.8531785607337952

Test GAP RMS for gender and step 5000: 0.05116981267929077

Test GAP RMS for race and step 5000: 0.03725253418087959

Test balanced accuracy for step 5000: 0.7736715078353882


Test accuracy for step 5250: 0.8527362942695618

Test GAP RMS for gender and step 5250: 0.05250328406691551

Test GAP RMS for race and step 5250: 0.04098303243517876

Test balanced accuracy for step 5250: 0.7735337018966675


Test accuracy for step 5500: 0.8532891273498535

Test GAP RMS for gender and step 5500: 0.05089765414595604

Test GAP RMS for race and step 5500: 0.02701200172305107

Test balanced accuracy for step 5500: 0.7752879858016968


Test accuracy for step 5750: 0.8526257872581482

Test GAP RMS for gender and step 5750: 0.05301467329263687

Test GAP RMS for race and step 5750: 0.03179735690355301

Test balanced accuracy for step 5750: 0.7808690071105957


Test accuracy for step 6000: 0.8524046540260315

Test GAP RMS for gender and step 6000: 0.05481507629156113

Test GAP RMS for race and step 6000: 0.03470737859606743

Test balanced accuracy for step 6000: 0.7825750708580017


Test accuracy for step 6250: 0.8526257872581482

Test GAP RMS for gender and step 6250: 0.05398758873343468

Test GAP RMS for race and step 6250: 0.03609924763441086

Test balanced accuracy for step 6250: 0.7831841707229614


Test accuracy for step 6500: 0.8520729541778564

Test GAP RMS for gender and step 6500: 0.05676800385117531

Test GAP RMS for race and step 6500: 0.04058317095041275

Test balanced accuracy for step 6500: 0.7846710681915283


Test accuracy for step 6750: 0.8516307473182678

Test GAP RMS for gender and step 6750: 0.05024005100131035

Test GAP RMS for race and step 6750: 0.028035474941134453

Test balanced accuracy for step 6750: 0.776044487953186


Test accuracy for step 7000: 0.8514096140861511

Test GAP RMS for gender and step 7000: 0.053817424923181534

Test GAP RMS for race and step 7000: 0.03549705818295479

Test balanced accuracy for step 7000: 0.7806830406188965


Test accuracy for step 7250: 0.8519623875617981

Test GAP RMS for gender and step 7250: 0.05403944104909897

Test GAP RMS for race and step 7250: 0.03562093898653984

Test balanced accuracy for step 7250: 0.7810481786727905


Test accuracy for step 7500: 0.8519623875617981

Test GAP RMS for gender and step 7500: 0.05356350913643837

Test GAP RMS for race and step 7500: 0.03361827880144119

Test balanced accuracy for step 7500: 0.7801221609115601


Test accuracy for step 7750: 0.8522940874099731

Test GAP RMS for gender and step 7750: 0.055860184133052826

Test GAP RMS for race and step 7750: 0.03257860988378525

Test balanced accuracy for step 7750: 0.7826563715934753


{'epsilon': 0.1, 'lr': 0.0001, 'wlr': 5e-06, 'w_reg': 10.0}
Final test accuracy: 0.8524046540260315
Final test GAP RMS for gender: 0.06014556065201759
Final test GAP RMS for race: 0.040378328412771225
Final test balanced accuracy: 0.7868965864181519


