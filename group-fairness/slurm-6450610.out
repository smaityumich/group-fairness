2020-05-21 16:32:43.966210: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:43.966310: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:43.966320: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2020-05-21 16:32:53.794006: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:53.794219: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)
2020-05-21 16:32:53.794256: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (gl3099.arc-ts.umich.edu): /proc/driver/nvidia/version does not exist
2020-05-21 16:32:53.794675: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-05-21 16:32:53.801244: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3000000000 Hz
2020-05-21 16:32:53.801353: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5624a3844270 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-05-21 16:32:53.801364: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
/sw/arcts/centos7/python3.6-anaconda/5.2.0/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/array_grad.py:563: _EagerTensorBase.cpu (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.identity instead.
2020-05-21 16:59:29.569095: W tensorflow/python/util/util.cc:319] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1786: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
Test accuracy for step 250: 0.6187949180603027

Test GAP RMS for gender and step 250: 0.12766416370868683

Test GAP RMS for race and step 250: 0.01666763611137867

Test balanced accuracy for step 250: 0.4791582226753235


Test accuracy for step 500: 0.8138197660446167

Test GAP RMS for gender and step 500: 0.3406549096107483

Test GAP RMS for race and step 500: 0.08039563149213791

Test balanced accuracy for step 500: 0.7879538536071777


Test accuracy for step 750: 0.8273078799247742

Test GAP RMS for gender and step 750: 0.2477092742919922

Test GAP RMS for race and step 750: 0.08062861859798431

Test balanced accuracy for step 750: 0.8018031120300293


Test accuracy for step 1000: 0.8415699005126953

Test GAP RMS for gender and step 1000: 0.20194953680038452

Test GAP RMS for race and step 1000: 0.0748576745390892

Test balanced accuracy for step 1000: 0.8015011548995972


Test accuracy for step 1250: 0.843228280544281

Test GAP RMS for gender and step 1250: 0.1798563003540039

Test GAP RMS for race and step 1250: 0.07322855293750763

Test balanced accuracy for step 1250: 0.8029053807258606


Test accuracy for step 1500: 0.8428966403007507

Test GAP RMS for gender and step 1500: 0.1760028600692749

Test GAP RMS for race and step 1500: 0.06726158410310745

Test balanced accuracy for step 1500: 0.8040753602981567


Test accuracy for step 1750: 0.8422333002090454

Test GAP RMS for gender and step 1750: 0.17676295340061188

Test GAP RMS for race and step 1750: 0.07116279006004333

Test balanced accuracy for step 1750: 0.8047175407409668


Test accuracy for step 2000: 0.8430072069168091

Test GAP RMS for gender and step 2000: 0.17199558019638062

Test GAP RMS for race and step 2000: 0.0678027868270874

Test balanced accuracy for step 2000: 0.8039940595626831


Test accuracy for step 2250: 0.844997227191925

Test GAP RMS for gender and step 2250: 0.1592530459165573

Test GAP RMS for race and step 2250: 0.06713677942752838

Test balanced accuracy for step 2250: 0.7971286773681641


Test accuracy for step 2500: 0.8467661738395691

Test GAP RMS for gender and step 2500: 0.14251792430877686

Test GAP RMS for race and step 2500: 0.07208215445280075

Test balanced accuracy for step 2500: 0.7993775606155396


Test accuracy for step 2750: 0.8427860736846924

Test GAP RMS for gender and step 2750: 0.15873755514621735

Test GAP RMS for race and step 2750: 0.06892778724431992

Test balanced accuracy for step 2750: 0.8033849000930786


Test accuracy for step 3000: 0.8436705470085144

Test GAP RMS for gender and step 3000: 0.1592409312725067

Test GAP RMS for race and step 3000: 0.06510723382234573

Test balanced accuracy for step 3000: 0.8005737066268921


Test accuracy for step 3250: 0.8458817005157471

Test GAP RMS for gender and step 3250: 0.14892083406448364

Test GAP RMS for race and step 3250: 0.06641381233930588

Test balanced accuracy for step 3250: 0.7983303070068359


Test accuracy for step 3500: 0.8467661738395691

Test GAP RMS for gender and step 3500: 0.1394483596086502

Test GAP RMS for race and step 3500: 0.07189632207155228

Test balanced accuracy for step 3500: 0.7989145517349243


Test accuracy for step 3750: 0.8462134003639221

Test GAP RMS for gender and step 3750: 0.14164867997169495

Test GAP RMS for race and step 3750: 0.06376904249191284

Test balanced accuracy for step 3750: 0.8017905354499817


Test accuracy for step 4000: 0.8479822874069214

Test GAP RMS for gender and step 4000: 0.14209163188934326

Test GAP RMS for race and step 4000: 0.06545106321573257

Test balanced accuracy for step 4000: 0.7955507636070251


Test accuracy for step 4250: 0.8462134003639221

Test GAP RMS for gender and step 4250: 0.14823925495147705

Test GAP RMS for race and step 4250: 0.06044106185436249

Test balanced accuracy for step 4250: 0.7957712411880493


Test accuracy for step 4500: 0.8503040075302124

Test GAP RMS for gender and step 4500: 0.1257670521736145

Test GAP RMS for race and step 4500: 0.057189978659152985

Test balanced accuracy for step 4500: 0.7902934551239014


Test accuracy for step 4750: 0.8467661738395691

Test GAP RMS for gender and step 4750: 0.1361924111843109

Test GAP RMS for race and step 4750: 0.058820173144340515

Test balanced accuracy for step 4750: 0.7986059188842773


Test accuracy for step 5000: 0.8466556072235107

Test GAP RMS for gender and step 5000: 0.13208067417144775

Test GAP RMS for race and step 5000: 0.06440196931362152

Test balanced accuracy for step 5000: 0.7925135493278503


Test accuracy for step 5250: 0.8466556072235107

Test GAP RMS for gender and step 5250: 0.13402792811393738

Test GAP RMS for race and step 5250: 0.06015453115105629

Test balanced accuracy for step 5250: 0.7932852506637573


Test accuracy for step 5500: 0.8477612137794495

Test GAP RMS for gender and step 5500: 0.1271066963672638

Test GAP RMS for race and step 5500: 0.05354798212647438

Test balanced accuracy for step 5500: 0.7937068939208984


Test accuracy for step 5750: 0.8466556072235107

Test GAP RMS for gender and step 5750: 0.1244816854596138

Test GAP RMS for race and step 5750: 0.053879931569099426

Test balanced accuracy for step 5750: 0.797452449798584


Test accuracy for step 6000: 0.8448866605758667

Test GAP RMS for gender and step 6000: 0.13447026908397675

Test GAP RMS for race and step 6000: 0.056907810270786285

Test balanced accuracy for step 6000: 0.7978273034095764


Test accuracy for step 6250: 0.8447760939598083

Test GAP RMS for gender and step 6250: 0.13209068775177002

Test GAP RMS for race and step 6250: 0.05101236328482628

Test balanced accuracy for step 6250: 0.7946674823760986


Test accuracy for step 6500: 0.8443338871002197

Test GAP RMS for gender and step 6500: 0.12911170721054077

Test GAP RMS for race and step 6500: 0.048094797879457474

Test balanced accuracy for step 6500: 0.7942209243774414


Test accuracy for step 6750: 0.8498618006706238

Test GAP RMS for gender and step 6750: 0.11080006510019302

Test GAP RMS for race and step 6750: 0.056914620101451874

Test balanced accuracy for step 6750: 0.7916991114616394


Test accuracy for step 7000: 0.8472083806991577

Test GAP RMS for gender and step 7000: 0.11690659075975418

Test GAP RMS for race and step 7000: 0.053333576768636703

Test balanced accuracy for step 7000: 0.7938047647476196


Test accuracy for step 7250: 0.8467661738395691

Test GAP RMS for gender and step 7250: 0.1138104498386383

Test GAP RMS for race and step 7250: 0.048514172434806824

Test balanced accuracy for step 7250: 0.7928952574729919


Test accuracy for step 7500: 0.8461028337478638

Test GAP RMS for gender and step 7500: 0.11847303062677383

Test GAP RMS for race and step 7500: 0.05050072446465492

Test balanced accuracy for step 7500: 0.7913767099380493


Test accuracy for step 7750: 0.8479822874069214

Test GAP RMS for gender and step 7750: 0.1064593717455864

Test GAP RMS for race and step 7750: 0.04913382977247238

Test balanced accuracy for step 7750: 0.7929269671440125


{'epsilon': 0.01, 'lr': 0.0001, 'wlr': 1e-06, 'w_reg': 20.0}
Final test accuracy: 0.8469873070716858
Final test GAP RMS for gender: 0.10430601239204407
Final test GAP RMS for race: 0.05011454224586487
Final test balanced accuracy: 0.7953564524650574


