2020-05-21 16:32:43.814114: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:43.814220: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:43.814230: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2020-05-21 16:32:50.798143: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:50.798403: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)
2020-05-21 16:32:50.798446: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (gl3264.arc-ts.umich.edu): /proc/driver/nvidia/version does not exist
2020-05-21 16:32:50.798941: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-05-21 16:32:50.807385: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3000000000 Hz
2020-05-21 16:32:50.807515: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x559b6bd63980 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-05-21 16:32:50.807526: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
/sw/arcts/centos7/python3.6-anaconda/5.2.0/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/array_grad.py:563: _EagerTensorBase.cpu (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.identity instead.
2020-05-21 16:59:04.063701: W tensorflow/python/util/util.cc:319] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1786: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
Test accuracy for step 250: 0.5927031636238098

Test GAP RMS for gender and step 250: 0.14642812311649323

Test GAP RMS for race and step 250: 0.028342777863144875

Test balanced accuracy for step 250: 0.47642993927001953


Test accuracy for step 500: 0.24311774969100952

Test GAP RMS for gender and step 500: 0.0

Test GAP RMS for race and step 500: 0.0

Test balanced accuracy for step 500: 0.5


Test accuracy for step 750: 0.6263128519058228

Test GAP RMS for gender and step 750: 0.04699656367301941

Test GAP RMS for race and step 750: 0.05371686443686485

Test balanced accuracy for step 750: 0.7386324405670166


Test accuracy for step 1000: 0.8079602122306824

Test GAP RMS for gender and step 1000: 0.06939243525266647

Test GAP RMS for race and step 1000: 0.05020396038889885

Test balanced accuracy for step 1000: 0.8090862035751343


Test accuracy for step 1250: 0.803758978843689

Test GAP RMS for gender and step 1250: 0.07584407925605774

Test GAP RMS for race and step 1250: 0.05873246490955353

Test balanced accuracy for step 1250: 0.8104780912399292


Test accuracy for step 1500: 0.8068546056747437

Test GAP RMS for gender and step 1500: 0.07292219251394272

Test GAP RMS for race and step 1500: 0.061069928109645844

Test balanced accuracy for step 1500: 0.8077384829521179


Test accuracy for step 1750: 0.8070757389068604

Test GAP RMS for gender and step 1750: 0.0695691853761673

Test GAP RMS for race and step 1750: 0.04371919482946396

Test balanced accuracy for step 1750: 0.8089649677276611


Test accuracy for step 2000: 0.8059701323509216

Test GAP RMS for gender and step 2000: 0.0693807601928711

Test GAP RMS for race and step 2000: 0.04732230305671692

Test balanced accuracy for step 2000: 0.8120931386947632


Test accuracy for step 2250: 0.8103924989700317

Test GAP RMS for gender and step 2250: 0.0680738091468811

Test GAP RMS for race and step 2250: 0.04501202702522278

Test balanced accuracy for step 2250: 0.8074518442153931


Test accuracy for step 2500: 0.8047540187835693

Test GAP RMS for gender and step 2500: 0.06970689445734024

Test GAP RMS for race and step 2500: 0.04780278727412224

Test balanced accuracy for step 2500: 0.8100550174713135


Test accuracy for step 2750: 0.8038695454597473

Test GAP RMS for gender and step 2750: 0.0661226287484169

Test GAP RMS for race and step 2750: 0.04592191427946091

Test balanced accuracy for step 2750: 0.811322808265686


Test accuracy for step 3000: 0.7904919981956482

Test GAP RMS for gender and step 3000: 0.06980213522911072

Test GAP RMS for race and step 3000: 0.03827127441763878

Test balanced accuracy for step 3000: 0.8160674571990967


Test accuracy for step 3250: 0.8048645853996277

Test GAP RMS for gender and step 3250: 0.06529925763607025

Test GAP RMS for race and step 3250: 0.0495944619178772

Test balanced accuracy for step 3250: 0.811980128288269


Test accuracy for step 3500: 0.801437258720398

Test GAP RMS for gender and step 3500: 0.06515663862228394

Test GAP RMS for race and step 3500: 0.048531364649534225

Test balanced accuracy for step 3500: 0.811259388923645


Test accuracy for step 3750: 0.7994471788406372

Test GAP RMS for gender and step 3750: 0.06361038237810135

Test GAP RMS for race and step 3750: 0.048277597874403

Test balanced accuracy for step 3750: 0.808401346206665


Test accuracy for step 4000: 0.8102819323539734

Test GAP RMS for gender and step 4000: 0.06887932121753693

Test GAP RMS for race and step 4000: 0.046599362045526505

Test balanced accuracy for step 4000: 0.8104655742645264


Test accuracy for step 4250: 0.7983416318893433

Test GAP RMS for gender and step 4250: 0.06276677548885345

Test GAP RMS for race and step 4250: 0.050474151968955994

Test balanced accuracy for step 4250: 0.8123012781143188


Test accuracy for step 4500: 0.8145936727523804

Test GAP RMS for gender and step 4500: 0.07295673340559006

Test GAP RMS for race and step 4500: 0.0446590855717659

Test balanced accuracy for step 4500: 0.8071403503417969


Test accuracy for step 4750: 0.8016583919525146

Test GAP RMS for gender and step 4750: 0.06637367606163025

Test GAP RMS for race and step 4750: 0.04408292844891548

Test balanced accuracy for step 4750: 0.8084729909896851


Test accuracy for step 5000: 0.8025428652763367

Test GAP RMS for gender and step 5000: 0.06500184535980225

Test GAP RMS for race and step 5000: 0.04439761862158775

Test balanced accuracy for step 5000: 0.805507481098175


Test accuracy for step 5250: 0.7996683120727539

Test GAP RMS for gender and step 5250: 0.0640125647187233

Test GAP RMS for race and step 5250: 0.05066920816898346

Test balanced accuracy for step 5250: 0.8094735145568848


Test accuracy for step 5500: 0.80983966588974

Test GAP RMS for gender and step 5500: 0.06955461204051971

Test GAP RMS for race and step 5500: 0.04315030947327614

Test balanced accuracy for step 5500: 0.8097104430198669


Test accuracy for step 5750: 0.7923714518547058

Test GAP RMS for gender and step 5750: 0.07636118680238724

Test GAP RMS for race and step 5750: 0.038135528564453125

Test balanced accuracy for step 5750: 0.7977077960968018


Test accuracy for step 6000: 0.7996683120727539

Test GAP RMS for gender and step 6000: 0.07236093282699585

Test GAP RMS for race and step 6000: 0.0463426299393177

Test balanced accuracy for step 6000: 0.8088561296463013


Test accuracy for step 6250: 0.8106135725975037

Test GAP RMS for gender and step 6250: 0.07446672767400742

Test GAP RMS for race and step 6250: 0.04551501199603081

Test balanced accuracy for step 6250: 0.8086782693862915


Test accuracy for step 6500: 0.8074073791503906

Test GAP RMS for gender and step 6500: 0.0717456042766571

Test GAP RMS for race and step 6500: 0.046338118612766266

Test balanced accuracy for step 6500: 0.8074862957000732


Test accuracy for step 6750: 0.7929242849349976

Test GAP RMS for gender and step 6750: 0.07185349613428116

Test GAP RMS for race and step 6750: 0.03885168582201004

Test balanced accuracy for step 6750: 0.8005424737930298


Test accuracy for step 7000: 0.8021005988121033

Test GAP RMS for gender and step 7000: 0.06865879893302917

Test GAP RMS for race and step 7000: 0.04660729691386223

Test balanced accuracy for step 7000: 0.8107715845108032


Test accuracy for step 7250: 0.8025428652763367

Test GAP RMS for gender and step 7250: 0.06634670495986938

Test GAP RMS for race and step 7250: 0.04909592866897583

Test balanced accuracy for step 7250: 0.806587815284729


Test accuracy for step 7500: 0.8112769722938538

Test GAP RMS for gender and step 7500: 0.07451729476451874

Test GAP RMS for race and step 7500: 0.03814927488565445

Test balanced accuracy for step 7500: 0.8069556951522827


Test accuracy for step 7750: 0.7974571585655212

Test GAP RMS for gender and step 7750: 0.06556957960128784

Test GAP RMS for race and step 7750: 0.04597385227680206

Test balanced accuracy for step 7750: 0.8104822635650635


{'epsilon': 1e-05, 'lr': 0.0001, 'wlr': 0.001, 'w_reg': 50.0}
Final test accuracy: 0.7996683120727539
Final test GAP RMS for gender: 0.07046429067850113
Final test GAP RMS for race: 0.04076661169528961
Final test balanced accuracy: 0.8048433065414429


