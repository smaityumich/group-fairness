2020-05-21 16:32:44.874800: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:44.875497: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:44.875509: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2020-05-21 16:32:50.707115: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:50.707332: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)
2020-05-21 16:32:50.707356: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (gl3168.arc-ts.umich.edu): /proc/driver/nvidia/version does not exist
2020-05-21 16:32:50.707706: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-05-21 16:32:50.714859: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3000000000 Hz
2020-05-21 16:32:50.714952: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55c7cf345a30 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-05-21 16:32:50.714962: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
/sw/arcts/centos7/python3.6-anaconda/5.2.0/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/array_grad.py:563: _EagerTensorBase.cpu (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.identity instead.
2020-05-21 16:59:01.301744: W tensorflow/python/util/util.cc:319] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1786: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
Test accuracy for step 250: 0.6190160512924194

Test GAP RMS for gender and step 250: 0.12762658298015594

Test GAP RMS for race and step 250: 0.013361068442463875

Test balanced accuracy for step 250: 0.47544577717781067


Test accuracy for step 500: 0.8337202668190002

Test GAP RMS for gender and step 500: 0.3283725082874298

Test GAP RMS for race and step 500: 0.049692071974277496

Test balanced accuracy for step 500: 0.726399302482605


Test accuracy for step 750: 0.8437811136245728

Test GAP RMS for gender and step 750: 0.19466733932495117

Test GAP RMS for race and step 750: 0.04142949357628822

Test balanced accuracy for step 750: 0.7418429851531982


Test accuracy for step 1000: 0.8445550203323364

Test GAP RMS for gender and step 1000: 0.1164836660027504

Test GAP RMS for race and step 1000: 0.031922902911901474

Test balanced accuracy for step 1000: 0.7281548976898193


Test accuracy for step 1250: 0.8430072069168091

Test GAP RMS for gender and step 1250: 0.07995500415563583

Test GAP RMS for race and step 1250: 0.025340255349874496

Test balanced accuracy for step 1250: 0.7177175283432007


Test accuracy for step 1500: 0.8427860736846924

Test GAP RMS for gender and step 1500: 0.056609269231557846

Test GAP RMS for race and step 1500: 0.015933087095618248

Test balanced accuracy for step 1500: 0.7087740898132324


Test accuracy for step 1750: 0.8382532000541687

Test GAP RMS for gender and step 1750: 0.03616761043667793

Test GAP RMS for race and step 1750: 0.008925576694309711

Test balanced accuracy for step 1750: 0.6932780146598816


Test accuracy for step 2000: 0.8326147198677063

Test GAP RMS for gender and step 2000: 0.02064322866499424

Test GAP RMS for race and step 2000: 0.01414719969034195

Test balanced accuracy for step 2000: 0.6765885949134827


Test accuracy for step 2250: 0.8264234662055969

Test GAP RMS for gender and step 2250: 0.007776330225169659

Test GAP RMS for race and step 2250: 0.01018729992210865

Test balanced accuracy for step 2250: 0.6590709686279297


Test accuracy for step 2500: 0.8237700462341309

Test GAP RMS for gender and step 2500: 0.01091258879750967

Test GAP RMS for race and step 2500: 0.004291316960006952

Test balanced accuracy for step 2500: 0.6503728032112122


Test accuracy for step 2750: 0.8195688128471375

Test GAP RMS for gender and step 2750: 0.015599743463099003

Test GAP RMS for race and step 2750: 0.006083511281758547

Test balanced accuracy for step 2750: 0.6389544010162354


Test accuracy for step 3000: 0.8111664056777954

Test GAP RMS for gender and step 3000: 0.019848916679620743

Test GAP RMS for race and step 3000: 0.025240521878004074

Test balanced accuracy for step 3000: 0.6187413334846497


Test accuracy for step 3250: 0.8027639389038086

Test GAP RMS for gender and step 3250: 0.03126680105924606

Test GAP RMS for race and step 3250: 0.019144846126437187

Test balanced accuracy for step 3250: 0.5988369584083557


Test accuracy for step 3500: 0.7975677251815796

Test GAP RMS for gender and step 3500: 0.02179494872689247

Test GAP RMS for race and step 3500: 0.006426333915442228

Test balanced accuracy for step 3500: 0.5864525437355042


Test accuracy for step 3750: 0.7894969582557678

Test GAP RMS for gender and step 3750: 0.02140018716454506

Test GAP RMS for race and step 3750: 0.007437429390847683

Test balanced accuracy for step 3750: 0.568464994430542


Test accuracy for step 4000: 0.7820895314216614

Test GAP RMS for gender and step 4000: 0.019702758640050888

Test GAP RMS for race and step 4000: 0.002290133386850357

Test balanced accuracy for step 4000: 0.5524591207504272


Test accuracy for step 4250: 0.7794361710548401

Test GAP RMS for gender and step 4250: 0.02387584187090397

Test GAP RMS for race and step 4250: 0.007265537045896053

Test balanced accuracy for step 4250: 0.5468477606773376


Test accuracy for step 4500: 0.7771144509315491

Test GAP RMS for gender and step 4500: 0.02208995632827282

Test GAP RMS for race and step 4500: 0.003893566783517599

Test balanced accuracy for step 4500: 0.5417641401290894


Test accuracy for step 4750: 0.776229977607727

Test GAP RMS for gender and step 4750: 0.022489367052912712

Test GAP RMS for race and step 4750: 0.0028907805681228638

Test balanced accuracy for step 4750: 0.539945125579834


Test accuracy for step 5000: 0.768380343914032

Test GAP RMS for gender and step 5000: 0.025708399713039398

Test GAP RMS for race and step 5000: 0.005017003044486046

Test balanced accuracy for step 5000: 0.5238014459609985


Test accuracy for step 5250: 0.7737976908683777

Test GAP RMS for gender and step 5250: 0.01697530597448349

Test GAP RMS for race and step 5250: 0.00998017843812704

Test balanced accuracy for step 5250: 0.5352515578269958


Test accuracy for step 5500: 0.7834162712097168

Test GAP RMS for gender and step 5500: 0.00430292310193181

Test GAP RMS for race and step 5500: 0.003193583572283387

Test balanced accuracy for step 5500: 0.5556506514549255


Test accuracy for step 5750: 0.7927031517028809

Test GAP RMS for gender and step 5750: 0.01675218902528286

Test GAP RMS for race and step 5750: 0.0004226873570587486

Test balanced accuracy for step 5750: 0.5756762623786926


Test accuracy for step 6000: 0.7942509651184082

Test GAP RMS for gender and step 6000: 0.011501859873533249

Test GAP RMS for race and step 6000: 0.006130674388259649

Test balanced accuracy for step 6000: 0.5788595080375671


Test accuracy for step 6250: 0.7915975451469421

Test GAP RMS for gender and step 6250: 0.003752857679501176

Test GAP RMS for race and step 6250: 0.00838815700262785

Test balanced accuracy for step 6250: 0.5727851390838623


Test accuracy for step 6500: 0.7939192652702332

Test GAP RMS for gender and step 6500: 0.006315526552498341

Test GAP RMS for race and step 6500: 0.002940230304375291

Test balanced accuracy for step 6500: 0.5775600671768188


Test accuracy for step 6750: 0.7899391651153564

Test GAP RMS for gender and step 6750: 0.000627381494268775

Test GAP RMS for race and step 6750: 0.010560029186308384

Test balanced accuracy for step 6750: 0.5690658092498779


Test accuracy for step 7000: 0.7982310652732849

Test GAP RMS for gender and step 7000: 0.009152280166745186

Test GAP RMS for race and step 7000: 0.005918613635003567

Test balanced accuracy for step 7000: 0.5867364406585693


Test accuracy for step 7250: 0.7936981916427612

Test GAP RMS for gender and step 7250: 0.01485383603721857

Test GAP RMS for race and step 7250: 0.009330934844911098

Test balanced accuracy for step 7250: 0.5771052837371826


Test accuracy for step 7500: 0.7886124849319458

Test GAP RMS for gender and step 7500: 0.009446116164326668

Test GAP RMS for race and step 7500: 0.010996750555932522

Test balanced accuracy for step 7500: 0.5663372874259949


Test accuracy for step 7750: 0.7956882119178772

Test GAP RMS for gender and step 7750: 0.005129998549818993

Test GAP RMS for race and step 7750: 0.006435072980821133

Test balanced accuracy for step 7750: 0.5813524127006531


{'epsilon': 0.01, 'lr': 0.0001, 'wlr': 1e-05, 'w_reg': 60.0}
Final test accuracy: 0.7913764715194702
Final test GAP RMS for gender: 0.013069011270999908
Final test GAP RMS for race: 0.013648300431668758
Final test balanced accuracy: 0.5720217227935791


