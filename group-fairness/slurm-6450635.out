2020-05-21 16:32:43.111233: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:43.112059: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:43.112071: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2020-05-21 16:32:52.985687: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:52.986308: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)
2020-05-21 16:32:52.986334: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (gl3108.arc-ts.umich.edu): /proc/driver/nvidia/version does not exist
2020-05-21 16:32:52.986770: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-05-21 16:32:52.995031: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3000000000 Hz
2020-05-21 16:32:52.995131: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x558838ea0ef0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-05-21 16:32:52.995141: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
/sw/arcts/centos7/python3.6-anaconda/5.2.0/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/array_grad.py:563: _EagerTensorBase.cpu (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.identity instead.
2020-05-21 16:59:20.195274: W tensorflow/python/util/util.cc:319] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1786: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
Test accuracy for step 250: 0.6193476915359497

Test GAP RMS for gender and step 250: 0.12847669422626495

Test GAP RMS for race and step 250: 0.015426810830831528

Test balanced accuracy for step 250: 0.4782886803150177


Test accuracy for step 500: 0.8229961395263672

Test GAP RMS for gender and step 500: 0.3645590543746948

Test GAP RMS for race and step 500: 0.09732261300086975

Test balanced accuracy for step 500: 0.7847553491592407


Test accuracy for step 750: 0.8343836665153503

Test GAP RMS for gender and step 750: 0.2650773525238037

Test GAP RMS for race and step 750: 0.0829286053776741

Test balanced accuracy for step 750: 0.7953648567199707


Test accuracy for step 1000: 0.8442233204841614

Test GAP RMS for gender and step 1000: 0.22441136837005615

Test GAP RMS for race and step 1000: 0.08830234408378601

Test balanced accuracy for step 1000: 0.7905980944633484


Test accuracy for step 1250: 0.8466556072235107

Test GAP RMS for gender and step 1250: 0.20637811720371246

Test GAP RMS for race and step 1250: 0.08448875695466995

Test balanced accuracy for step 1250: 0.7912788391113281


Test accuracy for step 1500: 0.8467661738395691

Test GAP RMS for gender and step 1500: 0.19566529989242554

Test GAP RMS for race and step 1500: 0.08245799690485

Test balanced accuracy for step 1500: 0.7938213348388672


Test accuracy for step 1750: 0.8469873070716858

Test GAP RMS for gender and step 1750: 0.19426651298999786

Test GAP RMS for race and step 1750: 0.0789426788687706

Test balanced accuracy for step 1750: 0.7935043573379517


Test accuracy for step 2000: 0.8472083806991577

Test GAP RMS for gender and step 2000: 0.19312544167041779

Test GAP RMS for race and step 2000: 0.07513587921857834

Test balanced accuracy for step 2000: 0.7921070456504822


Test accuracy for step 2250: 0.8487561941146851

Test GAP RMS for gender and step 2250: 0.19179993867874146

Test GAP RMS for race and step 2250: 0.07087849825620651

Test balanced accuracy for step 2250: 0.7834060192108154


Test accuracy for step 2500: 0.8494195938110352

Test GAP RMS for gender and step 2500: 0.15993466973304749

Test GAP RMS for race and step 2500: 0.0645952969789505

Test balanced accuracy for step 2500: 0.7841529846191406


Test accuracy for step 2750: 0.8493090271949768

Test GAP RMS for gender and step 2750: 0.16687630116939545

Test GAP RMS for race and step 2750: 0.07038497924804688

Test balanced accuracy for step 2750: 0.7900991439819336


Test accuracy for step 3000: 0.8494195938110352

Test GAP RMS for gender and step 3000: 0.17404578626155853

Test GAP RMS for race and step 3000: 0.06860318034887314

Test balanced accuracy for step 3000: 0.7860050201416016


Test accuracy for step 3250: 0.8508568406105042

Test GAP RMS for gender and step 3250: 0.1606423705816269

Test GAP RMS for race and step 3250: 0.06161428242921829

Test balanced accuracy for step 3250: 0.7840219736099243


Test accuracy for step 3500: 0.8517413139343262

Test GAP RMS for gender and step 3500: 0.1485714316368103

Test GAP RMS for race and step 3500: 0.06705133616924286

Test balanced accuracy for step 3500: 0.7855323553085327


Test accuracy for step 3750: 0.8507462739944458

Test GAP RMS for gender and step 3750: 0.14326517283916473

Test GAP RMS for race and step 3750: 0.06935965269804001

Test balanced accuracy for step 3750: 0.7876532077789307


Test accuracy for step 4000: 0.8521835207939148

Test GAP RMS for gender and step 4000: 0.1500243991613388

Test GAP RMS for race and step 4000: 0.05930371209979057

Test balanced accuracy for step 4000: 0.7802681922912598


Test accuracy for step 4250: 0.8524046540260315

Test GAP RMS for gender and step 4250: 0.14783696830272675

Test GAP RMS for race and step 4250: 0.06318531930446625

Test balanced accuracy for step 4250: 0.7821120023727417


Test accuracy for step 4500: 0.8525152206420898

Test GAP RMS for gender and step 4500: 0.12381655722856522

Test GAP RMS for race and step 4500: 0.04951874166727066

Test balanced accuracy for step 4500: 0.772307276725769


Test accuracy for step 4750: 0.8520729541778564

Test GAP RMS for gender and step 4750: 0.12944860756397247

Test GAP RMS for race and step 4750: 0.05791868269443512

Test balanced accuracy for step 4750: 0.7842080593109131


Test accuracy for step 5000: 0.8530679941177368

Test GAP RMS for gender and step 5000: 0.12304029613733292

Test GAP RMS for race and step 5000: 0.05836464837193489

Test balanced accuracy for step 5000: 0.7808524966239929


Test accuracy for step 5250: 0.8530679941177368

Test GAP RMS for gender and step 5250: 0.12860211730003357

Test GAP RMS for race and step 5250: 0.05125183239579201

Test balanced accuracy for step 5250: 0.7805438041687012


Test accuracy for step 5500: 0.8532891273498535

Test GAP RMS for gender and step 5500: 0.11494384706020355

Test GAP RMS for race and step 5500: 0.05209043622016907

Test balanced accuracy for step 5500: 0.7797638177871704


Test accuracy for step 5750: 0.8524046540260315

Test GAP RMS for gender and step 5750: 0.1140919178724289

Test GAP RMS for race and step 5750: 0.05154605954885483

Test balanced accuracy for step 5750: 0.7839641571044922


Test accuracy for step 6000: 0.8521835207939148

Test GAP RMS for gender and step 6000: 0.11945892870426178

Test GAP RMS for race and step 6000: 0.05785832554101944

Test balanced accuracy for step 6000: 0.7858244776725769


Test accuracy for step 6250: 0.8514096140861511

Test GAP RMS for gender and step 6250: 0.12479264289140701

Test GAP RMS for race and step 6250: 0.056188423186540604

Test balanced accuracy for step 6250: 0.782843828201294


Test accuracy for step 6500: 0.8515201807022095

Test GAP RMS for gender and step 6500: 0.11794453114271164

Test GAP RMS for race and step 6500: 0.051447559148073196

Test balanced accuracy for step 6500: 0.7819907665252686


Test accuracy for step 6750: 0.8522940874099731

Test GAP RMS for gender and step 6750: 0.09809568524360657

Test GAP RMS for race and step 6750: 0.04016255959868431

Test balanced accuracy for step 6750: 0.7749392986297607


Test accuracy for step 7000: 0.8527362942695618

Test GAP RMS for gender and step 7000: 0.09737668931484222

Test GAP RMS for race and step 7000: 0.04688218608498573

Test balanced accuracy for step 7000: 0.7798616886138916


Test accuracy for step 7250: 0.8542841076850891

Test GAP RMS for gender and step 7250: 0.09547767043113708

Test GAP RMS for race and step 7250: 0.05031639337539673

Test balanced accuracy for step 7250: 0.7816559076309204


Test accuracy for step 7500: 0.8527362942695618

Test GAP RMS for gender and step 7500: 0.10355819761753082

Test GAP RMS for race and step 7500: 0.04991387203335762

Test balanced accuracy for step 7500: 0.7783182859420776


Test accuracy for step 7750: 0.8536207675933838

Test GAP RMS for gender and step 7750: 0.0915694385766983

Test GAP RMS for race and step 7750: 0.0423939973115921

Test balanced accuracy for step 7750: 0.7787482738494873


{'epsilon': 0.01, 'lr': 0.0001, 'wlr': 1e-06, 'w_reg': 30.0}
Final test accuracy: 0.8519623875617981
Final test GAP RMS for gender: 0.09096290171146393
Final test GAP RMS for race: 0.04927961900830269
Final test balanced accuracy: 0.7805851697921753


