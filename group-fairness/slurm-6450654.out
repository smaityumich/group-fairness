2020-05-21 16:32:42.062657: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:42.079767: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:42.079779: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2020-05-21 16:32:50.819270: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:50.819447: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)
2020-05-21 16:32:50.819472: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (gl3264.arc-ts.umich.edu): /proc/driver/nvidia/version does not exist
2020-05-21 16:32:50.819846: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-05-21 16:32:50.826861: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3000000000 Hz
2020-05-21 16:32:50.826948: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x564726941c70 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-05-21 16:32:50.826957: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
/sw/arcts/centos7/python3.6-anaconda/5.2.0/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/array_grad.py:563: _EagerTensorBase.cpu (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.identity instead.
2020-05-21 16:58:49.723533: W tensorflow/python/util/util.cc:319] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1786: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
Test accuracy for step 250: 0.6179104447364807

Test GAP RMS for gender and step 250: 0.12803535163402557

Test GAP RMS for race and step 250: 0.014905701391398907

Test balanced accuracy for step 250: 0.47178295254707336


Test accuracy for step 500: 0.8200110793113708

Test GAP RMS for gender and step 500: 0.21040216088294983

Test GAP RMS for race and step 500: 0.032375190407037735

Test balanced accuracy for step 500: 0.6522111296653748


Test accuracy for step 750: 0.8225538730621338

Test GAP RMS for gender and step 750: 0.15054038166999817

Test GAP RMS for race and step 750: 0.022430581972002983

Test balanced accuracy for step 750: 0.6529648900032043


Test accuracy for step 1000: 0.806965172290802

Test GAP RMS for gender and step 1000: 0.04926315322518349

Test GAP RMS for race and step 1000: 0.016885628923773766

Test balanced accuracy for step 1000: 0.6088663339614868


Test accuracy for step 1250: 0.8012161254882812

Test GAP RMS for gender and step 1250: 0.03165268525481224

Test GAP RMS for race and step 1250: 0.005750867538154125

Test balanced accuracy for step 1250: 0.5936472415924072


Test accuracy for step 1500: 0.7922609448432922

Test GAP RMS for gender and step 1500: 0.014187486842274666

Test GAP RMS for race and step 1500: 0.005284413229674101

Test balanced accuracy for step 1500: 0.5741494297981262


Test accuracy for step 1750: 0.7868435382843018

Test GAP RMS for gender and step 1750: 0.004676033742725849

Test GAP RMS for race and step 1750: 0.002091341884806752

Test balanced accuracy for step 1750: 0.5623906254768372


Test accuracy for step 2000: 0.7793256044387817

Test GAP RMS for gender and step 2000: 0.0037750392220914364

Test GAP RMS for race and step 2000: 0.011804869398474693

Test balanced accuracy for step 2000: 0.546466052532196


Test accuracy for step 2250: 0.7626312971115112

Test GAP RMS for gender and step 2250: 0.006505779922008514

Test GAP RMS for race and step 2250: 0.004603659268468618

Test balanced accuracy for step 2250: 0.5118235349655151


Test accuracy for step 2500: 0.7614151239395142

Test GAP RMS for gender and step 2500: 0.0023728504311293364

Test GAP RMS for race and step 2500: 0.0030120983719825745

Test balanced accuracy for step 2500: 0.5093224048614502


Test accuracy for step 2750: 0.7616362571716309

Test GAP RMS for gender and step 2750: 0.0020883921533823013

Test GAP RMS for race and step 2750: 0.0037206222768872976

Test balanced accuracy for step 2750: 0.5097771883010864


Test accuracy for step 3000: 0.7589828372001648

Test GAP RMS for gender and step 3000: 0.00849935319274664

Test GAP RMS for race and step 3000: 0.002893430180847645

Test balanced accuracy for step 3000: 0.5043201446533203


Test accuracy for step 3250: 0.7592039704322815

Test GAP RMS for gender and step 3250: 0.010354253463447094

Test GAP RMS for race and step 3250: 0.0036019536200910807

Test balanced accuracy for step 3250: 0.5047748684883118


Test accuracy for step 3500: 0.7601990103721619

Test GAP RMS for gender and step 3500: 0.017398130148649216

Test GAP RMS for race and step 3500: 0.0067903101444244385

Test balanced accuracy for step 3500: 0.5068212747573853


Test accuracy for step 3750: 0.7632946372032166

Test GAP RMS for gender and step 3750: 0.014696971513330936

Test GAP RMS for race and step 3750: 0.01287209801375866

Test balanced accuracy for step 3750: 0.513187825679779


Test accuracy for step 4000: 0.7636263370513916

Test GAP RMS for gender and step 4000: 0.013569808565080166

Test GAP RMS for race and step 4000: 0.010097336024045944

Test balanced accuracy for step 4000: 0.5138699412345886


Test accuracy for step 4250: 0.76749587059021

Test GAP RMS for gender and step 4250: 0.026482993736863136

Test GAP RMS for race and step 4250: 0.004366321489214897

Test balanced accuracy for step 4250: 0.5218281149864197


Test accuracy for step 4500: 0.7704809308052063

Test GAP RMS for gender and step 4500: 0.0420270599424839

Test GAP RMS for race and step 4500: 0.005960882641375065

Test balanced accuracy for step 4500: 0.5281215906143188


Test accuracy for step 4750: 0.7823106646537781

Test GAP RMS for gender and step 4750: 0.027511950582265854

Test GAP RMS for race and step 4750: 0.002250594785436988

Test balanced accuracy for step 4750: 0.5526052117347717


Test accuracy for step 5000: 0.7860696315765381

Test GAP RMS for gender and step 5000: 0.011381126008927822

Test GAP RMS for race and step 5000: 0.00485871359705925

Test balanced accuracy for step 5000: 0.5606446266174316


Test accuracy for step 5250: 0.7917081117630005

Test GAP RMS for gender and step 5250: 0.002650147769600153

Test GAP RMS for race and step 5250: 0.005974458064883947

Test balanced accuracy for step 5250: 0.5722408294677734


Test accuracy for step 5500: 0.7954671382904053

Test GAP RMS for gender and step 5500: 0.01015583984553814

Test GAP RMS for race and step 5500: 0.004765728488564491

Test balanced accuracy for step 5500: 0.5810520052909851


Test accuracy for step 5750: 0.801437258720398

Test GAP RMS for gender and step 5750: 0.002743891440331936

Test GAP RMS for race and step 5750: 0.013490555807948112

Test balanced accuracy for step 5750: 0.5954911112785339


Test accuracy for step 6000: 0.8081812858581543

Test GAP RMS for gender and step 6000: 0.006277894135564566

Test GAP RMS for race and step 6000: 0.027114639058709145

Test balanced accuracy for step 6000: 0.6109044551849365


Test accuracy for step 6250: 0.8088446855545044

Test GAP RMS for gender and step 6250: 0.004619312006980181

Test GAP RMS for race and step 6250: 0.0257565900683403

Test balanced accuracy for step 6250: 0.6124230027198792


Test accuracy for step 6500: 0.813045859336853

Test GAP RMS for gender and step 6500: 0.004009285010397434

Test GAP RMS for race and step 6500: 0.013130772858858109

Test balanced accuracy for step 6500: 0.6230697631835938


Test accuracy for step 6750: 0.8117191791534424

Test GAP RMS for gender and step 6750: 0.010775868780910969

Test GAP RMS for race and step 6750: 0.017629215493798256

Test balanced accuracy for step 6750: 0.6208042502403259


Test accuracy for step 7000: 0.8204532861709595

Test GAP RMS for gender and step 7000: 0.010380711406469345

Test GAP RMS for race and step 7000: 0.015053955838084221

Test balanced accuracy for step 7000: 0.6420081257820129


Test accuracy for step 7250: 0.8166943192481995

Test GAP RMS for gender and step 7250: 0.016972191631793976

Test GAP RMS for race and step 7250: 0.02493922971189022

Test balanced accuracy for step 7250: 0.632270872592926


Test accuracy for step 7500: 0.8184632658958435

Test GAP RMS for gender and step 7500: 0.007635052315890789

Test GAP RMS for race and step 7500: 0.006345818284898996

Test balanced accuracy for step 7500: 0.636834979057312


Test accuracy for step 7750: 0.8236594796180725

Test GAP RMS for gender and step 7750: 0.005897222086787224

Test GAP RMS for race and step 7750: 0.004185190889984369

Test balanced accuracy for step 7750: 0.650145411491394


{'epsilon': 0.1, 'lr': 0.0001, 'wlr': 5e-06, 'w_reg': 40.0}
Final test accuracy: 0.8266445398330688
Final test GAP RMS for gender: 0.017081212252378464
Final test GAP RMS for race: 0.009976218454539776
Final test balanced accuracy: 0.6572105884552002


