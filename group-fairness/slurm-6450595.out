2020-05-21 16:32:41.571353: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:41.571774: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:41.571788: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2020-05-21 16:32:47.591275: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:47.591455: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)
2020-05-21 16:32:47.591484: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (gl3157.arc-ts.umich.edu): /proc/driver/nvidia/version does not exist
2020-05-21 16:32:47.591821: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-05-21 16:32:47.598200: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3000000000 Hz
2020-05-21 16:32:47.598293: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x561611e31630 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-05-21 16:32:47.598303: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
/sw/arcts/centos7/python3.6-anaconda/5.2.0/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/array_grad.py:563: _EagerTensorBase.cpu (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.identity instead.
2020-05-21 16:59:35.321670: W tensorflow/python/util/util.cc:319] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1786: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
Test accuracy for step 250: 0.6183526515960693

Test GAP RMS for gender and step 250: 0.12737789750099182

Test GAP RMS for race and step 250: 0.01669970527291298

Test balanced accuracy for step 250: 0.48071813583374023


Test accuracy for step 500: 0.8307352066040039

Test GAP RMS for gender and step 500: 0.23459157347679138

Test GAP RMS for race and step 500: 0.07409296184778214

Test balanced accuracy for step 500: 0.792491614818573


Test accuracy for step 750: 0.842343807220459

Test GAP RMS for gender and step 750: 0.06848686188459396

Test GAP RMS for race and step 750: 0.05399511009454727

Test balanced accuracy for step 750: 0.7929062843322754


Test accuracy for step 1000: 0.8480928540229797

Test GAP RMS for gender and step 1000: 0.049864672124385834

Test GAP RMS for race and step 1000: 0.03451932221651077

Test balanced accuracy for step 1000: 0.7798810005187988


Test accuracy for step 1250: 0.8469873070716858

Test GAP RMS for gender and step 1250: 0.04902758449316025

Test GAP RMS for race and step 1250: 0.03237248212099075

Test balanced accuracy for step 1250: 0.7709705829620361


Test accuracy for step 1500: 0.8489773273468018

Test GAP RMS for gender and step 1500: 0.047862909734249115

Test GAP RMS for race and step 1500: 0.022690463811159134

Test balanced accuracy for step 1500: 0.7712048292160034


Test accuracy for step 1750: 0.8510779142379761

Test GAP RMS for gender and step 1750: 0.04497390240430832

Test GAP RMS for race and step 1750: 0.024981491267681122

Test balanced accuracy for step 1750: 0.7676536440849304


Test accuracy for step 2000: 0.8528468608856201

Test GAP RMS for gender and step 2000: 0.04422975331544876

Test GAP RMS for race and step 2000: 0.027939649298787117

Test balanced accuracy for step 2000: 0.7641919851303101


Test accuracy for step 2250: 0.8520729541778564

Test GAP RMS for gender and step 2250: 0.04008782282471657

Test GAP RMS for race and step 2250: 0.029846644029021263

Test balanced accuracy for step 2250: 0.7562723159790039


Test accuracy for step 2500: 0.8521835207939148

Test GAP RMS for gender and step 2500: 0.04555199295282364

Test GAP RMS for race and step 2500: 0.0236236322671175

Test balanced accuracy for step 2500: 0.7552649974822998


Test accuracy for step 2750: 0.8522940874099731

Test GAP RMS for gender and step 2750: 0.04256731644272804

Test GAP RMS for race and step 2750: 0.02381007932126522

Test balanced accuracy for step 2750: 0.7551836967468262


Test accuracy for step 3000: 0.8522940874099731

Test GAP RMS for gender and step 3000: 0.03908201679587364

Test GAP RMS for race and step 3000: 0.03231015056371689

Test balanced accuracy for step 3000: 0.7508621215820312


Test accuracy for step 3250: 0.8505251407623291

Test GAP RMS for gender and step 3250: 0.034144069999456406

Test GAP RMS for race and step 3250: 0.03123439848423004

Test balanced accuracy for step 3250: 0.7429026365280151


Test accuracy for step 3500: 0.8505251407623291

Test GAP RMS for gender and step 3500: 0.03984728083014488

Test GAP RMS for race and step 3500: 0.032593708485364914

Test balanced accuracy for step 3500: 0.7466068267822266


Test accuracy for step 3750: 0.8512990474700928

Test GAP RMS for gender and step 3750: 0.03835804760456085

Test GAP RMS for race and step 3750: 0.031424060463905334

Test balanced accuracy for step 3750: 0.7480441331863403


Test accuracy for step 4000: 0.8503040075302124

Test GAP RMS for gender and step 4000: 0.037561845034360886

Test GAP RMS for race and step 4000: 0.031024150550365448

Test balanced accuracy for step 4000: 0.7407500743865967


Test accuracy for step 4250: 0.8498618006706238

Test GAP RMS for gender and step 4250: 0.03412696346640587

Test GAP RMS for race and step 4250: 0.024006832391023636

Test balanced accuracy for step 4250: 0.7356734275817871


Test accuracy for step 4500: 0.8482034206390381

Test GAP RMS for gender and step 4500: 0.037586480379104614

Test GAP RMS for race and step 4500: 0.023950811475515366

Test balanced accuracy for step 4500: 0.7310280799865723


Test accuracy for step 4750: 0.8509674072265625

Test GAP RMS for gender and step 4750: 0.04508340358734131

Test GAP RMS for race and step 4750: 0.02657954767346382

Test balanced accuracy for step 4750: 0.7439664602279663


Test accuracy for step 5000: 0.8500829339027405

Test GAP RMS for gender and step 5000: 0.037036243826150894

Test GAP RMS for race and step 5000: 0.024230606853961945

Test balanced accuracy for step 5000: 0.737517237663269


Test accuracy for step 5250: 0.8505251407623291

Test GAP RMS for gender and step 5250: 0.034491024911403656

Test GAP RMS for race and step 5250: 0.026497863233089447

Test balanced accuracy for step 5250: 0.7404332160949707


Test accuracy for step 5500: 0.8509674072265625

Test GAP RMS for gender and step 5500: 0.0334390290081501

Test GAP RMS for race and step 5500: 0.025141291320323944

Test balanced accuracy for step 5500: 0.7402622699737549


Test accuracy for step 5750: 0.8519623875617981

Test GAP RMS for gender and step 5750: 0.04169902950525284

Test GAP RMS for race and step 5750: 0.022590890526771545

Test balanced accuracy for step 5750: 0.7443151473999023


Test accuracy for step 6000: 0.8508568406105042

Test GAP RMS for gender and step 6000: 0.04055187106132507

Test GAP RMS for race and step 6000: 0.024077503010630608

Test balanced accuracy for step 6000: 0.7438934445381165


Test accuracy for step 6250: 0.8500829339027405

Test GAP RMS for gender and step 6250: 0.03428072854876518

Test GAP RMS for race and step 6250: 0.02156207337975502

Test balanced accuracy for step 6250: 0.7392150163650513


Test accuracy for step 6500: 0.8514096140861511

Test GAP RMS for gender and step 6500: 0.0363556332886219

Test GAP RMS for race and step 6500: 0.02631280943751335

Test balanced accuracy for step 6500: 0.7473454475402832


Test accuracy for step 6750: 0.8509674072265625

Test GAP RMS for gender and step 6750: 0.03915964066982269

Test GAP RMS for race and step 6750: 0.017441153526306152

Test balanced accuracy for step 6750: 0.745355486869812


Test accuracy for step 7000: 0.8519623875617981

Test GAP RMS for gender and step 7000: 0.04009417071938515

Test GAP RMS for race and step 7000: 0.025803424417972565

Test balanced accuracy for step 7000: 0.7520321607589722


Test accuracy for step 7250: 0.8505251407623291

Test GAP RMS for gender and step 7250: 0.035860832780599594

Test GAP RMS for race and step 7250: 0.0173280518501997

Test balanced accuracy for step 7250: 0.7436743378639221


Test accuracy for step 7500: 0.8521835207939148

Test GAP RMS for gender and step 7500: 0.03826674073934555

Test GAP RMS for race and step 7500: 0.024291574954986572

Test balanced accuracy for step 7500: 0.748319685459137


Test accuracy for step 7750: 0.8512990474700928

Test GAP RMS for gender and step 7750: 0.038752857595682144

Test GAP RMS for race and step 7750: 0.02273048274219036

Test balanced accuracy for step 7750: 0.749741792678833


{'epsilon': 0.01, 'lr': 0.0001, 'wlr': 0.0001, 'w_reg': 20.0}
Final test accuracy: 0.8508568406105042
Final test GAP RMS for gender: 0.041694093495607376
Final test GAP RMS for race: 0.022749725729227066
Final test balanced accuracy: 0.7480606436729431


