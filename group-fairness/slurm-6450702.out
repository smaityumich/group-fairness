2020-05-21 16:32:44.874807: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:44.875508: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:44.875520: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2020-05-21 16:32:50.697273: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:50.699030: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)
2020-05-21 16:32:50.699066: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (gl3168.arc-ts.umich.edu): /proc/driver/nvidia/version does not exist
2020-05-21 16:32:50.699542: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-05-21 16:32:50.707667: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3000000000 Hz
2020-05-21 16:32:50.707767: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55acffd66050 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-05-21 16:32:50.707777: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
/sw/arcts/centos7/python3.6-anaconda/5.2.0/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/array_grad.py:563: _EagerTensorBase.cpu (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.identity instead.
2020-05-21 16:58:59.755122: W tensorflow/python/util/util.cc:319] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1786: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
Test accuracy for step 250: 0.620011031627655

Test GAP RMS for gender and step 250: 0.12672238051891327

Test GAP RMS for race and step 250: 0.016630306839942932

Test balanced accuracy for step 250: 0.4784182012081146


Test accuracy for step 500: 0.8193476796150208

Test GAP RMS for gender and step 500: 0.3903237283229828

Test GAP RMS for race and step 500: 0.08938532322645187

Test balanced accuracy for step 500: 0.7818821668624878


Test accuracy for step 750: 0.8273078799247742

Test GAP RMS for gender and step 750: 0.32173624634742737

Test GAP RMS for race and step 750: 0.08407649397850037

Test balanced accuracy for step 750: 0.7917709350585938


Test accuracy for step 1000: 0.8304035663604736

Test GAP RMS for gender and step 1000: 0.30022281408309937

Test GAP RMS for race and step 1000: 0.0855167880654335

Test balanced accuracy for step 1000: 0.7933529019355774


Test accuracy for step 1250: 0.8298507332801819

Test GAP RMS for gender and step 1250: 0.29751577973365784

Test GAP RMS for race and step 1250: 0.07803015410900116

Test balanced accuracy for step 1250: 0.8016307950019836


Test accuracy for step 1500: 0.8286346197128296

Test GAP RMS for gender and step 1500: 0.27954021096229553

Test GAP RMS for race and step 1500: 0.0676492303609848

Test balanced accuracy for step 1500: 0.809470534324646


Test accuracy for step 1750: 0.8227750062942505

Test GAP RMS for gender and step 1750: 0.2828435003757477

Test GAP RMS for race and step 1750: 0.0667819082736969

Test balanced accuracy for step 1750: 0.8102298378944397


Test accuracy for step 2000: 0.8232172727584839

Test GAP RMS for gender and step 2000: 0.26130563020706177

Test GAP RMS for race and step 2000: 0.07027153670787811

Test balanced accuracy for step 2000: 0.8131457567214966


Test accuracy for step 2250: 0.8270868062973022

Test GAP RMS for gender and step 2250: 0.25091344118118286

Test GAP RMS for race and step 2250: 0.07059464603662491

Test balanced accuracy for step 2250: 0.8124608993530273


Test accuracy for step 2500: 0.8289662599563599

Test GAP RMS for gender and step 2500: 0.23247657716274261

Test GAP RMS for race and step 2500: 0.06900535523891449

Test balanced accuracy for step 2500: 0.8143198490142822


Test accuracy for step 2750: 0.8258706331253052

Test GAP RMS for gender and step 2750: 0.2210695594549179

Test GAP RMS for race and step 2750: 0.06652291119098663

Test balanced accuracy for step 2750: 0.8179854154586792


Test accuracy for step 3000: 0.8254284262657166

Test GAP RMS for gender and step 3000: 0.22203928232192993

Test GAP RMS for race and step 3000: 0.06665655970573425

Test balanced accuracy for step 3000: 0.8175389766693115


Test accuracy for step 3250: 0.8286346197128296

Test GAP RMS for gender and step 3250: 0.20787155628204346

Test GAP RMS for race and step 3250: 0.062454208731651306

Test balanced accuracy for step 3250: 0.8167245388031006


Test accuracy for step 3500: 0.8294085264205933

Test GAP RMS for gender and step 3500: 0.18654339015483856

Test GAP RMS for race and step 3500: 0.06442324817180634

Test balanced accuracy for step 3500: 0.8207855820655823


Test accuracy for step 3750: 0.8269762396812439

Test GAP RMS for gender and step 3750: 0.17852044105529785

Test GAP RMS for race and step 3750: 0.06160338222980499

Test balanced accuracy for step 3750: 0.8227286338806152


Test accuracy for step 4000: 0.8306246399879456

Test GAP RMS for gender and step 4000: 0.1674831360578537

Test GAP RMS for race and step 4000: 0.05831259489059448

Test balanced accuracy for step 4000: 0.823595404624939


Test accuracy for step 4250: 0.8281923532485962

Test GAP RMS for gender and step 4250: 0.16653719544410706

Test GAP RMS for race and step 4250: 0.05504420027136803

Test balanced accuracy for step 4250: 0.8258471488952637


Test accuracy for step 4500: 0.831066906452179

Test GAP RMS for gender and step 4500: 0.1445123553276062

Test GAP RMS for race and step 4500: 0.05592697113752365

Test balanced accuracy for step 4500: 0.8231158256530762


Test accuracy for step 4750: 0.8279712796211243

Test GAP RMS for gender and step 4750: 0.14027298986911774

Test GAP RMS for race and step 4750: 0.06145351007580757

Test balanced accuracy for step 4750: 0.8280161619186401


Test accuracy for step 5000: 0.8299612998962402

Test GAP RMS for gender and step 5000: 0.13603486120700836

Test GAP RMS for race and step 5000: 0.057891976088285446

Test balanced accuracy for step 5000: 0.8263983726501465


Test accuracy for step 5250: 0.8305140733718872

Test GAP RMS for gender and step 5250: 0.12876909971237183

Test GAP RMS for race and step 5250: 0.058540016412734985

Test balanced accuracy for step 5250: 0.8267635107040405


Test accuracy for step 5500: 0.8323935866355896

Test GAP RMS for gender and step 5500: 0.11616664379835129

Test GAP RMS for race and step 5500: 0.05666627734899521

Test balanced accuracy for step 5500: 0.8259986639022827


Test accuracy for step 5750: 0.8278607130050659

Test GAP RMS for gender and step 5750: 0.10817304998636246

Test GAP RMS for race and step 5750: 0.05804164707660675

Test balanced accuracy for step 5750: 0.8239303231239319


Test accuracy for step 6000: 0.8267551064491272

Test GAP RMS for gender and step 6000: 0.11334152519702911

Test GAP RMS for race and step 6000: 0.05812959372997284

Test balanced accuracy for step 6000: 0.824743390083313


Test accuracy for step 6250: 0.8302929997444153

Test GAP RMS for gender and step 6250: 0.10680686682462692

Test GAP RMS for race and step 6250: 0.056249551475048065

Test balanced accuracy for step 6250: 0.8241480588912964


Test accuracy for step 6500: 0.8289662599563599

Test GAP RMS for gender and step 6500: 0.10070712119340897

Test GAP RMS for race and step 6500: 0.05465704947710037

Test balanced accuracy for step 6500: 0.8218824863433838


Test accuracy for step 6750: 0.8302929997444153

Test GAP RMS for gender and step 6750: 0.0896817073225975

Test GAP RMS for race and step 6750: 0.05418603867292404

Test balanced accuracy for step 6750: 0.819209098815918


Test accuracy for step 7000: 0.8304035663604736

Test GAP RMS for gender and step 7000: 0.08887410163879395

Test GAP RMS for race and step 7000: 0.05519111081957817

Test balanced accuracy for step 7000: 0.8222146034240723


Test accuracy for step 7250: 0.8297401666641235

Test GAP RMS for gender and step 7250: 0.08634526282548904

Test GAP RMS for race and step 7250: 0.053350888192653656

Test balanced accuracy for step 7250: 0.8176091909408569


Test accuracy for step 7500: 0.8304035663604736

Test GAP RMS for gender and step 7500: 0.086216039955616

Test GAP RMS for race and step 7500: 0.04888606071472168

Test balanced accuracy for step 7500: 0.8177387714385986


Test accuracy for step 7750: 0.8283029198646545

Test GAP RMS for gender and step 7750: 0.08291108906269073

Test GAP RMS for race and step 7750: 0.05041264370083809

Test balanced accuracy for step 7750: 0.8174314498901367


{'epsilon': 0.0001, 'lr': 0.0001, 'wlr': 1e-05, 'w_reg': 60.0}
Final test accuracy: 0.8259811997413635
Final test GAP RMS for gender: 0.08282206207513809
Final test GAP RMS for race: 0.04993211850523949
Final test balanced accuracy: 0.811884880065918


