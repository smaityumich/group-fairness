2020-05-21 16:32:41.207769: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:41.208573: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:41.208585: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2020-05-21 16:32:46.660691: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:46.660866: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)
2020-05-21 16:32:46.660894: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (gl3158.arc-ts.umich.edu): /proc/driver/nvidia/version does not exist
2020-05-21 16:32:46.661286: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-05-21 16:32:46.668256: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3000000000 Hz
2020-05-21 16:32:46.668366: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55cb32085480 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-05-21 16:32:46.668375: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
/sw/arcts/centos7/python3.6-anaconda/5.2.0/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/array_grad.py:563: _EagerTensorBase.cpu (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.identity instead.
2020-05-21 16:58:24.879144: W tensorflow/python/util/util.cc:319] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1786: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
Test accuracy for step 250: 0.6173576712608337

Test GAP RMS for gender and step 250: 0.12789380550384521

Test GAP RMS for race and step 250: 0.017781950533390045

Test balanced accuracy for step 250: 0.4828389883041382


Test accuracy for step 500: 0.804643452167511

Test GAP RMS for gender and step 500: 0.2646481990814209

Test GAP RMS for race and step 500: 0.07238280773162842

Test balanced accuracy for step 500: 0.8095189332962036


Test accuracy for step 750: 0.8103924989700317

Test GAP RMS for gender and step 750: 0.19833669066429138

Test GAP RMS for race and step 750: 0.06555093824863434

Test balanced accuracy for step 750: 0.8190273642539978


Test accuracy for step 1000: 0.8194582462310791

Test GAP RMS for gender and step 1000: 0.1915026307106018

Test GAP RMS for race and step 1000: 0.05585605278611183

Test balanced accuracy for step 1000: 0.8205404281616211


Test accuracy for step 1250: 0.8201215863227844

Test GAP RMS for gender and step 1250: 0.17531250417232513

Test GAP RMS for race and step 1250: 0.05553484335541725

Test balanced accuracy for step 1250: 0.8225220441818237


Test accuracy for step 1500: 0.8155887126922607

Test GAP RMS for gender and step 1500: 0.166439026594162

Test GAP RMS for race and step 1500: 0.05989370867609978

Test balanced accuracy for step 1500: 0.8241577744483948


Test accuracy for step 1750: 0.8148148059844971

Test GAP RMS for gender and step 1750: 0.16901279985904694

Test GAP RMS for race and step 1750: 0.060201819986104965

Test balanced accuracy for step 1750: 0.826270341873169


Test accuracy for step 2000: 0.8126036524772644

Test GAP RMS for gender and step 2000: 0.16960620880126953

Test GAP RMS for race and step 2000: 0.06412942707538605

Test balanced accuracy for step 2000: 0.8258900046348572


Test accuracy for step 2250: 0.8181315660476685

Test GAP RMS for gender and step 2250: 0.16721469163894653

Test GAP RMS for race and step 2250: 0.05944609269499779

Test balanced accuracy for step 2250: 0.8258376121520996


Test accuracy for step 2500: 0.8184632658958435

Test GAP RMS for gender and step 2500: 0.15545982122421265

Test GAP RMS for race and step 2500: 0.060494039207696915

Test balanced accuracy for step 2500: 0.8283718228340149


Test accuracy for step 2750: 0.8109452724456787

Test GAP RMS for gender and step 2750: 0.16687558591365814

Test GAP RMS for race and step 2750: 0.0674808919429779

Test balanced accuracy for step 2750: 0.8277269601821899


Test accuracy for step 3000: 0.8143725991249084

Test GAP RMS for gender and step 3000: 0.17102578282356262

Test GAP RMS for race and step 3000: 0.06592526286840439

Test balanced accuracy for step 3000: 0.8282933235168457


Test accuracy for step 3250: 0.815367579460144

Test GAP RMS for gender and step 3250: 0.1636921465396881

Test GAP RMS for race and step 3250: 0.06299227476119995

Test balanced accuracy for step 3250: 0.8275615572929382


Test accuracy for step 3500: 0.8152570724487305

Test GAP RMS for gender and step 3500: 0.15735748410224915

Test GAP RMS for race and step 3500: 0.0638417899608612

Test balanced accuracy for step 3500: 0.8287231922149658


Test accuracy for step 3750: 0.8132669925689697

Test GAP RMS for gender and step 3750: 0.15591312944889069

Test GAP RMS for race and step 3750: 0.06581323593854904

Test balanced accuracy for step 3750: 0.8278716206550598


Test accuracy for step 4000: 0.8194582462310791

Test GAP RMS for gender and step 4000: 0.161142036318779

Test GAP RMS for race and step 4000: 0.0608656108379364

Test balanced accuracy for step 4000: 0.8277944326400757


Test accuracy for step 4250: 0.815367579460144

Test GAP RMS for gender and step 4250: 0.16698293387889862

Test GAP RMS for race and step 4250: 0.06411044299602509

Test balanced accuracy for step 4250: 0.8289506435394287


Test accuracy for step 4500: 0.8217799663543701

Test GAP RMS for gender and step 4500: 0.15257970988750458

Test GAP RMS for race and step 4500: 0.06032278388738632

Test balanced accuracy for step 4500: 0.8287107944488525


Test accuracy for step 4750: 0.8140408992767334

Test GAP RMS for gender and step 4750: 0.15558290481567383

Test GAP RMS for race and step 4750: 0.0668332502245903

Test balanced accuracy for step 4750: 0.8297719359397888


Test accuracy for step 5000: 0.8182421326637268

Test GAP RMS for gender and step 5000: 0.15569555759429932

Test GAP RMS for race and step 5000: 0.06298689544200897

Test balanced accuracy for step 5000: 0.8293061256408691


Test accuracy for step 5250: 0.8151465058326721

Test GAP RMS for gender and step 5250: 0.1613292694091797

Test GAP RMS for race and step 5250: 0.06648680567741394

Test balanced accuracy for step 5250: 0.8289588689804077


Test accuracy for step 5500: 0.8173576593399048

Test GAP RMS for gender and step 5500: 0.1510397493839264

Test GAP RMS for race and step 5500: 0.06608753651380539

Test balanced accuracy for step 5500: 0.829184889793396


Test accuracy for step 5750: 0.8150359392166138

Test GAP RMS for gender and step 5750: 0.14577193558216095

Test GAP RMS for race and step 5750: 0.0639100894331932

Test balanced accuracy for step 5750: 0.8290401697158813


Test accuracy for step 6000: 0.8132669925689697

Test GAP RMS for gender and step 6000: 0.1548672467470169

Test GAP RMS for race and step 6000: 0.06787095218896866

Test balanced accuracy for step 6000: 0.8294150829315186


Test accuracy for step 6250: 0.8113874793052673

Test GAP RMS for gender and step 6250: 0.1594669669866562

Test GAP RMS for race and step 6250: 0.0703292265534401

Test balanced accuracy for step 6250: 0.8274017572402954


Test accuracy for step 6500: 0.8110558390617371

Test GAP RMS for gender and step 6500: 0.1548720747232437

Test GAP RMS for race and step 6500: 0.06863850355148315

Test balanced accuracy for step 6500: 0.8273369669914246


Test accuracy for step 6750: 0.8189054727554321

Test GAP RMS for gender and step 6750: 0.1391134262084961

Test GAP RMS for race and step 6750: 0.06884364038705826

Test balanced accuracy for step 6750: 0.8285095691680908


Test accuracy for step 7000: 0.8150359392166138

Test GAP RMS for gender and step 7000: 0.14321237802505493

Test GAP RMS for race and step 7000: 0.0658390149474144

Test balanced accuracy for step 7000: 0.8293489217758179


Test accuracy for step 7250: 0.8170259594917297

Test GAP RMS for gender and step 7250: 0.14439146220684052

Test GAP RMS for race and step 7250: 0.06859855353832245

Test balanced accuracy for step 7250: 0.8295831084251404


Test accuracy for step 7500: 0.8165837526321411

Test GAP RMS for gender and step 7500: 0.15431012213230133

Test GAP RMS for race and step 7500: 0.0683211088180542

Test balanced accuracy for step 7500: 0.8292909860610962


Test accuracy for step 7750: 0.8172470927238464

Test GAP RMS for gender and step 7750: 0.13934928178787231

Test GAP RMS for race and step 7750: 0.06904138624668121

Test balanced accuracy for step 7750: 0.8300378322601318


{'epsilon': 1e-05, 'lr': 0.0001, 'wlr': 5e-06, 'w_reg': 10.0}
Final test accuracy: 0.8154781460762024
Final test GAP RMS for gender: 0.13285957276821136
Final test GAP RMS for race: 0.06701932102441788
Final test balanced accuracy: 0.8290236592292786


