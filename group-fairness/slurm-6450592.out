2020-05-21 16:32:41.570705: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer.so.6'; dlerror: libnvinfer.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:41.571784: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libnvinfer_plugin.so.6'; dlerror: libnvinfer_plugin.so.6: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:41.571799: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:30] Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2020-05-21 16:32:47.590523: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /sw/arcts/centos7/python3.6-anaconda/5.2.0/lib:/opt/slurm/lib64::
2020-05-21 16:32:47.590758: E tensorflow/stream_executor/cuda/cuda_driver.cc:351] failed call to cuInit: UNKNOWN ERROR (303)
2020-05-21 16:32:47.590798: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (gl3157.arc-ts.umich.edu): /proc/driver/nvidia/version does not exist
2020-05-21 16:32:47.591170: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2020-05-21 16:32:47.597668: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 3000000000 Hz
2020-05-21 16:32:47.597764: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55d813311e50 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-05-21 16:32:47.597774: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
/sw/arcts/centos7/python3.6-anaconda/5.2.0/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/array_grad.py:563: _EagerTensorBase.cpu (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.identity instead.
2020-05-21 17:00:29.996725: W tensorflow/python/util/util.cc:319] Sets are not currently considered sequences, but this may change in the future, so consider avoiding using them.
WARNING:tensorflow:From /home/smaity/.local/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1786: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
Test accuracy for step 250: 0.6109452843666077

Test GAP RMS for gender and step 250: 0.13046519458293915

Test GAP RMS for race and step 250: 0.019438518211245537

Test balanced accuracy for step 250: 0.48446789383888245


Test accuracy for step 500: 0.8028745055198669

Test GAP RMS for gender and step 500: 0.17465506494045258

Test GAP RMS for race and step 500: 0.06295014172792435

Test balanced accuracy for step 500: 0.8131349086761475


Test accuracy for step 750: 0.8035378456115723

Test GAP RMS for gender and step 750: 0.08923973143100739

Test GAP RMS for race and step 750: 0.05398031324148178

Test balanced accuracy for step 750: 0.8137274980545044


Test accuracy for step 1000: 0.8165837526321411

Test GAP RMS for gender and step 1000: 0.0693497508764267

Test GAP RMS for race and step 1000: 0.05648857727646828

Test balanced accuracy for step 1000: 0.8113874197006226


Test accuracy for step 1250: 0.813045859336853

Test GAP RMS for gender and step 1250: 0.07528248429298401

Test GAP RMS for race and step 1250: 0.054331161081790924

Test balanced accuracy for step 1250: 0.8126001358032227


Test accuracy for step 1500: 0.8085129857063293

Test GAP RMS for gender and step 1500: 0.07377492636442184

Test GAP RMS for race and step 1500: 0.052453912794589996

Test balanced accuracy for step 1500: 0.8123838901519775


Test accuracy for step 1750: 0.8088446855545044

Test GAP RMS for gender and step 1750: 0.0767248272895813

Test GAP RMS for race and step 1750: 0.05102405697107315

Test balanced accuracy for step 1750: 0.816152811050415


Test accuracy for step 2000: 0.8093974590301514

Test GAP RMS for gender and step 2000: 0.07843030989170074

Test GAP RMS for race and step 2000: 0.05100575461983681

Test balanced accuracy for step 2000: 0.8154375553131104


Test accuracy for step 2250: 0.8149253726005554

Test GAP RMS for gender and step 2250: 0.07647573202848434

Test GAP RMS for race and step 2250: 0.051349151879549026

Test balanced accuracy for step 2250: 0.8119896650314331


Test accuracy for step 2500: 0.808734118938446

Test GAP RMS for gender and step 2500: 0.07453228533267975

Test GAP RMS for race and step 2500: 0.052922043949365616

Test balanced accuracy for step 2500: 0.8111408948898315


Test accuracy for step 2750: 0.8053067922592163

Test GAP RMS for gender and step 2750: 0.07578206807374954

Test GAP RMS for race and step 2750: 0.05048174411058426

Test balanced accuracy for step 2750: 0.8161307573318481


Test accuracy for step 3000: 0.8123825192451477

Test GAP RMS for gender and step 3000: 0.07728957384824753

Test GAP RMS for race and step 3000: 0.050775498151779175

Test balanced accuracy for step 3000: 0.8155574798583984


Test accuracy for step 3250: 0.8133775591850281

Test GAP RMS for gender and step 3250: 0.07748367637395859

Test GAP RMS for race and step 3250: 0.05184856057167053

Test balanced accuracy for step 3250: 0.8131279349327087


Test accuracy for step 3500: 0.8056384921073914

Test GAP RMS for gender and step 3500: 0.07474514096975327

Test GAP RMS for race and step 3500: 0.05458126589655876

Test balanced accuracy for step 3500: 0.8155781626701355


Test accuracy for step 3750: 0.8128247857093811

Test GAP RMS for gender and step 3750: 0.07524769008159637

Test GAP RMS for race and step 3750: 0.05517256632447243

Test balanced accuracy for step 3750: 0.8132258057594299


Test accuracy for step 4000: 0.8199005126953125

Test GAP RMS for gender and step 4000: 0.07677578181028366

Test GAP RMS for race and step 4000: 0.050081927329301834

Test balanced accuracy for step 4000: 0.8129611015319824


Test accuracy for step 4250: 0.8179104328155518

Test GAP RMS for gender and step 4250: 0.07706240564584732

Test GAP RMS for race and step 4250: 0.04743366688489914

Test balanced accuracy for step 4250: 0.8111834526062012


Test accuracy for step 4500: 0.8212271928787231

Test GAP RMS for gender and step 4500: 0.07711777091026306

Test GAP RMS for race and step 4500: 0.049548204988241196

Test balanced accuracy for step 4500: 0.8102877140045166


Test accuracy for step 4750: 0.8110558390617371

Test GAP RMS for gender and step 4750: 0.075626440346241

Test GAP RMS for race and step 4750: 0.049878597259521484

Test balanced accuracy for step 4750: 0.8122115731239319


Test accuracy for step 5000: 0.8170259594917297

Test GAP RMS for gender and step 5000: 0.07707040011882782

Test GAP RMS for race and step 5000: 0.04883837699890137

Test balanced accuracy for step 5000: 0.8121426105499268


Test accuracy for step 5250: 0.8191266059875488

Test GAP RMS for gender and step 5250: 0.07812175899744034

Test GAP RMS for race and step 5250: 0.050313953310251236

Test balanced accuracy for step 5250: 0.8107521533966064


Test accuracy for step 5500: 0.8181315660476685

Test GAP RMS for gender and step 5500: 0.07345577329397202

Test GAP RMS for race and step 5500: 0.04774438217282295

Test balanced accuracy for step 5500: 0.8104035258293152


Test accuracy for step 5750: 0.811608612537384

Test GAP RMS for gender and step 5750: 0.07531237602233887

Test GAP RMS for race and step 5750: 0.04883012920618057

Test balanced accuracy for step 5750: 0.8108789920806885


Test accuracy for step 6000: 0.8123825192451477

Test GAP RMS for gender and step 6000: 0.0775972306728363

Test GAP RMS for race and step 6000: 0.0497201606631279

Test balanced accuracy for step 6000: 0.812161922454834


Test accuracy for step 6250: 0.8138197660446167

Test GAP RMS for gender and step 6250: 0.07903115451335907

Test GAP RMS for race and step 6250: 0.04655996710062027

Test balanced accuracy for step 6250: 0.8129570484161377


Test accuracy for step 6500: 0.8148148059844971

Test GAP RMS for gender and step 6500: 0.07645733654499054

Test GAP RMS for race and step 6500: 0.045458901673555374

Test balanced accuracy for step 6500: 0.8140773773193359


Test accuracy for step 6750: 0.8172470927238464

Test GAP RMS for gender and step 6750: 0.07922039180994034

Test GAP RMS for race and step 6750: 0.04218076542019844

Test balanced accuracy for step 6750: 0.8070411086082458


Test accuracy for step 7000: 0.8141514658927917

Test GAP RMS for gender and step 7000: 0.07887988537549973

Test GAP RMS for race and step 7000: 0.045939937233924866

Test balanced accuracy for step 7000: 0.8111697435379028


Test accuracy for step 7250: 0.8184632658958435

Test GAP RMS for gender and step 7250: 0.07886280119419098

Test GAP RMS for race and step 7250: 0.04590138420462608

Test balanced accuracy for step 7250: 0.8113943338394165


Test accuracy for step 7500: 0.8179104328155518

Test GAP RMS for gender and step 7500: 0.0765601098537445

Test GAP RMS for race and step 7500: 0.04521876201033592

Test balanced accuracy for step 7500: 0.8138072490692139


Test accuracy for step 7750: 0.8168048858642578

Test GAP RMS for gender and step 7750: 0.07684960961341858

Test GAP RMS for race and step 7750: 0.04382232576608658

Test balanced accuracy for step 7750: 0.8106074333190918


{'epsilon': 0.0001, 'lr': 0.0001, 'wlr': 0.001, 'w_reg': 20.0}
Final test accuracy: 0.8131564259529114
Final test GAP RMS for gender: 0.07808785885572433
Final test GAP RMS for race: 0.043626777827739716
Final test balanced accuracy: 0.8103580474853516


